VERSION 5.00
Object = "{831FDD16-0C5C-11D2-A9FC-0000F8754DA1}#2.0#0"; "MSCOMCTL.OCX"
Begin VB.MDIForm MDIForm1 
   BackColor       =   &H00FFFFFF&
   Caption         =   "MDIForm1"
   ClientHeight    =   8940
   ClientLeft      =   165
   ClientTop       =   855
   ClientWidth     =   13575
   Icon            =   "MDIForm1.frx":0000
   LinkTopic       =   "MDIForm1"
   LockControls    =   -1  'True
   Moveable        =   0   'False
   OLEDropMode     =   1  'Manual
   Picture         =   "MDIForm1.frx":0442
   StartUpPosition =   3  'Windows Default
   WindowState     =   2  'Maximized
   Begin VB.PictureBox Picture1 
      Align           =   2  'Align Bottom
      Appearance      =   0  'Flat
      BackColor       =   &H00C0E0FF&
      FillColor       =   &H00C0E0FF&
      ForeColor       =   &H80000008&
      Height          =   405
      Left            =   0
      ScaleHeight     =   375
      ScaleWidth      =   13545
      TabIndex        =   1
      Top             =   8220
      Visible         =   0   'False
      Width           =   13575
      Begin VB.Label Label1 
         AutoSize        =   -1  'True
         BackStyle       =   0  'Transparent
         Caption         =   "Label1"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H000000FF&
         Height          =   300
         Left            =   45
         TabIndex        =   2
         Top             =   30
         Width           =   825
      End
   End
   Begin MSComctlLib.StatusBar SBAR 
      Align           =   2  'Align Bottom
      Height          =   315
      Left            =   0
      TabIndex        =   0
      Top             =   8625
      Width           =   13575
      _ExtentX        =   23945
      _ExtentY        =   556
      _Version        =   393216
      BeginProperty Panels {8E3867A5-8586-11D1-B16A-00C0F0283628} 
         NumPanels       =   8
         BeginProperty Panel1 {8E3867AB-8586-11D1-B16A-00C0F0283628} 
            Alignment       =   1
            Bevel           =   2
            Object.Width           =   4939
            MinWidth        =   4939
            Text            =   "a Dataman Software"
            TextSave        =   "a Dataman Software"
         EndProperty
         BeginProperty Panel2 {8E3867AB-8586-11D1-B16A-00C0F0283628} 
            Alignment       =   1
            Bevel           =   2
            Object.Width           =   1940
            MinWidth        =   1940
         EndProperty
         BeginProperty Panel3 {8E3867AB-8586-11D1-B16A-00C0F0283628} 
            Alignment       =   1
            Bevel           =   2
            Object.Width           =   2187
            MinWidth        =   2187
         EndProperty
         BeginProperty Panel4 {8E3867AB-8586-11D1-B16A-00C0F0283628} 
            Alignment       =   1
            Bevel           =   2
            Object.Width           =   2187
            MinWidth        =   2187
         EndProperty
         BeginProperty Panel5 {8E3867AB-8586-11D1-B16A-00C0F0283628} 
            Alignment       =   1
            Bevel           =   2
            Object.Width           =   2187
            MinWidth        =   2187
         EndProperty
         BeginProperty Panel6 {8E3867AB-8586-11D1-B16A-00C0F0283628} 
            Style           =   5
            Alignment       =   1
            Bevel           =   2
            Object.Width           =   1940
            MinWidth        =   1940
            TextSave        =   "1:32 AM"
         EndProperty
         BeginProperty Panel7 {8E3867AB-8586-11D1-B16A-00C0F0283628} 
            Alignment       =   1
            Bevel           =   2
            Object.Width           =   2117
            MinWidth        =   2117
            Text            =   "Find Part"
            TextSave        =   "Find Part"
         EndProperty
         BeginProperty Panel8 {8E3867AB-8586-11D1-B16A-00C0F0283628} 
            Alignment       =   1
            Bevel           =   2
            Object.Width           =   2999
            MinWidth        =   2999
            Text            =   "Login Site"
            TextSave        =   "Login Site"
         EndProperty
      EndProperty
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Times New Roman"
         Size            =   9.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin VB.Menu Master 
      Caption         =   "&Common Master"
      Begin VB.Menu Mas 
         Caption         =   "City Master"
         Index           =   1
      End
      Begin VB.Menu Mas 
         Caption         =   "State Master"
         Index           =   2
         Visible         =   0   'False
      End
      Begin VB.Menu Mas 
         Caption         =   "Color Master"
         Index           =   3
      End
      Begin VB.Menu Mas 
         Caption         =   "Contract/OEM"
         Index           =   4
      End
      Begin VB.Menu Mas 
         Caption         =   "Employee Master"
         Index           =   5
      End
      Begin VB.Menu Mas 
         Caption         =   "Godown Master"
         Index           =   6
      End
      Begin VB.Menu Mas 
         Caption         =   "Vehicle Model Category Master"
         Index           =   7
      End
      Begin VB.Menu Mas 
         Caption         =   "Vehicle Model Group Master"
         Index           =   8
      End
      Begin VB.Menu Mas 
         Caption         =   "Vehicle Model Check List"
         Index           =   9
      End
      Begin VB.Menu Mas 
         Caption         =   "Vehicle Model Master"
         Index           =   10
      End
      Begin VB.Menu Mas 
         Caption         =   "Dealer Master"
         Index           =   11
      End
      Begin VB.Menu Mas 
         Caption         =   "Area Master"
         Index           =   12
      End
      Begin VB.Menu Mas 
         Caption         =   "Site Master"
         Index           =   13
      End
      Begin VB.Menu Mas 
         Caption         =   "-"
         Index           =   14
      End
      Begin VB.Menu Mas 
         Caption         =   "Tax Forms"
         Index           =   15
      End
      Begin VB.Menu Mas 
         Caption         =   "Tax Forms Receipt / Issue"
         Index           =   16
      End
   End
   Begin VB.Menu fa 
      Caption         =   "&Financial A/c"
      Begin VB.Menu faM 
         Caption         =   "&Master"
         Begin VB.Menu famM 
            Caption         =   "A/c &Group Entry"
            Index           =   0
         End
         Begin VB.Menu famM 
            Caption         =   "&Ledger A/c Entry"
            Index           =   1
         End
         Begin VB.Menu famM 
            Caption         =   "Narration Master"
            Index           =   2
         End
         Begin VB.Menu famM 
            Caption         =   "City Master"
            Index           =   3
         End
      End
      Begin VB.Menu faE 
         Caption         =   "&Transaction"
         Begin VB.Menu fame 
            Caption         =   "&Voucher Entry"
            Index           =   0
         End
         Begin VB.Menu fame 
            Caption         =   "Adjustment Entry"
            Index           =   1
         End
         Begin VB.Menu fame 
            Caption         =   "Adjustment Delete"
            Index           =   2
         End
         Begin VB.Menu fame 
            Caption         =   "Bank Reconciliation"
            Index           =   3
         End
         Begin VB.Menu fame 
            Caption         =   "Other Purchases"
            Index           =   4
            Visible         =   0   'False
         End
         Begin VB.Menu fame 
            Caption         =   "A/c Posting"
            Index           =   5
         End
         Begin VB.Menu fame 
            Caption         =   "TDS Category"
            Index           =   6
         End
         Begin VB.Menu fame 
            Caption         =   "TDS Challan"
            Index           =   7
         End
         Begin VB.Menu fame 
            Caption         =   "TDS Certificate"
            Index           =   8
         End
      End
      Begin VB.Menu faD 
         Caption         =   "&Display"
         Begin VB.Menu FAREPORTD 
            Caption         =   "Balanc&e Sheet"
            Index           =   0
         End
         Begin VB.Menu FAREPORTD 
            Caption         =   "&Profit And Loss Account"
            Index           =   1
         End
         Begin VB.Menu FAREPORTD 
            Caption         =   "&Trial Balance (Group)"
            Index           =   2
         End
         Begin VB.Menu FAREPORTD 
            Caption         =   "&Trial Balance (Ledger)"
            Index           =   3
         End
         Begin VB.Menu FAREPORTD 
            Caption         =   "Cash &Flow"
            Index           =   4
         End
         Begin VB.Menu FAREPORTD 
            Caption         =   "Fund Flo&w"
            Index           =   5
         End
         Begin VB.Menu FAREPORTD 
            Caption         =   "Cash And Bank Books"
            Index           =   6
         End
      End
      Begin VB.Menu faDS 
         Caption         =   "&Site Display"
         Begin VB.Menu FAREPORTDS 
            Caption         =   "Balanc&e Sheet"
            Index           =   0
         End
         Begin VB.Menu FAREPORTDS 
            Caption         =   "&Profit And Loss Account"
            Index           =   1
         End
         Begin VB.Menu FAREPORTDS 
            Caption         =   "&Trial Balance (Group)"
            Index           =   2
         End
         Begin VB.Menu FAREPORTDS 
            Caption         =   "&Trial Balance (Ledger)"
            Index           =   3
         End
         Begin VB.Menu FAREPORTDS 
            Caption         =   "Cash &Flow"
            Index           =   4
         End
         Begin VB.Menu FAREPORTDS 
            Caption         =   "Fund Flo&w"
            Index           =   5
         End
         Begin VB.Menu FAREPORTDS 
            Caption         =   "Cash And Bank Books"
            Index           =   6
         End
      End
      Begin VB.Menu farp 
         Caption         =   "&Reports"
         Begin VB.Menu FAREPORT 
            Caption         =   "&Day Book"
            Index           =   0
         End
         Begin VB.Menu FAREPORT 
            Caption         =   "&Ledger"
            Index           =   3
         End
         Begin VB.Menu FAREPORT 
            Caption         =   "&Interest Ledger"
            Index           =   4
         End
         Begin VB.Menu FAREPORT 
            Caption         =   "Cas&h Book"
            Index           =   5
         End
         Begin VB.Menu FAREPORT 
            Caption         =   "Ban&k Book"
            Index           =   6
         End
         Begin VB.Menu FAREPORT 
            Caption         =   "&Journal Books"
            Index           =   7
         End
         Begin VB.Menu FAREPORT 
            Caption         =   "&Annexure"
            Index           =   10
         End
         Begin VB.Menu FAREPORT 
            Caption         =   "Bank &Register"
            Index           =   13
         End
         Begin VB.Menu FAREPORT 
            Caption         =   "A&geing Analysis for Debtors"
            Index           =   14
         End
         Begin VB.Menu FAREPORT 
            Caption         =   "Ageing A&nalysis for Creditors"
            Index           =   15
         End
         Begin VB.Menu FAREPORT 
            Caption         =   "Ch&eque Cleared Register"
            Index           =   22
         End
         Begin VB.Menu FAREPORT 
            Caption         =   "Che&que Not Cleared Register"
            Index           =   23
         End
         Begin VB.Menu FAREPORT 
            Caption         =   "Outstanding Report For Debtors"
            Index           =   24
         End
         Begin VB.Menu FAREPORT 
            Caption         =   "Outstanding Report For Creditors"
            Index           =   25
         End
         Begin VB.Menu FAREPORT 
            Caption         =   "Daily Transaction Summary"
            Index           =   27
         End
         Begin VB.Menu FAREPORT 
            Caption         =   "Non Transaction Report"
            Index           =   29
         End
         Begin VB.Menu FAREPORT 
            Caption         =   "Reference Report"
            Index           =   30
         End
         Begin VB.Menu FAREPORT 
            Caption         =   "Detailed Trial Ledger"
            Index           =   31
         End
         Begin VB.Menu FAREPORT 
            Caption         =   "A/c Check List"
            Index           =   32
         End
         Begin VB.Menu FAREPORT 
            Caption         =   "Bill Wise Outstanding Report For Debtors"
            Index           =   33
         End
         Begin VB.Menu FAREPORT 
            Caption         =   "Control Ledger"
            Index           =   34
         End
         Begin VB.Menu FAREPORT 
            Caption         =   "Roz Namcha"
            Index           =   35
         End
         Begin VB.Menu FAREPORT 
            Caption         =   "Cash/Bank Book"
            Index           =   36
         End
      End
   End
   Begin VB.Menu MnuLst 
      Caption         =   "&List/Register"
      Begin VB.Menu MnuLst1 
         Caption         =   "City Register"
         Index           =   0
      End
      Begin VB.Menu MnuLst1 
         Caption         =   "State Register"
         Index           =   1
      End
      Begin VB.Menu MnuLst1 
         Caption         =   "Employee Register"
         Index           =   2
      End
      Begin VB.Menu MnuLst1 
         Caption         =   "Contract/ Finance Register"
         Index           =   3
      End
      Begin VB.Menu MnuLst1 
         Caption         =   "Discount Factor Register"
         Index           =   4
      End
      Begin VB.Menu MnuLst1 
         Caption         =   "Proprietory Part Grade Register"
         Index           =   5
      End
      Begin VB.Menu MnuLst1 
         Caption         =   "Godown Register"
         Index           =   6
      End
      Begin VB.Menu MnuLst1 
         Caption         =   "Unit Register"
         Index           =   7
      End
      Begin VB.Menu MnuLst1 
         Caption         =   "Aggregate Register"
         Index           =   8
      End
      Begin VB.Menu MnuLst1 
         Caption         =   "Part Register"
         Index           =   9
      End
      Begin VB.Menu MnuLst1 
         Caption         =   "Vehicle Model Category Register"
         Index           =   10
      End
      Begin VB.Menu MnuLst1 
         Caption         =   "Vehicle Model Group Register"
         Index           =   11
      End
      Begin VB.Menu MnuLst1 
         Caption         =   "Vehicle Model Master"
         Index           =   12
      End
      Begin VB.Menu MnuLst1 
         Caption         =   "Dealer Register"
         Index           =   13
      End
      Begin VB.Menu MnuLst1 
         Caption         =   "Colour Register"
         Index           =   14
      End
      Begin VB.Menu MnuLst1 
         Caption         =   "Labour Register"
         Index           =   15
         Visible         =   0   'False
      End
      Begin VB.Menu MnuLst1 
         Caption         =   "Model-Wise Labour Register"
         Index           =   16
         Visible         =   0   'False
      End
   End
   Begin VB.Menu MnuVeh 
      Caption         =   "&Vehicle"
      Begin VB.Menu VehSalTrn 
         Caption         =   "Quotation Entry"
         Index           =   1
      End
      Begin VB.Menu VehSalTrn 
         Caption         =   "Booking"
         Index           =   2
      End
      Begin VB.Menu VehSalTrn 
         Caption         =   "Customer Receipt"
         Index           =   3
      End
      Begin VB.Menu VehSalTrn 
         Caption         =   "Sale Bill"
         Index           =   4
      End
      Begin VB.Menu VehSalTrn 
         Caption         =   "Delivery Challan"
         Index           =   5
      End
      Begin VB.Menu Sep0 
         Caption         =   "-"
         Index           =   1
      End
      Begin VB.Menu VehMktTrn 
         Caption         =   "Prospective Customer Entry"
         Index           =   0
      End
      Begin VB.Menu VehMktTrn 
         Caption         =   "Daily Activity Entry"
         Index           =   1
      End
      Begin VB.Menu VehMktTrn 
         Caption         =   "Order Got/Lost"
         Index           =   2
      End
      Begin VB.Menu VehMktReports 
         Caption         =   "Marketing Reports"
         Index           =   1
         Begin VB.Menu VehMktRep 
            Caption         =   "Daily Activity Report"
            Index           =   1
         End
         Begin VB.Menu VehMktRep 
            Caption         =   "Appointments"
            Index           =   2
         End
         Begin VB.Menu VehMktRep 
            Caption         =   "Call Status Report"
            Index           =   3
         End
         Begin VB.Menu VehMktRep 
            Caption         =   "Case Analysis"
            Index           =   4
         End
         Begin VB.Menu VehMktRep 
            Caption         =   "Daily Activity Missing Report"
            Index           =   5
            Visible         =   0   'False
         End
         Begin VB.Menu VehMktRep 
            Caption         =   "Appointments Not Kept"
            Index           =   6
            Visible         =   0   'False
         End
         Begin VB.Menu VehMktRep 
            Caption         =   "Executive-wise Got/Lost Report"
            Index           =   7
            Visible         =   0   'False
         End
         Begin VB.Menu VehMktRep 
            Caption         =   "Pipeline Report (Daily)"
            Index           =   8
         End
         Begin VB.Menu VehMktRep 
            Caption         =   "Profession/Purpose Analysis"
            Index           =   9
            Visible         =   0   'False
         End
         Begin VB.Menu VehMktRep 
            Caption         =   "Statement of Prospective Demands (SPADE)"
            Index           =   10
         End
         Begin VB.Menu VehMktRep 
            Caption         =   "Daily Sales Report"
            Index           =   12
         End
         Begin VB.Menu VehMktRep 
            Caption         =   "Sales Tracking Report"
            Index           =   13
         End
         Begin VB.Menu VehMktRep 
            Caption         =   "Finance Tracking Report"
            Index           =   14
         End
      End
      Begin VB.Menu Sep 
         Caption         =   "-"
         Index           =   1
      End
      Begin VB.Menu VehPurTrn 
         Caption         =   "Vehicle Receipts"
         Index           =   1
      End
      Begin VB.Menu VehPurTrn 
         Caption         =   "Vehicle Purchase"
         Index           =   2
      End
      Begin VB.Menu VehPurTrn 
         Caption         =   "Opening Stock"
         Index           =   3
      End
      Begin VB.Menu VehPurTrn 
         Caption         =   "Check List Entry"
         Index           =   4
      End
      Begin VB.Menu VehPurTrn 
         Caption         =   "BMS Opening"
         Index           =   5
         Visible         =   0   'False
      End
      Begin VB.Menu VehPurTrn 
         Caption         =   "Godown Transfer"
         Index           =   6
      End
      Begin VB.Menu VehPurTrn 
         Caption         =   "Offtake Target Entry"
         Index           =   7
      End
      Begin VB.Menu VehPurTrn 
         Caption         =   "Vehicle Allocation"
         Index           =   8
      End
      Begin VB.Menu VehPurTrn 
         Caption         =   "Vehicle Rate List"
         Index           =   9
      End
      Begin VB.Menu VehPurTrn 
         Caption         =   "Vehicle Issue Entry"
         Index           =   10
      End
      Begin VB.Menu VehPurTrn 
         Caption         =   "Subvention Master"
         Index           =   11
      End
      Begin VB.Menu Sep1 
         Caption         =   "-"
         Index           =   1
         Visible         =   0   'False
      End
      Begin VB.Menu MktData 
         Caption         =   "Competitor's Database"
         Index           =   1
         Visible         =   0   'False
      End
      Begin VB.Menu MktData 
         Caption         =   "RTO Database"
         Index           =   2
         Visible         =   0   'False
      End
      Begin VB.Menu Sep2 
         Caption         =   "-"
         Index           =   1
      End
      Begin VB.Menu VehMas 
         Caption         =   "Repwise-Modelwise Target"
         Index           =   1
      End
      Begin VB.Menu VehMas 
         Caption         =   "Financier Master"
         Index           =   2
      End
      Begin VB.Menu VehMas 
         Caption         =   "Addition / Deletion Items"
         Index           =   3
      End
      Begin VB.Menu VehMas 
         Caption         =   "-"
         Index           =   5
      End
      Begin VB.Menu Doc 
         Caption         =   "Documents"
         Index           =   1
         Begin VB.Menu Doc1 
            Caption         =   "Vehicle Detail Card"
            Index           =   1
         End
         Begin VB.Menu Doc1 
            Caption         =   "TDS Certificate"
            Index           =   2
         End
      End
      Begin VB.Menu VehMas1 
         Caption         =   "-"
         Index           =   1
      End
      Begin VB.Menu VehRep 
         Caption         =   "Daily Reports"
         Index           =   2
         Begin VB.Menu MnVehReports 
            Caption         =   "Money Receipt Register"
            Index           =   0
         End
         Begin VB.Menu MnVehReports 
            Caption         =   "Chassis Received Register"
            Index           =   1
         End
         Begin VB.Menu MnVehReports 
            Caption         =   "Purchase Register"
            Index           =   2
         End
         Begin VB.Menu MnVehReports 
            Caption         =   "Purchase Register (Summary)"
            Index           =   3
            Visible         =   0   'False
         End
         Begin VB.Menu MnVehReports 
            Caption         =   "Vehicle In Transit Report"
            Index           =   4
         End
         Begin VB.Menu MnVehReports 
            Caption         =   "Vehicle Booking Register"
            Index           =   5
         End
         Begin VB.Menu MnVehReports 
            Caption         =   "Retail Sale Report"
            Index           =   6
         End
         Begin VB.Menu MnVehReports 
            Caption         =   "Daily Sale Report (Own)"
            Index           =   7
         End
         Begin VB.Menu MnVehReports 
            Caption         =   "Vehicle Sale Register"
            Index           =   8
         End
         Begin VB.Menu MnVehReports 
            Caption         =   "Sale Register (Summary)"
            Index           =   9
            Visible         =   0   'False
         End
         Begin VB.Menu MnVehReports 
            Caption         =   "Delivery Challan Register"
            Index           =   10
         End
         Begin VB.Menu MnVehReports 
            Caption         =   "Additional Fitment Register"
            Index           =   11
         End
         Begin VB.Menu MnVehReports 
            Caption         =   "Vehicle Stock Register"
            Index           =   12
         End
         Begin VB.Menu MnVehReports 
            Caption         =   "Vehicle Stock For Bank"
            Index           =   13
         End
         Begin VB.Menu MnVehReports 
            Caption         =   "Vehicle Stock Holding Report"
            Index           =   14
         End
         Begin VB.Menu MnVehReports 
            Caption         =   "Vehicle Summary (Model-wise)"
            Index           =   15
         End
         Begin VB.Menu MnVehReports 
            Caption         =   "Vehicle Sale Purchase Report"
            Index           =   16
         End
         Begin VB.Menu MnVehReports 
            Caption         =   "Target Collection Report"
            Index           =   17
         End
         Begin VB.Menu MnVehReports 
            Caption         =   "Quotation Register"
            Index           =   18
         End
         Begin VB.Menu MnVehReports 
            Caption         =   "Vehicle Sale Cancel Register"
            Index           =   19
         End
         Begin VB.Menu MnVehReports 
            Caption         =   "Input Tax Register"
            Index           =   20
         End
         Begin VB.Menu MnVehReports 
            Caption         =   "SalesMan wise Pending Amount"
            Index           =   21
         End
         Begin VB.Menu MnVehReports 
            Caption         =   "Outstanding Payment Report"
            Index           =   22
         End
         Begin VB.Menu MnVehReports 
            Caption         =   "Vehicle Transfer Register"
            Index           =   23
         End
         Begin VB.Menu MnVehReports 
            Caption         =   "Output Tax Register"
            Index           =   24
         End
         Begin VB.Menu MnVehReports 
            Caption         =   "Vehicle Follow Up"
            Index           =   25
         End
         Begin VB.Menu MnVehReports 
            Caption         =   "Income Tax Register"
            Index           =   26
         End
         Begin VB.Menu MnVehReports 
            Caption         =   "VAT Difference Register"
            Index           =   27
         End
      End
      Begin VB.Menu VehRep 
         Caption         =   "Periodic Reports"
         Index           =   3
         Begin VB.Menu MnVehReports1 
            Caption         =   "Model/Branch-wise Report"
            Index           =   1
         End
         Begin VB.Menu MnVehReports1 
            Caption         =   "Model/Branch-wise Sale Delivery"
            Index           =   2
         End
         Begin VB.Menu MnVehReports1 
            Caption         =   "Monthly Target/Sale Qty Difference"
            Index           =   3
         End
         Begin VB.Menu MnVehReports1 
            Caption         =   "Model/Financier-wise Sale Report"
            Index           =   4
         End
         Begin VB.Menu MnVehReports1 
            Caption         =   "Model-wise/Group-wise Monthly"
            Index           =   5
         End
         Begin VB.Menu MnVehReports1 
            Caption         =   "Area-wise/Model-wise Yearly"
            Index           =   6
         End
         Begin VB.Menu MnVehReports1 
            Caption         =   "Financier/Model-wise Monthly"
            Index           =   7
         End
         Begin VB.Menu MnVehReports1 
            Caption         =   "Model/Financier-wise Micro"
            Index           =   8
            Visible         =   0   'False
         End
         Begin VB.Menu MnVehReports1 
            Caption         =   "Model-wise Customer List"
            Index           =   9
         End
         Begin VB.Menu MnVehReports1 
            Caption         =   "Sales/Purchase Price Difference"
            Index           =   10
         End
         Begin VB.Menu MnVehReports1 
            Caption         =   "Delay Delivery Interest Report"
            Index           =   11
         End
         Begin VB.Menu MnVehReports1 
            Caption         =   "Area-wise Financier-wise Sale"
            Index           =   12
         End
         Begin VB.Menu MnVehReports1 
            Caption         =   "E-Mail (Retail Sales)"
            Index           =   13
            Visible         =   0   'False
         End
         Begin VB.Menu MnVehReports1 
            Caption         =   "Vehicle Sale Summary(Form-wise)"
            Index           =   14
         End
         Begin VB.Menu MnVehReports1 
            Caption         =   "Vehicle Purchase/Sale Audit"
            Index           =   15
         End
         Begin VB.Menu MnVehReports1 
            Caption         =   "Month Summary"
            Index           =   16
         End
         Begin VB.Menu MnVehReports1 
            Caption         =   "Vehicle Profitability Report"
            Index           =   17
         End
      End
      Begin VB.Menu VehRep 
         Caption         =   "Telco Reports"
         Index           =   4
         Begin VB.Menu TelRep 
            Caption         =   "Daily Sale Report "
            Index           =   0
         End
         Begin VB.Menu TelRep 
            Caption         =   "Customer Database (F001)"
            Index           =   1
            Visible         =   0   'False
         End
         Begin VB.Menu TelRep 
            Caption         =   "Loast Customer Information (F002)"
            Index           =   2
            Visible         =   0   'False
         End
         Begin VB.Menu TelRep 
            Caption         =   "Market Coverage Plan (MCP)  (F006)"
            Index           =   3
            Visible         =   0   'False
         End
         Begin VB.Menu TelRep 
            Caption         =   "Offtake Incentive Claim Letter"
            Index           =   4
            Visible         =   0   'False
         End
         Begin VB.Menu TelRep 
            Caption         =   "Subvention Letter"
            Index           =   5
            Visible         =   0   'False
         End
         Begin VB.Menu TelRep 
            Caption         =   "Financer Certificate"
            Index           =   6
            Visible         =   0   'False
         End
         Begin VB.Menu TelRep 
            Caption         =   "Subvention Claim Register"
            Index           =   7
         End
      End
   End
   Begin VB.Menu MnuSpr 
      Caption         =   "&Stores"
      Begin VB.Menu SprSalTrn 
         Caption         =   "Quotation"
         Index           =   1
      End
      Begin VB.Menu SprSalTrn 
         Caption         =   "Sale Order Entry"
         Index           =   2
      End
      Begin VB.Menu SprSalTrn 
         Caption         =   "Dispatch Challan Entry"
         Index           =   3
      End
      Begin VB.Menu SprSalTrn 
         Caption         =   "Sale Bill Entry"
         Index           =   4
      End
      Begin VB.Menu SprSalTrn 
         Caption         =   "Goods Return (Inward)"
         Index           =   5
      End
      Begin VB.Menu SprSalTrn 
         Caption         =   "Requisition Issue"
         Index           =   6
      End
      Begin VB.Menu SprSalTrn 
         Caption         =   "Requisition Returns"
         Index           =   7
      End
      Begin VB.Menu SprSalTrn 
         Caption         =   "Stock Adjustments"
         Index           =   8
      End
      Begin VB.Menu SprSalTrn 
         Caption         =   "Customer Receipt"
         Index           =   9
         Shortcut        =   ^R
      End
      Begin VB.Menu SprSalTrn 
         Caption         =   "-"
         Index           =   11
      End
      Begin VB.Menu SprPurTrn 
         Caption         =   "Purchase Order "
         Index           =   1
      End
      Begin VB.Menu SprPurTrn 
         Caption         =   "Goods Receipts"
         Index           =   2
      End
      Begin VB.Menu SprPurTrn 
         Caption         =   "Purchase Bill"
         Index           =   3
      End
      Begin VB.Menu SprPurTrn 
         Caption         =   "Goods Return (Outward)"
         Index           =   4
      End
      Begin VB.Menu SprPartSep 
         Caption         =   "-"
         Index           =   1
      End
      Begin VB.Menu SprMas 
         Caption         =   "Aggregate Master"
         Index           =   1
      End
      Begin VB.Menu SprMas 
         Caption         =   "Discount Factor Master"
         Index           =   2
      End
      Begin VB.Menu SprMas 
         Caption         =   "Proprietory Part Grade Master"
         Index           =   3
      End
      Begin VB.Menu SprMas 
         Caption         =   "Part Master"
         Index           =   4
      End
      Begin VB.Menu SprMas 
         Caption         =   "Spare Price List"
         Index           =   5
      End
      Begin VB.Menu SprMas 
         Caption         =   "Price List Updation"
         Index           =   6
      End
      Begin VB.Menu SprMas 
         Caption         =   "Spare Sale Target"
         Index           =   7
      End
      Begin VB.Menu SprMas 
         Caption         =   "Physical Stock Updation"
         Index           =   8
      End
      Begin VB.Menu SprPurSep 
         Caption         =   "-"
         Index           =   1
      End
      Begin VB.Menu SprPurRep 
         Caption         =   "Purchase  Reports"
         Index           =   1
         Begin VB.Menu MnPurRep 
            Caption         =   "Purchase Order Register"
            Index           =   0
         End
         Begin VB.Menu MnPurRep 
            Caption         =   "Material Register"
            Index           =   1
         End
         Begin VB.Menu MnPurRep 
            Caption         =   "Purchase Register"
            Index           =   2
         End
         Begin VB.Menu MnPurRep 
            Caption         =   "Other Purchase Register"
            Index           =   3
         End
         Begin VB.Menu MnPurRep 
            Caption         =   "Purchase Return Register"
            Index           =   4
         End
         Begin VB.Menu MnPurRep 
            Caption         =   "Stock Transfer Register"
            Index           =   5
         End
         Begin VB.Menu MnPurRep 
            Caption         =   "Part-wise Purchase Report"
            Index           =   6
         End
         Begin VB.Menu MnPurRep 
            Caption         =   "Purchase Summary"
            Index           =   7
         End
         Begin VB.Menu MnPurRep 
            Caption         =   "Purchase Tax Summary"
            Index           =   8
         End
      End
      Begin VB.Menu SprSalesRep 
         Caption         =   "Sales Reports"
         Index           =   1
         Begin VB.Menu MnSalesRep 
            Caption         =   "Quotation Register"
            Index           =   1
         End
         Begin VB.Menu MnSalesRep 
            Caption         =   "Sale Order Register"
            Index           =   2
         End
         Begin VB.Menu MnSalesRep 
            Caption         =   "Challan/Transfer Register"
            Index           =   3
         End
         Begin VB.Menu MnSalesRep 
            Caption         =   "Counter (W/C)  Sales Register"
            Index           =   4
         End
         Begin VB.Menu MnSalesRep 
            Caption         =   "Sales Return Register"
            Index           =   5
         End
         Begin VB.Menu MnSalesRep 
            Caption         =   "Daily Sales(Spare+Lubes) Report(W/C)"
            Index           =   6
         End
         Begin VB.Menu MnSalesRep 
            Caption         =   "Month-wise Sales(Spare+Lubes) Report(W/C)"
            Index           =   7
         End
         Begin VB.Menu MnSalesRep 
            Caption         =   "Part-wise Sale Report"
            Index           =   8
         End
         Begin VB.Menu MnSalesRep 
            Caption         =   "Sale Summary"
            Index           =   9
         End
         Begin VB.Menu MnSalesRep 
            Caption         =   "MRP Sales Tax Claims"
            Index           =   10
         End
         Begin VB.Menu MnSalesRep 
            Caption         =   "Sales Tax Control Statement"
            Index           =   11
         End
         Begin VB.Menu MnSalesRep 
            Caption         =   "Warranty Tax Reimburshment"
            Index           =   12
         End
         Begin VB.Menu MnSalesRep 
            Caption         =   "Input Tax Register"
            Index           =   13
         End
         Begin VB.Menu MnSalesRep 
            Caption         =   "Output Tax Register"
            Index           =   14
         End
         Begin VB.Menu MnSalesRep 
            Caption         =   "Daily Lubricant Consumption"
            Index           =   15
         End
         Begin VB.Menu MnSalesRep 
            Caption         =   "Sale Analysis "
            Index           =   16
         End
         Begin VB.Menu MnSalesRep 
            Caption         =   "Sales Man Wise Outstanding Amt."
            Index           =   17
         End
         Begin VB.Menu MnSalesRep 
            Caption         =   "Sale Tax Summary"
            Index           =   18
         End
      End
      Begin VB.Menu StkRep 
         Caption         =   "Stock Reports"
         Index           =   1
         Begin VB.Menu SprStkRep 
            Caption         =   "Stock Ledger"
            Index           =   1
         End
         Begin VB.Menu SprStkRep 
            Caption         =   "Stock Summary"
            Index           =   2
         End
         Begin VB.Menu SprStkRep 
            Caption         =   "Stock In Hand"
            Index           =   3
         End
         Begin VB.Menu SprStkRep 
            Caption         =   "Indent Register"
            Index           =   4
            Visible         =   0   'False
         End
         Begin VB.Menu SprStkRep 
            Caption         =   "Stock Above/Below/ReOrder Lavel"
            Index           =   5
         End
         Begin VB.Menu SprStkRep 
            Caption         =   "Bin-wise Spare Stock"
            Index           =   6
         End
         Begin VB.Menu SprStkRep 
            Caption         =   "Part Movement Register"
            Index           =   7
         End
         Begin VB.Menu SprStkRep 
            Caption         =   "Part Ageing Analysis"
            Index           =   8
         End
         Begin VB.Menu SprStkRep 
            Caption         =   "Stock Verification Sheet"
            Enabled         =   0   'False
            Index           =   9
            Visible         =   0   'False
         End
      End
      Begin VB.Menu SprMIS 
         Caption         =   "MIS"
         Begin VB.Menu MnSprMIS 
            Caption         =   "Counter Rate Variation Report"
            Index           =   1
            Visible         =   0   'False
         End
         Begin VB.Menu MnSprMIS 
            Caption         =   "Purchase Rate Variation Report"
            Index           =   2
            Visible         =   0   'False
         End
         Begin VB.Menu MnSprMIS 
            Caption         =   "ABC Analysis"
            Index           =   3
         End
         Begin VB.Menu MnSprMIS 
            Caption         =   "FSN Analysis"
            Index           =   4
         End
         Begin VB.Menu MnSprMIS 
            Caption         =   "XYZ Analysis"
            Index           =   5
         End
         Begin VB.Menu MnSprMIS 
            Caption         =   "Stock Ledger (FIFO)"
            Index           =   6
            Visible         =   0   'False
         End
         Begin VB.Menu MnSprMIS 
            Caption         =   "Stock Valuation (FIFO)"
            Index           =   7
         End
         Begin VB.Menu MnSprMIS 
            Caption         =   "Part-wise Profitibility"
            Index           =   8
         End
         Begin VB.Menu MnSprMIS 
            Caption         =   "Sales Vs Inventory"
            Index           =   9
         End
         Begin VB.Menu MnSprMIS 
            Caption         =   "Inventory Projection Report"
            Index           =   10
         End
      End
      Begin VB.Menu SprTaxForm 
         Caption         =   "Tax Forms"
         Index           =   1
         Visible         =   0   'False
         Begin VB.Menu mnSprTaxForm 
            Caption         =   "Form Issue Against Spare Purchase"
            Index           =   1
         End
         Begin VB.Menu mnSprTaxForm 
            Caption         =   "Form Issue Against Spare Sale"
            Index           =   2
         End
         Begin VB.Menu mnSprTaxForm 
            Caption         =   "Form Issue Against Vehicle Purchase"
            Index           =   3
         End
         Begin VB.Menu mnSprTaxForm 
            Caption         =   "Form Received Against Vehicle Sale"
            Index           =   4
         End
         Begin VB.Menu mnSprTaxForm 
            Caption         =   "Road Permit Form Utilization Spare"
            Index           =   5
         End
         Begin VB.Menu mnSprTaxForm 
            Caption         =   "Road Permit Form Utilization Vehicle"
            Index           =   6
         End
         Begin VB.Menu mnSprTaxForm 
            Caption         =   "Form Reminder Spare"
            Index           =   7
         End
         Begin VB.Menu mnSprTaxForm 
            Caption         =   "Form Reminder Vehicle"
            Index           =   8
         End
      End
   End
   Begin VB.Menu MnuWorks 
      Caption         =   "Works&hop"
      Begin VB.Menu WrkTrn 
         Caption         =   "Service Booking"
         Index           =   1
      End
      Begin VB.Menu WrkTrn 
         Caption         =   "Job Card Opening"
         Index           =   2
      End
      Begin VB.Menu WrkTrn 
         Caption         =   "Spare Requisition "
         Index           =   3
         Visible         =   0   'False
      End
      Begin VB.Menu WrkTrn 
         Caption         =   "Works Gate Pass"
         Index           =   4
      End
      Begin VB.Menu WrkTrn 
         Caption         =   "Labour Done"
         Index           =   5
      End
      Begin VB.Menu WrkTrn 
         Caption         =   "Performa Labour"
         Index           =   6
      End
      Begin VB.Menu WrkTrn 
         Caption         =   "Supervisor Observation"
         Index           =   7
      End
      Begin VB.Menu WrkTrn 
         Caption         =   "Estimate"
         Index           =   8
      End
      Begin VB.Menu WrkTrn 
         Caption         =   "Job Close/Un Close"
         Index           =   9
      End
      Begin VB.Menu WrkTrn 
         Caption         =   "Customer Receipt"
         Index           =   10
      End
      Begin VB.Menu WrkTrn 
         Caption         =   "Over Time Entry"
         Index           =   11
      End
      Begin VB.Menu W_Sep 
         Caption         =   "-"
         Index           =   1
      End
      Begin VB.Menu WrkRep 
         Caption         =   "Daily Reports"
         Index           =   1
         Begin VB.Menu WrkDRep 
            Caption         =   "Estimate Register"
            Index           =   1
         End
         Begin VB.Menu WrkDRep 
            Caption         =   "Performa Register"
            Index           =   2
         End
         Begin VB.Menu WrkDRep 
            Caption         =   "JobCard Register"
            Index           =   3
         End
         Begin VB.Menu WrkDRep 
            Caption         =   "Internal Requisition Register"
            Index           =   4
         End
         Begin VB.Menu WrkDRep 
            Caption         =   "Part Grade-wise Requisition Register"
            Index           =   5
         End
         Begin VB.Menu WrkDRep 
            Caption         =   "Out-side Labour Register"
            Index           =   6
         End
         Begin VB.Menu WrkDRep 
            Caption         =   "Workshop Sale Register"
            Index           =   7
         End
         Begin VB.Menu WrkDRep 
            Caption         =   "Workshop Vehicle Diary"
            Index           =   8
         End
         Begin VB.Menu WrkDRep 
            Caption         =   "Sale Register"
            Index           =   9
         End
         Begin VB.Menu WrkDRep 
            Caption         =   "Gate Pass Register"
            Index           =   10
         End
         Begin VB.Menu WrkDRep 
            Caption         =   "Over Time Register"
            Index           =   11
         End
         Begin VB.Menu WrkDRep 
            Caption         =   "Veh History Register"
            Index           =   12
         End
         Begin VB.Menu WrkDRep 
            Caption         =   "Job Booking Register"
            Index           =   13
         End
      End
      Begin VB.Menu WkShopRep 
         Caption         =   "WorkShop Reports"
         Index           =   1
         Begin VB.Menu WkShop 
            Caption         =   "Labour Rate Variation Reports"
            Index           =   1
         End
         Begin VB.Menu WkShop 
            Caption         =   "Service Analysis Details"
            Index           =   2
            Visible         =   0   'False
         End
         Begin VB.Menu WkShop 
            Caption         =   "Service -wise Job Analysis"
            Index           =   3
            Visible         =   0   'False
         End
         Begin VB.Menu WkShop 
            Caption         =   "Model-wise Service Analysis"
            Index           =   4
         End
         Begin VB.Menu WkShop 
            Caption         =   "WorkShop Demand Vs Supply"
            Index           =   5
            Visible         =   0   'False
         End
         Begin VB.Menu WkShop 
            Caption         =   "Mechanic Earning Report"
            Index           =   6
         End
         Begin VB.Menu WkShop 
            Caption         =   "Mechanic Earning Summary"
            Index           =   7
         End
         Begin VB.Menu WkShop 
            Caption         =   "Dealer-wise Vehicle Attended"
            Index           =   8
         End
         Begin VB.Menu WkShop 
            Caption         =   "Model-wise Job Analysis"
            Index           =   9
         End
         Begin VB.Menu WkShop 
            Caption         =   "Aggregate Group-wise Inventory"
            Index           =   10
            Visible         =   0   'False
         End
         Begin VB.Menu WkShop 
            Caption         =   "Job-wise Labour Analysis"
            Index           =   11
         End
         Begin VB.Menu WkShop 
            Caption         =   "Dealer-wise Job Analysis"
            Index           =   12
            Visible         =   0   'False
         End
         Begin VB.Menu WkShop 
            Caption         =   "Delay Reason Analysis"
            Index           =   13
         End
         Begin VB.Menu WkShop 
            Caption         =   "WorkShop Rate Variation Report"
            Index           =   14
         End
         Begin VB.Menu WkShop 
            Caption         =   "Cancellation Report(W/C)"
            Index           =   15
         End
         Begin VB.Menu WkShop 
            Caption         =   "Labour Incentive Report"
            Index           =   16
            Visible         =   0   'False
         End
         Begin VB.Menu WkShop 
            Caption         =   "Vehicle Grading Report"
            Index           =   17
         End
         Begin VB.Menu WkShop 
            Caption         =   "Service Tax Register"
            Index           =   18
         End
         Begin VB.Menu WkShop 
            Caption         =   "Labour Revenue Report"
            Index           =   19
         End
         Begin VB.Menu WkShop 
            Caption         =   "Service Due Register"
            Index           =   20
         End
         Begin VB.Menu WkShop 
            Caption         =   "Quarterly Return Register"
            Index           =   21
         End
         Begin VB.Menu WkShop 
            Caption         =   "Post Service Followups"
            Index           =   22
         End
         Begin VB.Menu WkShop 
            Caption         =   "Sales Tax With Serv. Tax"
            Index           =   23
         End
         Begin VB.Menu WkShop 
            Caption         =   "Repeat Job Analysis"
            Index           =   24
         End
      End
      Begin VB.Menu W_Sep2 
         Caption         =   "-"
         Visible         =   0   'False
      End
      Begin VB.Menu Claims 
         Caption         =   "Claims Warranty Entry"
         Index           =   1
         Begin VB.Menu Warr 
            Caption         =   "Warranty Claim Data Entry"
            Index           =   2
         End
         Begin VB.Menu Warr 
            Caption         =   "Warranty Billing"
            Index           =   5
            Visible         =   0   'False
         End
         Begin VB.Menu Warr 
            Caption         =   "Warranty Cr Note / Rejection"
            Index           =   6
            Visible         =   0   'False
         End
         Begin VB.Menu Warr 
            Caption         =   "Complaint Code Master"
            Index           =   7
         End
         Begin VB.Menu Warr 
            Caption         =   "Failure Code Master"
            Index           =   8
         End
         Begin VB.Menu Warr 
            Caption         =   "Make Code Master"
            Index           =   9
         End
         Begin VB.Menu Warr 
            Caption         =   "Job Code Master"
            Index           =   10
         End
      End
      Begin VB.Menu Claims 
         Caption         =   "Claims Free Service/Warranty Reports"
         Index           =   2
         Begin VB.Menu WarrRep 
            Caption         =   "Warranty Claim Register"
            Index           =   0
         End
         Begin VB.Menu WarrRep 
            Caption         =   "Claim Not Made"
            Index           =   1
            Visible         =   0   'False
         End
         Begin VB.Menu WarrRep 
            Caption         =   "Claim Not Verified"
            Index           =   2
            Visible         =   0   'False
         End
         Begin VB.Menu WarrRep 
            Caption         =   "Claim not Dispatched"
            Index           =   3
            Visible         =   0   'False
         End
         Begin VB.Menu WarrRep 
            Caption         =   "Claim Rejected"
            Index           =   4
            Visible         =   0   'False
         End
         Begin VB.Menu WarrRep 
            Caption         =   "Claim Outstanding"
            Index           =   5
            Visible         =   0   'False
         End
         Begin VB.Menu WarrRep 
            Caption         =   "Claim Overveiw"
            Index           =   6
            Visible         =   0   'False
         End
         Begin VB.Menu WarrRep 
            Caption         =   "Part not Issued but Claimed"
            Index           =   7
            Visible         =   0   'False
         End
         Begin VB.Menu WarrRep 
            Caption         =   "Part Issued but Not claimed"
            Index           =   8
            Visible         =   0   'False
         End
         Begin VB.Menu WarrRep 
            Caption         =   "Claim Summary"
            Index           =   9
            Visible         =   0   'False
         End
         Begin VB.Menu WarrRep 
            Caption         =   "PDI Free Service Register"
            Index           =   10
         End
         Begin VB.Menu WarrRep 
            Caption         =   "Part Failure Report"
            Index           =   11
            Visible         =   0   'False
         End
         Begin VB.Menu WarrRep 
            Caption         =   "FSB Upload Register"
            Index           =   12
         End
      End
      Begin VB.Menu telcoReports 
         Caption         =   "Tata Motors MIS Reports"
         Index           =   1
         Begin VB.Menu tlcorep 
            Caption         =   "Workshop Performence Report"
            Index           =   1
         End
         Begin VB.Menu tlcorep 
            Caption         =   "Promise Time Deviation Report"
            Index           =   2
         End
         Begin VB.Menu tlcorep 
            Caption         =   "Estimated Cost Deviation"
            Index           =   3
         End
         Begin VB.Menu tlcorep 
            Caption         =   "ModelWise Complaint Analysis"
            Index           =   4
         End
         Begin VB.Menu tlcorep 
            Caption         =   "Aggregate Complaint Analysis"
            Index           =   5
         End
         Begin VB.Menu tlcorep 
            Caption         =   "Repaire Order Analysis"
            Index           =   6
         End
         Begin VB.Menu tlcorep 
            Caption         =   "ModelWise Repeat Complaint Analysis"
            Index           =   7
         End
         Begin VB.Menu tlcorep 
            Caption         =   "Aggregate Wise Repeat Analysis"
            Index           =   8
            Visible         =   0   'False
         End
         Begin VB.Menu tlcorep 
            Caption         =   "Repeat Job Analysis Form"
            Index           =   9
         End
         Begin VB.Menu tlcorep 
            Caption         =   "Summery of Repeat Complaint"
            Index           =   10
         End
         Begin VB.Menu tlcorep 
            Caption         =   "Repeat Job Analysis"
            Index           =   11
         End
         Begin VB.Menu tlcorep 
            Caption         =   "Service Wise Job Analysis"
            Index           =   12
         End
         Begin VB.Menu tlcorep 
            Caption         =   "Service Analysis Details"
            Index           =   13
         End
         Begin VB.Menu tlcorep 
            Caption         =   "Quantitative Complaint Analysis"
            Index           =   14
         End
         Begin VB.Menu tlcorep 
            Caption         =   "Customer Feedback Entry"
            Index           =   15
         End
         Begin VB.Menu tlcorep 
            Caption         =   "Daily Follow Up Calls By CRO"
            Index           =   16
         End
         Begin VB.Menu tlcorep 
            Caption         =   "Dissatisfied Customers"
            Index           =   17
         End
         Begin VB.Menu tlcorep 
            Caption         =   "Customer Satisfaction Report"
            Index           =   18
         End
         Begin VB.Menu tlcorep 
            Caption         =   "Workshop Profit Report"
            Index           =   19
         End
      End
      Begin VB.Menu W_Sep3 
         Caption         =   "-"
      End
      Begin VB.Menu WrkMas 
         Caption         =   "Service Master"
         Index           =   1
      End
      Begin VB.Menu WrkMas 
         Caption         =   "Service Rate/Lube Qty. Declaration"
         Index           =   2
      End
      Begin VB.Menu WrkMas 
         Caption         =   "Labour Group Master"
         Index           =   3
      End
      Begin VB.Menu WrkMas 
         Caption         =   "Labour Type Master"
         Index           =   4
      End
      Begin VB.Menu WrkMas 
         Caption         =   "Labour Description Master"
         Index           =   5
      End
      Begin VB.Menu WrkMas 
         Caption         =   "Model-wise Labour Master"
         Index           =   6
      End
      Begin VB.Menu WrkMas 
         Caption         =   "Model-wise Service-wise Pre-Defined Jobs"
         Index           =   7
      End
      Begin VB.Menu WrkMas 
         Caption         =   "Reason For Job Delay"
         Index           =   8
      End
      Begin VB.Menu WrkMas 
         Caption         =   "Trouble Master"
         Index           =   9
      End
      Begin VB.Menu WrkMas 
         Caption         =   "Inspection Category Master"
         Index           =   10
      End
      Begin VB.Menu WrkMas 
         Caption         =   "Inspection Elements Master"
         Index           =   11
      End
      Begin VB.Menu WrkMas 
         Caption         =   "Workshop Vehicle Master"
         Index           =   12
      End
      Begin VB.Menu WrkMas 
         Caption         =   "Workshop Details Master"
         Index           =   13
      End
   End
   Begin VB.Menu MisDoc 
      Caption         =   "&MIS Documents"
      Visible         =   0   'False
      Begin VB.Menu MisDoc1 
         Caption         =   "Customer Information"
         Index           =   1
      End
      Begin VB.Menu MisDoc1 
         Caption         =   "Customer Concern Entry"
         Index           =   2
      End
      Begin VB.Menu MisDoc1 
         Caption         =   "Finance WorkSheet "
         Index           =   3
      End
      Begin VB.Menu MisDoc1 
         Caption         =   "Vehicle Margin Statistics"
         Index           =   4
      End
   End
   Begin VB.Menu utlty 
      Caption         =   "&Utility"
      Begin VB.Menu Utl 
         Caption         =   "User Permissions"
         Index           =   1
      End
      Begin VB.Menu Utl 
         Caption         =   "-"
         Index           =   2
      End
      Begin VB.Menu Utl 
         Caption         =   "System Controls"
         Index           =   3
      End
      Begin VB.Menu Utl 
         Caption         =   "Vehicle Controls"
         Index           =   4
      End
      Begin VB.Menu Utl 
         Caption         =   "Spare Controls"
         Index           =   5
      End
      Begin VB.Menu Utl 
         Caption         =   "Workshop Controls"
         Index           =   6
      End
      Begin VB.Menu Utl 
         Caption         =   "Voucher Prefix Generation"
         Index           =   7
      End
      Begin VB.Menu Utl 
         Caption         =   "Database  Backup"
         Index           =   13
      End
      Begin VB.Menu Utl 
         Caption         =   "Database  Restore"
         Index           =   14
      End
      Begin VB.Menu Utl 
         Caption         =   "Repair/Compact Database"
         Index           =   15
      End
      Begin VB.Menu Utl 
         Caption         =   "Update Table Structure"
         Index           =   16
      End
      Begin VB.Menu Utl 
         Caption         =   "FA Environment Setting"
         Index           =   21
      End
      Begin VB.Menu Utl 
         Caption         =   "FA Voucher Type Setting"
         Index           =   22
      End
      Begin VB.Menu Utl 
         Caption         =   "Year End Process"
         Index           =   23
      End
      Begin VB.Menu Utl 
         Caption         =   "Update Balances"
         Index           =   24
      End
      Begin VB.Menu Utl 
         Caption         =   "Update VRate"
         Index           =   25
      End
      Begin VB.Menu Utl 
         Caption         =   "A/C Merging"
         Index           =   26
      End
      Begin VB.Menu Utl 
         Caption         =   "Delete Log"
         Index           =   27
      End
      Begin VB.Menu Utl 
         Caption         =   "Update Voucher Counter"
         Index           =   28
      End
   End
   Begin VB.Menu dtools 
      Caption         =   "&Data Tools"
      Begin VB.Menu dtool 
         Caption         =   "Data Send"
         Index           =   0
      End
      Begin VB.Menu dtool 
         Caption         =   "Data Received"
         Index           =   1
      End
      Begin VB.Menu dtool 
         Caption         =   "Data Updation"
         Index           =   2
      End
      Begin VB.Menu dtool 
         Caption         =   "Voucher Number System"
         Index           =   3
      End
      Begin VB.Menu dtool 
         Caption         =   "Make Database Blank"
         Index           =   4
         Visible         =   0   'False
      End
      Begin VB.Menu dtool 
         Caption         =   "Quick Report View"
         Index           =   5
         Visible         =   0   'False
      End
      Begin VB.Menu dtool 
         Caption         =   "Delete Zero Balance A/C"
         Index           =   6
      End
   End
   Begin VB.Menu mnuWindow 
      Caption         =   "&Windows"
      WindowList      =   -1  'True
      Begin VB.Menu mnuWindowCascade 
         Caption         =   "&Cascade"
      End
      Begin VB.Menu mnuWindowTileHorizontal 
         Caption         =   "Tile &Horizontal"
      End
      Begin VB.Menu mnuWindowTileVertical 
         Caption         =   "Tile &Vertical"
      End
   End
   Begin VB.Menu mnuExit 
      Caption         =   "E&xit"
   End
End
Attribute VB_Name = "MDIForm1"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit
Dim NewObj
Private Type DBDetails
    DataPath As String
    PassWord As String
End Type
Public AllowModuleVeh As Boolean
Public AllowModuleSpr As Boolean
Public AllowModuleWrk As Boolean

Private Const SearchDir As Byte = 0
Private Const CreateDir As Byte = 1
Private Const TransAuto As Byte = 2
Private Const TransFA As Byte = 3
Private Const CompProcess As Byte = 4
Dim G_CompCntmp As ADODB.Recordset
Dim G_Rsttmp As ADODB.Recordset
Dim J As Integer
Dim TRec1Qty As Single, TRec2Qty As Single, TQty As Double
Dim mTrf As Boolean, mRate As Double, mPART_ADD As Boolean
Dim mRec_TB_Qty As Double, mRec_TB_Val As Double, mRec_TP_Qty As Double, mRec_TP_Val As Double, StartDate$
Dim mIss_TB_Qty As Double, mIss_TB_Val As Double, mIss_TP_Qty As Double, mIss_TP_Val As Double
Dim xMOP_TBQty As Double, xMOP_TBVal As Double, xMOP_TPQty As Double, xMOP_TPVal As Double
Dim mOP_TB_QTY As Double, mOP_TP_QTY As Double, mOP_TB_VAL As Double, mOP_TP_VAL As Double
Dim mname$, mInv_No$, mInv_Date$, mNarr$
Dim mQRY$, Condstr$, CondDivCode$, CondMarkYN$, CondPartNos$, CondPartNos1$, CondDivCode1$
Dim CondStrMRP$, CondPartNosOpStk$, CondPartNosTrn$
Dim RstPart As ADODB.Recordset, RstPart1 As ADODB.Recordset, RstStock As ADODB.Recordset, RstStock2 As ADODB.Recordset, RstStock3 As ADODB.Recordset
Dim NEW_CONNECTION As ADODB.Connection
'Private Const DayBook As Byte = 1
'Private Const ContraLed As Byte = 2
'Private Const Led As Byte = 3
'Private Const IntLed As Byte = 4
'Private Const CBook As Byte = 5
'Private Const BBook As Byte = 6
'Private Const JBooks As Byte = 7
'Private Const JBook2 As Byte = 8
'Private Const CrNoteBook As Byte = 9
'Private Const Annexure As Byte = 10
'Private Const Trial As Byte = 11
'Private Const SubTrial As Byte = 12
'Private Const BankReg As Byte = 13
'Private Const DrAge As Byte = 14
'Private Const CrAge As Byte = 15
'Private Const TradingPL As Byte = 16
'Private Const PL As Byte = 17
'Private Const Trading As Byte = 18
'Private Const BalSheet As Byte = 19
'Private Const CFlow As Byte = 20
'Private Const FFlow As Byte = 21
'Private Const ChqClReg As Byte = 22
'Private Const ChqNotClReg As Byte = 23
'Private Const DrOutStanding As Byte = 24
'Private Const CrOutStanding As Byte = 25
'Private Const CashBankCurBal As Byte = 26
'Private Const DailyTrnSum As Byte = 27
'Private Const JrnlBook As Byte = 28

Private Sub Doc1_Click(Index As Integer)
PubUParam = Permission(Replace(Doc1(Index).CAPTION, "&", ""))
Select Case Index
    Case 1
       If frmVehChasDCard.Visible = False Then frmVehChasDCard.Show: Set frmVehChasDCard = Nothing
    Case 2
       If frmVehTDSCert.Visible = False Then frmVehTDSCert.Show: Set frmVehTDSCert = Nothing
End Select
End Sub

Private Sub dtool_Click(Index As Integer)
Select Case Index
        Case 0
            If frmDataSend.Visible = False Then frmDataSend.Show: Set frmDataSend = Nothing
        Case 1
            If frmDataRecd.Visible = False Then frmDataRecd.Show: Set frmDataRecd = Nothing
        Case 2
            If FrmDataUpdation.Visible = False Then FrmDataUpdation.Show: Set FrmDataUpdation = Nothing
        Case 3
            MsgBox "Sample Voucher No.= C1/SPIC/10001001 " & vbCrLf & _
                    " Break Up:                  " & vbCrLf & _
                    "       C = Division Code    " & vbCrLf & _
                    "       1 = Site Code        " & vbCrLf & _
                    "       / = Separater        " & vbCrLf & _
                    "       S = Module Name (Spr)" & vbCrLf & _
                    "       PI= Purchase Invoice " & vbCrLf & _
                    "       C = Cash             " & vbCrLf & _
                    "       / = Separator        " & vbCrLf & _
                    "10001001 = Serial No.       ", vbInformation, "Voucher No.System"
        Case 5
            frmQuickRep.Show
        Case 6
            DeleteSubgroup
    End Select
End Sub

'Private Sub FATrn_Click(Index As Integer)
'PubUParam = Permission(Replace(FATrn(Index).CAPTION, "&", ""))
'If PubUParam = "****" Then Exit Sub
'Select Case Index
'    Case 1  'Voucher Entry
'        If frmAccVoucher.Visible = False Then frmAccVoucher.Show: Set frmAccVoucher = Nothing
'    Case 2  'Other Purchase Entry
'        If frmPurOth.Visible = False Then frmPurOth.Show: Set frmPurOth = Nothing
'    Case 3  'Spare A/c Posting
'        If frmAcPost.Visible = False Then frmAcPost.Show: Set frmAcPost = Nothing
'    Case 5  'Ledger A/c Entry
'        If frmSubGroup.Visible = False Then frmSubGroup.Show: Set frmSubGroup = Nothing
'    Case 6  'A/c Group Entry
'        If frmGrEnt.Visible = False Then frmGrEnt.Show: Set frmGrEnt = Nothing
'End Select
'End Sub

Private Sub famM_Click(Index As Integer)
On Error GoTo Errloop
PubUParam = Permission(Replace(famM(Index).CAPTION, "&", ""))
If PubUParam = "****" Then Exit Sub
Select Case Index
    Case 0
        
        Set NewObj = New FaGrEnt
        NewObj.Show
    Case 1
        
        Set NewObj = New frmSubGroup
        NewObj.Show
    Case 2
        Set NewObj = New FaNarrMast
        NewObj.Show
    Case 3
        
        Set NewObj = New frmCity
        NewObj.Show
End Select
Set NewObj = Nothing
Exit Sub
Errloop:    MsgBox err.Description, vbInformation, "Information": Exit Sub
End Sub
Private Sub fame_Click(Index As Integer)
Dim key As String
PubUParam = Permission(Replace(fame(Index).CAPTION, "&", ""))
If PubUParam = "****" Then Exit Sub
On Error GoTo Errloop
Select Case Index
    Case 0
       
        Set NewObj = New FaVrEnt
        NewObj.Show
    Case 1
        Set NewObj = New FaAdjust
        NewObj.Show
    Case 2
        Set NewObj = New FaAdjustDel
        NewObj.Show
    Case 3
        Set NewObj = New FaChqClear
        NewObj.Show
    Case 4
        Set NewObj = New frmPurOth
        NewObj.Show
    Case 5  'Spare A/c Posting
'        key = InputBox("Enter the Key word to open ", "Key Word")
'        If key = "2827272" Then
            Set NewObj = New frmAcPost
            NewObj.Show
'        Else
'            MsgBox "Invalid key.Please Contact Dataman for valid Key"
'            Exit Sub
'        End If
    Case 6
        Set NewObj = New FaTDSCat
        NewObj.Show
    Case 7
        Set NewObj = New FaTDSChal
        NewObj.Show
    Case 8
        Set NewObj = New FaTDSCertificate
        NewObj.Show
  End Select
Set NewObj = Nothing
Exit Sub
Errloop:    MsgBox err.Description, vbInformation, "Information": Exit Sub
End Sub
Private Sub FAREPORT_Click(Index As Integer)
Dim X11 As Variant, NEW_OBJ
On Error GoTo Errloop
    Select Case Index
        Case 0, 3, 4, 5, 6, 7, 10, 13, 14, 15, 22, 23, 24, 25, 27, 29, 30, 31, 32, 33, 34, 35, 36
            Set NEW_OBJ = New FaReports
            Select Case Index
                Case 0      'DayBook
                    NEW_OBJ.GRepFormName = "DayBook"
                Case 3      'Ledger
                    NEW_OBJ.GRepFormName = "Led"
                    NEW_OBJ.BtnParam.Visible = True
                Case 4      'InterestLedger
                    NEW_OBJ.GRepFormName = "LedInt"
                    NEW_OBJ.BtnPrint(1).Visible = False
                    NEW_OBJ.BtnParam.Visible = True
                Case 5      'CashBook
                    NEW_OBJ.GRepFormName = "CashBook"
                    NEW_OBJ.BtnParam.Visible = True
                Case 6      'BankBook
                    NEW_OBJ.GRepFormName = "BankBook"
                    NEW_OBJ.BtnParam.Visible = True
                Case 7 'Journal Book
                    NEW_OBJ.GRepFormName = "JournalBook"
                  
                Case 10 'Annexure
                    NEW_OBJ.GRepFormName = "Annexure"
                    NEW_OBJ.BtnParam.Visible = True
                Case 13
                    NEW_OBJ.GRepFormName = "BankReg"
                    NEW_OBJ.BtnPrint(1).Visible = False
                    NEW_OBJ.BtnParam.Visible = True
                Case 14 'Aging Analysis
                    NEW_OBJ.GRepFormName = "AgingDr"
                    NEW_OBJ.BtnPrint(1).Visible = False
                    NEW_OBJ.BtnParam.Visible = True
                Case 15 'Aging Analysis
                    NEW_OBJ.GRepFormName = "AgingCr"
                    NEW_OBJ.BtnPrint(1).Visible = False
                    NEW_OBJ.BtnParam.Visible = True
                Case 22 'Chq Cleared
                    NEW_OBJ.GRepFormName = "Clg"
                    NEW_OBJ.BtnPrint(1).Visible = False
                    NEW_OBJ.BtnParam.Visible = True
                Case 23 'Chq Not Cleared
                    NEW_OBJ.GRepFormName = "ClgNot"
                    NEW_OBJ.BtnPrint(1).Visible = False
                    NEW_OBJ.BtnParam.Visible = True
                Case 24
                    NEW_OBJ.GRepFormName = "LedDeb"
                    NEW_OBJ.BtnPrint(1).CAPTION = "Letter"
                    NEW_OBJ.BtnParam.Visible = True
                Case 25
                    NEW_OBJ.GRepFormName = "LedCred"
                    NEW_OBJ.BtnPrint(1).Visible = False
                    NEW_OBJ.BtnParam.Visible = True
                Case 27 'Daily Transaction Summary
                    NEW_OBJ.GRepFormName = "DailySumm"
                    NEW_OBJ.BtnParam.Visible = True
                Case 29 'Non Transaction Report
                    NEW_OBJ.GRepFormName = "NonTrans"
                    NEW_OBJ.BtnPrint(1).Visible = False
                Case 30 'Reference Report
                    NEW_OBJ.GRepFormName = "RefReport"
                    NEW_OBJ.BtnPrint(1).Visible = False
                Case 31 'Detailed Trial
                    NEW_OBJ.GRepFormName = "DetailedTrial"
                    NEW_OBJ.BtnPrint(1).Visible = False
                Case 32 'Chq Not Cleared
                    NEW_OBJ.GRepFormName = "AcCheckList"
                    NEW_OBJ.BtnParam.Visible = True
                Case 33
                    NEW_OBJ.GRepFormName = "DUELIST"
                    NEW_OBJ.BtnPrint(1).Visible = True
                Case 34
                    NEW_OBJ.GRepFormName = "CONTROLLED"
                Case 35      'RozNamcha
                    NEW_OBJ.GRepFormName = "RozNamcha"
                Case 36
                    Set NEW_OBJ = ReprtFormGlobal
                    NEW_OBJ.GRepFormName = 39
                    NEW_OBJ.Show
            End Select
            NEW_OBJ.CAPTION = Replace(FAREPORT(Index).CAPTION, "&", "")
    End Select
    Set NEW_OBJ = Nothing
    Exit Sub
Errloop:    MsgBox err.Description, vbInformation, "Information": Exit Sub
End Sub


Private Sub FAREPORTD_Click(Index As Integer)
Dim mOpenType As String
    Select Case Index
        Case 0
            mOpenType = ("BALSHEET")
        Case 1
            mOpenType = ("PROFLOSS")
        Case 2
            mOpenType = ("GROUPTRIAL")
        Case 3
            mOpenType = ("LEDTRIAL")
        Case 4
            mOpenType = ("CASHFLOW")
        Case 5
            mOpenType = ("FUNDFLOW")
        Case 6
            mOpenType = ("CASHBANKSUM")
    End Select
    If mOpenType <> "" Then
        Set NewObj = New FaMagic
        NewObj.ShowSiteWise = False
        NewObj.OpenType = mOpenType
        NewObj.CAPTION = Replace(FAREPORTD(Index).CAPTION, "&", "")
        NewObj.Show
    End If
    Set NewObj = Nothing
End Sub
Private Sub FAREPORTDS_Click(Index As Integer)
Dim mOpenType As String
    Select Case Index
        Case 0
            mOpenType = ("BALSHEET")
        Case 1
            mOpenType = ("PROFLOSS")
        Case 2
            mOpenType = ("GROUPTRIAL")
        Case 3
            mOpenType = ("LEDTRIAL")
        Case 4
            mOpenType = ("CASHFLOW")
        Case 5
            mOpenType = ("FUNDFLOW")
        Case 6
            mOpenType = ("CASHBANKSUM")
    End Select
    If mOpenType <> "" Then
        Set NewObj = New FaMagic
        NewObj.ShowSiteWise = True
        NewObj.OpenType = mOpenType
'        NewObj.CAPTION = Replace(FAREPORTDS(Index).CAPTION, "&", "")
        NewObj.Show
    End If
    Set NewObj = Nothing
End Sub
Private Sub MDIForm_Activate()
On Error Resume Next
Utl(27).Visible = False
 
If UCase(left(PubComp_Name, 5)) = "UJWAL" Then
    dtool(6).Visible = True
Else
    dtool(6).Visible = False
End If

If RSOJPR = True Then
    G_CompCn.Execute "Alter table UserMast add BckpY_N text (1) "
    G_CompCn.Execute "update UserMast set BckpY_N='0'"
    G_CompCn.Execute "Create table Backuplog (BackupDt date)"
    If G_CompCn.Execute("Select * from Backuplog").RecordCount = 0 Then
        G_CompCn.Execute "Insert into Backuplog values(#01/Jan/2005#)"
    End If
    G_CompCn.Execute ("Update UserMast set BckpY_N='1'")
    Dim CurrDate As Date, LastBkpDate As Date
    LastBkpDate = G_CompCn.Execute("Select BackupDt from Backuplog").Fields(0).Value
    CurrDate = G_FaCn.Execute("Select Max(V_Date) from Ledger").Fields(0).Value
    If IsNull(LastBkpDate) Or CDate(CurrDate) > CDate(LastBkpDate) Then
        FrmBackup.Show
        FrmBackup.Label1.CAPTION = "Dear " & pubUName & " ! You are the first user to login today.Please Wait, Software will perform following actions  automatically .."
        FrmBackup.Image1(0).Visible = True
        Call DataBackup
        FrmBackup.Image1(0).Visible = False
        FrmBackup.Image1(1).Visible = True
        FrmBackup.Image1(1).Refresh
        Call UpdtCurrBalances
        FrmBackup.Image1(1).Visible = False
        G_CompCn.Execute ("Update Backuplog set BackupDt=" & ConvertDate(CurrDate) & "")
        Unload FrmBackup
    End If
    G_CompCn.Execute ("Update UserMast set BckpY_N='0'")
    Utl(27).Visible = True
End If
End Sub

Private Sub MDIForm_QueryUnload(Cancel As Integer, UnloadMode As Integer)
If UnloadMode = 0 Then
    End
End If
End Sub

Private Sub MisDoc1_Click(Index As Integer)
PubUParam = Permission(Replace(VehSalTrn(Index).CAPTION, "&", ""))
If PubUParam = "****" Then Exit Sub
Select Case Index
    Case 1     'Customer Information
        If frmCustInfo.Visible = False Then frmCustInfo.Show: Set frmCustInfo = Nothing
    Case 2     'Customer Concern
        If FrmCustConern.Visible = False Then FrmCustConern.Show: Set FrmCustConern = Nothing
    Case 3     'Finance Worksheet
        If FrmFinWrkSheet.Visible = False Then FrmFinWrkSheet.Show: Set FrmFinWrkSheet = Nothing
    Case 4     'vehicle margine
        If FrmVehMargin.Visible = False Then FrmVehMargin.Show: Set FrmVehMargin = Nothing
End Select
End Sub
Private Sub MnPurRep_Click(Index As Integer)
Dim rep As CrystalReport, Menucaption$, ReportForm As Form
PubUParam = Permission(Replace(MnPurRep(Index).CAPTION, "&", ""))
On Error GoTo errhand
Menucaption = UCase(Replace(Replace(MnPurRep(Index).CAPTION, "&", ""), " ", ""))
Set ReportForm = New ReprtFormGlobal
Select Case Menucaption
    Case UCase(Replace("Purchase Order Register", " ", ""))
        ReportForm.GRepFormName = 5
    Case UCase(Replace("Material Register", " ", ""))
        ReportForm.GRepFormName = 6
    Case UCase(Replace("Purchase Register", " ", ""))
        ReportForm.GRepFormName = 7
    Case UCase(Replace("Purchase Return Register", " ", ""))
        ReportForm.GRepFormName = 8
    Case UCase(Replace("Stock Transfer Register", " ", ""))
        ReportForm.GRepFormName = 9
    Case UCase(Replace("Part-wise Purchase Report", " ", ""))
        ReportForm.GRepFormName = 18    '25
    Case UCase(Replace("Purchase Summary", " ", ""))
        ReportForm.GRepFormName = 19 '27
    Case UCase(Replace("Other Purchase Register", " ", ""))
        ReportForm.GRepFormName = 30 '27
    Case UCase(Replace("Purchase Tax Summary", " ", ""))
        ReportForm.GRepFormName = 40 '27
End Select
With ReportForm
    .CAPTION = MnPurRep(Index).CAPTION
    .LblTitle = MnPurRep(Index).CAPTION
    .Show
End With
Set ReportForm = Nothing
    Exit Sub
errhand:
    MsgBox err.Description, vbInformation, "Information": Exit Sub
End Sub
Private Sub MnSalesRep_Click(Index As Integer)
Dim rep As CrystalReport, Menucaption$, ReportForm As Form
PubUParam = Permission(Replace(MnSalesRep(Index).CAPTION, "&", ""))
On Error GoTo errhand
Menucaption = UCase(Replace(Replace(MnSalesRep(Index).CAPTION, "&", ""), " ", ""))
If Menucaption = UCase(Replace("Quotation Register", " ", "")) Then
    Set ReportForm = New ReportWorkShop2
Else
    Set ReportForm = New ReprtFormGlobal
End If
Select Case Menucaption
    Case UCase(Replace("Quotation Register", " ", ""))
        ReportForm.GRepFormName = 1
    Case UCase(Replace("Sale Order Register", " ", ""))
        ReportForm.GRepFormName = 2
    Case UCase(Replace("Challan/Transfer Register", " ", ""))
        ReportForm.GRepFormName = 32
    Case UCase(Replace("Counter (W/C)  Sales Register", " ", ""))
        ReportForm.GRepFormName = 3
    Case UCase(Replace("Sales Return Register", " ", ""))
        ReportForm.GRepFormName = 4
    Case UCase(Replace("Sales Tax Control Statement", " ", ""))
        ReportForm.GRepFormName = 31
    Case UCase(Replace("Input Tax Register", " ", ""))
        ReportForm.GRepFormName = 34
    Case UCase(Replace("Output Tax Register", " ", ""))
        ReportForm.GRepFormName = 35
    Case UCase(Replace("Daily Sales(Spare+Lubes) Report(W/C)", " ", ""))
        ReportForm.GRepFormName = 16
    Case UCase(Replace("Month-wise Sales(Spare+Lubes) Report(W/C)", " ", ""))
        ReportForm.GRepFormName = 17
    Case UCase(Replace("Part-wise Sale Report", " ", ""))
        ReportForm.GRepFormName = 20
    Case UCase(Replace("Sale Summary", " ", ""))
        ReportForm.GRepFormName = 21
    Case UCase(Replace("MRP Sales Tax Claims", " ", ""))
        ReportForm.GRepFormName = 29
    Case UCase(Replace("Warranty Tax Reimburshment", " ", ""))
        ReportForm.GRepFormName = 33
    Case UCase(Replace("Daily Lubricant Consumption", " ", ""))
        ReportForm.GRepFormName = 36
    Case UCase(Replace("Sale Analysis", " ", ""))
        ReportForm.GRepFormName = 37
    Case UCase(Replace("Sales Man Wise Outstanding Amt. ", " ", ""))
        ReportForm.GRepFormName = 38
    Case UCase(Replace("Sale Tax Summary", " ", ""))
        ReportForm.GRepFormName = 41
        
End Select
With ReportForm
    .CAPTION = MnSalesRep(Index).CAPTION
    .LblTitle = MnSalesRep(Index).CAPTION
    .Show
End With
Set ReportForm = Nothing
    Exit Sub
errhand:
    MsgBox err.Description, vbInformation, "Information": Exit Sub
End Sub
Private Sub MnSprMIS_Click(Index As Integer)
On Error GoTo errhand
Dim rep As CrystalReport, Menucaption$, ReportForm As Form
PubUParam = Permission(Replace(MnSprMIS(Index).CAPTION, "&", ""))
On Error GoTo errhand
Menucaption = UCase(Replace(Replace(MnSprMIS(Index).CAPTION, "&", ""), " ", ""))
If Menucaption = UCase(Replace("Counter Rate Variation Report", " ", "")) Or _
    Menucaption = UCase(Replace("Purchase Rate Variation Report", " ", "")) Then
    Set ReportForm = New ReprtFormGlobal
Else
    Set ReportForm = New RepSprMIS
End If
Select Case Menucaption
    Case UCase(Replace("Counter Rate Variation Report", " ", ""))
        ReportForm.GRepFormName = 26    '34 ReprtFormGlobal
    Case UCase(Replace("Purchase Rate Variation Report", " ", ""))
        ReportForm.GRepFormName = 27    '35  ReprtFormGlobal
    Case UCase(Replace("ABC Analysis", " ", ""))
        ReportForm.GRepFormName = 1
    Case UCase(Replace("FSN Analysis", " ", ""))
        ReportForm.GRepFormName = 2
    Case UCase(Replace("XYZ Analysis", " ", ""))
        ReportForm.GRepFormName = 3
    Case UCase(Replace("Stock Ledger (FIFO)", " ", ""))
        ReportForm.GRepFormName = 4
    Case UCase(Replace("Stock Valuation (FIFO)", " ", ""))
        ReportForm.GRepFormName = 5
    Case UCase(Replace("Part-wise Profitibility", " ", ""))
        ReportForm.GRepFormName = 6
    Case UCase(Replace("Sales Vs Inventory", " ", ""))
        ReportForm.GRepFormName = 7
    Case UCase(Replace("Inventory Projection Report", " ", ""))
        ReportForm.GRepFormName = 8
End Select
With ReportForm
    .CAPTION = MnSprMIS(Index).CAPTION
'    .LblTitle = MnSprMIS(Index).Caption
    .Show
End With
Set ReportForm = Nothing
Set rep = Nothing
errhand: If err.NUMBER <> 0 Then CheckError
End Sub
Private Sub mnSprTaxForm_Click(Index As Integer)
Dim rep As CrystalReport
PubUParam = Permission(Replace(mnSprTaxForm(Index).CAPTION, "&", ""))
If PubUParam = "****" Then Exit Sub
Dim ReportForm As Form
On Error GoTo errhand
Set ReportForm = New RepFormTax
Select Case UCase(Replace(Replace(mnSprTaxForm(Index).CAPTION, "&", ""), " ", ""))
    Case UCase(Replace("Form Issue Against Spare Purchase", " ", ""))
        ReportForm.GRepFormName = 29
    Case UCase(Replace("Form Issue Against Spare Sale", " ", ""))
        ReportForm.GRepFormName = 30
    Case UCase(Replace("Form Issue Against Vehicle Purchase", " ", ""))
        ReportForm.GRepFormName = 31
    Case UCase(Replace("Form Received Against Vehicle Sale", " ", ""))
        ReportForm.GRepFormName = 32
    Case UCase(Replace("Road Permit Form Utilization Spare", " ", ""))
        ReportForm.GRepFormName = 33
    Case UCase(Replace("Road Permit Form Utilization Vehicle", " ", ""))
        ReportForm.GRepFormName = 34
    Case UCase(Replace("Form Reminder Spare", " ", ""))
        ReportForm.GRepFormName = 35
    Case UCase(Replace("Form Reminder Vehicle", " ", ""))
        ReportForm.GRepFormName = 36
End Select
With ReportForm
    .CAPTION = mnSprTaxForm(Index).CAPTION
    .LblTitle = mnSprTaxForm(Index).CAPTION
    .Show
End With
Set ReportForm = Nothing
    Exit Sub
errhand:
    MsgBox err.Description, vbInformation, "Information": Exit Sub
End Sub
Private Sub mnuExit_Click()
    frmDivision.Show
    frmDivision.CAPTION = PubPackage & "-Return Menu" '& RsComp!comp_name
    Unload MDIForm1
'    Set RsComp = New Recordset
'    If UCase(pubUName) = "SA" Then
'        RsComp.Open "Select * from company", G_CompCn, adOpenDynamic, adLockOptimistic
'    Else
'        RsComp.Open "Select * from company where comp_code in (select distinct comp_code from user1 where user_name='" & pubUName & "')", G_CompCn, adOpenDynamic, adLockOptimistic
'    End If
'    Set Grid.DataSource = RsComp
'    frm
'    Load frmLogin
'    frmLogin.Show
End Sub
Private Sub MnuLst1_Click(Index As Integer)
On Error GoTo errhand
Dim rep As CrystalReport, Form1 As frmMastList
PubUParam = Permission(MnuLst1(Index).CAPTION)
Select Case Index
    Case 0      'City Master List
        Set Form1 = New frmMastList
        With Form1
            .g_FormID = 1
            .LblName.CAPTION = MnuLst1(Index).CAPTION
            .CAPTION = MnuLst1(Index).CAPTION
            .Show
        End With
        Set Form1 = Nothing
    Case 1      'State Master List
        Set Form1 = New frmMastList
        With Form1
            .g_FormID = 0
            .LblName.CAPTION = MnuLst1(Index).CAPTION
            .CAPTION = MnuLst1(Index).CAPTION
            .Show
        End With
        Set Form1 = Nothing
    Case 2      'Employee Master List
        Set Form1 = New frmMastList
        With Form1
            .g_FormID = 2
            .LblName.CAPTION = MnuLst1(Index).CAPTION
            .CAPTION = MnuLst1(Index).CAPTION
            .Show
        End With
        Set Form1 = Nothing
    Case 3      'contract/finance List
        Set Form1 = New frmMastList
        With Form1
            .g_FormID = 6
            .LblName.CAPTION = MnuLst1(Index).CAPTION
            .CAPTION = MnuLst1(Index).CAPTION
            .Show
        End With
        Set Form1 = Nothing
        
    Case 4      'discount factor List
        Set Form1 = New frmMastList
        With Form1
            .g_FormID = 7
            .LblName.CAPTION = MnuLst1(Index).CAPTION
            .CAPTION = MnuLst1(Index).CAPTION
            .Show
        End With
        Set Form1 = Nothing
    Case 5      'propietory part grade List
        Set Form1 = New frmMastList
        With Form1
            .g_FormID = 8
            .LblName.CAPTION = MnuLst1(Index).CAPTION
            .CAPTION = MnuLst1(Index).CAPTION
            .Show
        End With
        Set Form1 = Nothing
        
    Case 6     'godown List
        Set Form1 = New frmMastList
        With Form1
            .g_FormID = 9
            .LblName.CAPTION = MnuLst1(Index).CAPTION
            .CAPTION = MnuLst1(Index).CAPTION
            .Show
        End With
        Set Form1 = Nothing
    Case 7      'unit List
        Set Form1 = New frmMastList
        With Form1
            .g_FormID = 10
            .LblName.CAPTION = MnuLst1(Index).CAPTION
            .CAPTION = MnuLst1(Index).CAPTION
            .Show
        End With
        Set Form1 = Nothing
    Case 8      'Aggregate List
        Set Form1 = New frmMastList
        With Form1
            .g_FormID = 5
            .LblName.CAPTION = MnuLst1(Index).CAPTION
            .CAPTION = MnuLst1(Index).CAPTION
            .Show
        End With
        Set Form1 = Nothing
        
    Case 9      'part List
        Set Form1 = New frmMastList
        With Form1
            .g_FormID = 11
            .LblName.CAPTION = MnuLst1(Index).CAPTION
            .CAPTION = MnuLst1(Index).CAPTION
            .Show
        End With
        Set Form1 = Nothing
    Case 10      'Vehicle model category List
        Set Form1 = New frmMastList
        With Form1
            .g_FormID = 3
            .LblName.CAPTION = MnuLst1(Index).CAPTION
            .CAPTION = MnuLst1(Index).CAPTION
            .Show
        End With
        Set Form1 = Nothing
    Case 11     'vehicle model group List
        Set Form1 = New frmMastList
        With Form1
            .g_FormID = 4
            .LblName.CAPTION = MnuLst1(Index).CAPTION
            .CAPTION = MnuLst1(Index).CAPTION
            .Show
        End With
        Set Form1 = Nothing
        
    Case 12         ' vehicle model master
        Set Form1 = New frmMastList
        With Form1
            .g_FormID = 12
            .LblName.CAPTION = MnuLst1(Index).CAPTION
            .CAPTION = MnuLst1(Index).CAPTION
            .Show
        End With
        Set Form1 = Nothing
    Case 13 'dealer master
        Set Form1 = New frmMastList
        With Form1
            .g_FormID = 13
            .LblName.CAPTION = MnuLst1(Index).CAPTION
            .CAPTION = MnuLst1(Index).CAPTION
            .Show
        End With
        Set Form1 = Nothing
    Case 14 'colour register
        Set Form1 = New frmMastList
        With Form1
            .g_FormID = 14
            .LblName.CAPTION = MnuLst1(Index).CAPTION
            .CAPTION = MnuLst1(Index).CAPTION
            .Show
        End With
        Set Form1 = Nothing
    Case 15     'labour description master
        Set Form1 = New frmMastList
        With Form1
            .g_FormID = 19
            .LblName.CAPTION = MnuLst1(Index).CAPTION
            .CAPTION = MnuLst1(Index).CAPTION
            .Show
        End With
        Set Form1 = Nothing
        
    Case 16     ' model-wise labour detail master
        Set Form1 = New frmMastList
        With Form1
            .g_FormID = 20
            .LblName.CAPTION = MnuLst1(Index).CAPTION
            .CAPTION = MnuLst1(Index).CAPTION
            .Show
        End With
        Set Form1 = Nothing
End Select
Exit Sub

errhand:
    CheckError
End Sub
Private Sub Mas_Click(Index As Integer)
PubUParam = Permission(Replace(Mas(Index).CAPTION, "&", ""))
If PubUParam = "****" Then Exit Sub
Select Case Index
    Case 1      'City Master
        If frmCity.Visible = False Then frmCity.Show: Set frmCity = Nothing
    Case 3     'Color Master
        If frmColor.Visible = False Then frmColor.Show: Set frmColor = Nothing
    Case 4      'Contract/OEM
        If frmContract.Visible = False Then frmContract.Show:  Set frmContract = Nothing
    Case 5     'Employee Master
        If frmEmpMast.Visible = False Then frmEmpMast.Show: Set frmEmpMast = Nothing
    Case 6      'Godown Master
        If frmGodown.Visible = False Then frmGodown.Show: Set frmGodown = Nothing
    Case 7      'Vehicle Model Category Master
        If frmModelCat.Visible = False Then frmModelCat.Show: Set frmModelCat = Nothing
    Case 8      'Vehicle Model Group Master
        If frmModelGrp.Visible = False Then frmModelGrp.Show: Set frmModelGrp = Nothing
    Case 9     'Model Check List
        If frmModelInspEle.Visible = False Then frmModelInspEle.Show: Set frmModelInspEle = Nothing
    Case 10      'Vehicle Model Master
        If frmModel.Visible = False Then frmModel.Show: Set frmModel = Nothing
    Case 11     'Dealer Master
        If frmDealer.Visible = False Then frmDealer.Show: Set frmDealer = Nothing
    Case 12      'Area Master
        If frmArea.Visible = False Then frmArea.Show: Set frmArea = Nothing
    Case 13      'Site Master
        If FrmSite.Visible = False Then FrmSite.Show: Set FrmSite = Nothing
    Case 15      'Tax Forms**
        If frmTaxForms.Visible = False Then frmTaxForms.Show: Set frmTaxForms = Nothing
    Case 16      'Tax Forms Receipt / Issue**
        If frmTaxFrmIssRec.Visible = False Then frmTaxFrmIssRec.Show: Set frmTaxFrmIssRec = Nothing
End Select
End Sub
Private Sub MDIForm_Load()
On Error GoTo ELoop
Dim VitKDate As Date
frmDivision.ProgressBar1.Value = 55
Set rdApp = CreateObject("CrystalRunTime.Application")
If (pubUName = "SA" Or pubUName = "ADMIN") Then
    utlty.Visible = True
Else
    utlty.Visible = False
End If
If UCase(left(PubComp_Name, 7)) = "JOHNSON" Then
    FAREPORT(36).Visible = True
Else
    FAREPORT(36).Visible = False
End If

SBAR.Panels(2).TEXT = PubSecName
SBAR.Panels(3).TEXT = Format(PubStartDate, "yyyy") & "-" & Format(PubEndDate, "yyyy")
SBAR.Panels(4).TEXT = "User : " & pubUName
SBAR.Panels(5).TEXT = PubLoginDate
GSQL = "select Site_Desc + '[' + SiteType + ']' from Site where Site_Code='" & PubSiteCode & "'"
If GCn.Execute(GSQL).RecordCount > 0 Then
    SBAR.Panels(8).TEXT = GCn.Execute(GSQL).Fields(0).Value
Else
    MsgBox "Define Site in System Controls through Utility Menu", vbCritical, "Urgent"
End If
'Vit K
'VitKDate = CDate("14/11/2003")
'Set GRs = New ADODB.Recordset
'GRs.CursorLocation = adUseClient
'GRs.Open "Select max(Sal_VDate) as VDate from Veh_Stock", GCn, adOpenDynamic, adLockOptimistic
'If GRs.RecordCount  > 0 Then
'    If Not IsNull(GRs!Vdate) Then
'        If GRs!Vdate  > Format(VitKDate, "dd/MMM/yyyy") Then
'            End
'        End If
'    End If
'End If
'Set GRs = New ADODB.Recordset
'GRs.CursorLocation = adUseClient
'GRs.Open "Select max(V_Date) as VDate from Ledger", G_FACN, adOpenDynamic, adLockOptimistic
'If GRs.RecordCount  > 0 Then
'    If Not IsNull(GRs!Vdate) Then
'        If GRs!Vdate  > Format(VitKDate, "dd/MMM/yyyy") Then
'            End
'        End If
'    End If
'End If
'Set GRs = Nothing
'EOF

'GSQL = "Select count(*) from SP_Stock"
'If GCn.Execute(GSQL).Fields(0).Value  > 250 Then
'    MsgBox "License Expired", vbCritical, "License Checking"
'    End
'End If
'
'GSQL = "Select count(*) from Ledger"
'If G_FACN.Execute(GSQL).Fields(0).Value  > 250 Then
'    MsgBox "License Expired", vbCritical, "License Checking"
'    End
'End If

'Allow Module Menu
ModuleMenu
'23-09-2002
'Specially declared for Speed purpose, extra fields deleted
frmDivision.ProgressBar1.Value = 65
If PubSCompCode <> "" Or PubWCompCode <> "" Then
    Set RsPart = New ADODB.Recordset
    RsPart.CursorLocation = adUseClient
    
    If PubBackEnd = "A" Then
        RsPart.Open "Select P.Part_No AS Code," & xIsNull("P.Part_Name", "") & " as Name, " & xIsNull("P.Local_Name", "") & " AS LName, " & xIsNull("P.Unit", "") & " as Unit," _
        & "format(P.MRP,'0.00') as MRP,format(P.TB_SRate,'0.00') as TB_SRate,format(P.TP_SRate,'0.00') as TP_SRate,P.Bin_Loca,DF.PurcDisc_Per,p.ReOrd_Lvl,P.Cur_MRP_TBStk,P.Cur_MRP_TPStk,P.Cur_TB_Stk,p.Cur_TP_Stk,format(P.Cur_MRP_TBStk+P.Cur_MRP_TPStk+P.Cur_TB_Stk+p.Cur_TP_Stk,'0.00') as CurrStk,P.Min_Lvl,p.Disc_Factor " _
        & "From Part P left join Part_DiscFactor DF on P.Disc_Factor=DF.DiscFac_Catg  Where P.Div_Code='" & PubDivCode & "' " _
        & "Order By P.Part_No,P.Part_Name,P.Local_Name", GCn, adOpenDynamic, adLockOptimistic
    ElseIf PubBackEnd = "S" Then
        Set RsPart = GCn.Execute("Select * From GlobalPart")
    End If


    
    
    'Order By P.Part_No,P.Part_Name,P.Local_Name
'    RsPart.Filter = ("Div_Code='" & PubDivCode & "'")
    frmDivision.ProgressBar1.Value = 75
'    RsPart.Sort = "Name"
    frmDivision.ProgressBar1.Value = 80
'    RsPart.Sort = "LName"
    frmDivision.ProgressBar1.Value = 85
'    RsPart.Sort = "Code"
    
  frmDivision.ProgressBar1.Value = 90
  If PubVATYN = 1 Then
      MnSalesRep(11).Visible = False
      MnSalesRep(13).Visible = True
      MnSalesRep(14).Visible = True
  Else
      MnSalesRep(11).Visible = True
      MnSalesRep(13).Visible = False
      MnSalesRep(14).Visible = False
  End If
  If RSOJPR = True Then
    tlcorep(19).Visible = True
  Else
    tlcorep(19).Visible = False
  End If
    
    
'    If PubLoginDate <= CDate("03/APR/2007") Then
'        GCn.Execute "Delete From Job_Lab Where Job_DocId Not In (Select DocId From Job_Card)"
'        GCn.Execute "Delete From Job_Lab2 Where Job_DocId Not In (Select DocId From Job_Card)"
'    End If
    
    
End If

Exit Sub
ELoop:   CheckError
End Sub
Private Sub MDIForm_Unload(Cancel As Integer)
    Set GRs = Nothing
    PubVFADataPath = ""
    Set GCnFaV = Nothing
    PubSFADataPath = ""
    Set GCnFaS = Nothing
    PubWFADataPath = ""
    Set GCnFaW = Nothing
    Set NewObj = Nothing
    Set RsPart = Nothing
    End
End Sub

Private Sub mnutstfrm_Click()
    'FrmCustConern.Show
End Sub

Private Sub mnuWindowCascade_Click()
    Me.Arrange vbCascade
End Sub

Private Sub mnuWindowTileHorizontal_Click()
    Me.Arrange vbTileHorizontal
End Sub
Private Sub mnuWindowTileVertical_Click()
    Me.Arrange vbTileVertical
End Sub
Private Sub MnVehReports_Click(Index As Integer)
Dim rep As CrystalReport
PubUParam = Permission(Replace(MnVehReports(Index).CAPTION, "&", ""))
Dim ReportForm As Form
On Error GoTo errhand

If Index = 0 Then
    Set ReportForm = New ReprtFormGlobal
ElseIf Index = 20 Or Index = 24 Or Index = 27 Then
    Set ReportForm = New ReportVehicle2
Else
    Set ReportForm = New ReportVehicle
End If
Select Case UCase(Replace(Replace(MnVehReports(Index).CAPTION, "&", ""), " ", ""))
    Case UCase(Replace("Money Receipt Register", " ", ""))
        ReportForm.GRepFormName = 13
    Case UCase(Replace("Chassis Received Register", " ", ""))
        ReportForm.GRepFormName = 1
    Case UCase(Replace("Purchase Register", " ", ""))
        ReportForm.GRepFormName = 2
    Case UCase(Replace("Purchase Register (Summary)", " ", ""))
        ReportForm.GRepFormName = 16
    Case UCase(Replace("Sale Register (Summary)", " ", ""))
        ReportForm.GRepFormName = 17
    Case UCase(Replace("Vehicle In Transit Report", " ", ""))
        ReportForm.GRepFormName = 3
    Case UCase(Replace("Vehicle Booking Register", " ", ""))
        ReportForm.GRepFormName = 4
    Case UCase(Replace("Retail Sale Report", " ", ""))
        ReportForm.GRepFormName = 5
    Case UCase(Replace("Daily Sale Report (Own)", " ", ""))
        ReportForm.GRepFormName = 6 '10
    Case UCase(Replace("Vehicle Sale Register", " ", ""))
        ReportForm.GRepFormName = 7 '6
    Case UCase(Replace("Delivery Challan Register", " ", ""))
        ReportForm.GRepFormName = 8 '7
    Case UCase(Replace("Additional Fitment Register", " ", ""))
        ReportForm.GRepFormName = 9 '8
    Case UCase(Replace("Vehicle Stock Register", " ", ""))
        ReportForm.GRepFormName = 10 '9
    Case UCase(Replace("Vehicle Stock For Bank", " ", ""))
        ReportForm.GRepFormName = 11
    Case UCase(Replace("Vehicle Stock Holding Report", " ", ""))
        ReportForm.GRepFormName = 12
    Case UCase(Replace("Vehicle Summary (Model-wise)", " ", ""))
        ReportForm.GRepFormName = 13
    Case UCase(Replace("Vehicle Sale Purchase Report", " ", ""))
        ReportForm.GRepFormName = 14
    Case UCase(Replace("Target Collection Report", " ", ""))
        ReportForm.GRepFormName = 15
    Case UCase(Replace("Quotation Register", " ", ""))
        ReportForm.GRepFormName = 16
    Case UCase(Replace("Vehicle Sale Cancel Register", " ", ""))
        ReportForm.GRepFormName = 18
    Case UCase(Replace("Vehicle Sale Cancel Register", " ", ""))
        ReportForm.GRepFormName = 18
    Case UCase(Replace("Input Tax Register", " ", ""))
        ReportForm.GRepFormName = 2
    Case UCase(Replace("SalesMan wise Pending Amount", " ", ""))
        ReportForm.GRepFormName = 19
    Case UCase(Replace("Outstanding Payment Report", " ", ""))
        ReportForm.GRepFormName = 20
    Case UCase(Replace("Output Tax Register", " ", ""))
        ReportForm.GRepFormName = 3
    Case UCase(Replace("Vehicle Transfer Register", " ", ""))
        ReportForm.GRepFormName = 23
    Case UCase(Replace("Vehicle Follow Up", " ", ""))
        ReportForm.GRepFormName = 25
    Case UCase(Replace("Income Tax Register", " ", ""))
        ReportForm.GRepFormName = 26
    Case UCase(Replace("VAT Difference Register", " ", ""))
        ReportForm.GRepFormName = 4
        
End Select
With ReportForm
    .CAPTION = MnVehReports(Index).CAPTION
    .LblTitle = MnVehReports(Index).CAPTION
    .Show
End With
Set ReportForm = Nothing
    Exit Sub
errhand:
    MsgBox err.Description, vbInformation, "Information": Exit Sub
End Sub

Private Sub MnVehReports1_Click(Index As Integer)
Dim rep As CrystalReport
PubUParam = Permission(Replace(MnVehReports1(Index).CAPTION, "&", ""))
Dim ReportForm As Form
On Error GoTo errhand
Set ReportForm = New ReportVehicle1
Select Case UCase(Replace(Replace(MnVehReports1(Index).CAPTION, "&", ""), " ", ""))
    Case UCase(Replace("Model/Branch-wise Report", " ", ""))
        ReportForm.GRepFormName = 1
    Case UCase(Replace("Model/Branch-wise Sale Delivery", " ", ""))
        ReportForm.GRepFormName = 2
    Case UCase(Replace("Monthly Target/Sale Qty Difference", " ", ""))
        ReportForm.GRepFormName = 3
    Case UCase(Replace("Model/Financier-wise Sale Report", " ", ""))
        ReportForm.GRepFormName = 4
    Case UCase(Replace("Model-wise/Group-wise Monthly", " ", ""))
        ReportForm.GRepFormName = 5
    Case UCase(Replace("Area-wise/Model-wise Yearly", " ", ""))
        ReportForm.GRepFormName = 6
    Case UCase(Replace("Financier/Model-wise Monthly", " ", ""))
        ReportForm.GRepFormName = 7
    Case UCase(Replace("Model/Financier-wise Micro", " ", ""))
'        MsgBox "Available in Licence Version", vbInformation, "Validation"
'        Set ReportForm = Nothing
'        Exit Sub
        ReportForm.GRepFormName = 8
    Case UCase(Replace("Model-wise Customer List", " ", ""))
        ReportForm.GRepFormName = 9
    Case UCase(Replace("Sales/Purchase Price Difference", " ", ""))
        ReportForm.GRepFormName = 10
    Case UCase(Replace("Delay Delivery Interest Report", " ", ""))
        ReportForm.GRepFormName = 11
    Case UCase(Replace("Area-wise Financier-wise Sale", " ", ""))
        ReportForm.GRepFormName = 12
    Case UCase(Replace("E-Mail (Retail Sales)", " ", ""))
        ReportForm.GRepFormName = 13
    Case UCase(Replace("Vehicle Sale Summary(Form-wise)", " ", ""))
        ReportForm.GRepFormName = 14
    Case UCase(Replace("Vehicle Purchase/Sale Audit", " ", ""))
        ReportForm.GRepFormName = 15
    Case UCase(Replace("Month Summary", " ", ""))
        ReportForm.GRepFormName = 16
    Case UCase(Replace("Vehicle Profitability Report", " ", ""))
        frmVehProfit.Show
        Exit Sub
End Select
With ReportForm
    .CAPTION = MnVehReports1(Index).CAPTION
    .LblTitle = MnVehReports1(Index).CAPTION
    .Show
End With
Set ReportForm = Nothing
Exit Sub
errhand:
    MsgBox err.Description, vbInformation, "Information": Exit Sub

End Sub

Private Sub SBAR_PanelClick(ByVal Panel As MSComctlLib.Panel)
If Panel.Index = 7 Then
    If FormChk("Find Part") = False Then FrmFindPart.Show: Set FrmFindPart = Nothing
ElseIf Panel.Index = 4 Then
    If FrmUserPass.Visible = False Then FrmUserPass.Show: Set FrmUserPass = Nothing
End If
End Sub

Private Sub SprMas_Click(Index As Integer)
PubUParam = Permission(Replace(SprMas(Index).CAPTION, "&", ""))
If PubUParam = "****" Then Exit Sub
Select Case Index
    Case 1      'Aggregate Master
        If frmAggregate.Visible = False Then frmAggregate.Show: Set frmAggregate = Nothing
    Case 2      'Discount Factor Master
        If frmPartDiscFact.Visible = False Then frmPartDiscFact.Show: Set frmPartDiscFact = Nothing
    Case 3      'Proprietary Part Grade Master
        If frmPartGrade.Visible = False Then frmPartGrade.Show: Set frmPartGrade = Nothing
    Case 4      'Part Master
        
        If frmPartMast.Visible = False Then frmPartMast.Show: Set frmPartMast = Nothing
    Case 5      'Spare Price List
        If frmSprPriceList.Visible = False Then frmSprPriceList.Show: Set frmSprPriceList = Nothing
    Case 6      'Price List Updation
        If FrmPriceUpdate.Visible = False Then FrmPriceUpdate.Show: Set FrmPriceUpdate = Nothing
    Case 7      'Spare Sale Target
        If frmSprSaleTarget.Visible = False Then frmSprSaleTarget.Show: Set frmSprSaleTarget = Nothing
    Case 8      'Spare Physical Stock Entry
        If frmPhysicalStk.Visible = False Then frmPhysicalStk.Show: Set frmPhysicalStk = Nothing
End Select
End Sub

Private Sub SprPurTrn_Click(Index As Integer)
PubUParam = Permission(Replace(SprPurTrn(Index).CAPTION, "&", ""))
If PubUParam = "****" Then Exit Sub
Select Case Index
    Case 1
        If frmPurOrd.Visible = False Then frmPurOrd.Show: Set frmPurOrd = Nothing
    Case 2
      
        If frmPurChl.Visible = False Then frmPurChl.Show: Set frmPurChl = Nothing
    Case 3
        If frmPurBill.Visible = False Then frmPurBill.Show: Set frmPurBill = Nothing
    Case 4
        If frmPurRet.Visible = False Then frmPurRet.Show: Set frmPurRet = Nothing
        'Menu Separator
End Select
End Sub

Private Sub SprSalTrn_Click(Index As Integer)
PubUParam = Permission(Replace(SprSalTrn(Index).CAPTION, "&", ""))
If PubUParam = "****" Then Exit Sub
Select Case Index
    Case 1
       
        If frmEstimateQuot.Visible = False Then
            frmEstimateQuot.PubEstimateType = "Spare"
            frmEstimateQuot.Show
            Set frmEstimateQuot = Nothing
        End If
    Case 2
        If frmSOrd.Visible = False Then frmSOrd.Show: Set frmSOrd = Nothing
    Case 3
        If frmSaleChal.Visible = False Then frmSaleChal.Show: Set frmSaleChal = Nothing
    Case 4
        If RSOJPR = True And pubUName <> "ADMIN" Then
            PubUParam = "A**P"
        End If
        If frmSaleBill.Visible = False Then frmSaleBill.Show: Set frmSaleBill = Nothing
    Case 5
        If RSOJPR = True And pubUName <> "ADMIN" Then
            PubUParam = "A**P"
        End If
        If frmSaleRet.Visible = False Then frmSaleRet.Show: Set frmSaleRet = Nothing
    Case 6
       
        If FormChk(SprSalTrn(Index).CAPTION) = True Then Exit Sub
        Dim Form1 As frmRequisition
        Set Form1 = New frmRequisition
        With Form1
            .PubRequisitionType = "Store"
            .CAPTION = SprSalTrn(Index).CAPTION
            .Show
        End With
        Set Form1 = Nothing
    Case 7
        
        If FormChk(SprSalTrn(Index).CAPTION) = True Then Exit Sub
        Dim Form2 As frmRequisition
        Set Form2 = New frmRequisition
        With Form2
            .PubRequisitionType = "Return"
            .CAPTION = SprSalTrn(Index).CAPTION
            .Show
        End With
        Set Form2 = Nothing
    Case 8
        If RSOJPR = True And pubUName <> "ADMIN" Then
            PubUParam = "A**P"
        End If
        If frmStkIssRec.Visible = False Then frmStkIssRec.Show: Set frmStkIssRec = Nothing
    Case 9
'        If frmCustRect.Visible = False Then frmCustRect.Show: Set frmCustRect = Nothing
        
        If frmCustRect.Visible = False Then
            frmCustRect.PubReceiptType = "Spare"
            frmCustRect.Show
            Set frmCustRect = Nothing
        End If
End Select
End Sub

Private Sub SprStkRep_Click(Index As Integer)
Dim rep As CrystalReport, Menucaption$, ReportForm As Form, mQRY$, RepTitle$
Dim RepPrint As Boolean
On Error GoTo errhand
Dim RstRep As ADODB.Recordset

PubUParam = Permission(Replace(SprStkRep(Index).CAPTION, "&", ""))
Menucaption = UCase(Replace(Replace(SprStkRep(Index).CAPTION, "&", ""), " ", ""))

If Index = 9 Then   'Stock Verification Sheet
    mQRY = "Select Part_name,part_no,bin_loca" & _
           " FROM Part where div_code ='" & PubDivCode & "' order by Bin_Loca,Part_no"
  
    Set RstRep = New Recordset
    RstRep.CursorLocation = adUseClient
    RstRep.Open (mQRY), GCn, adOpenDynamic, adLockOptimistic
    
    RepTitle = UCase("Stock Verification Sheet")
    
    CreateFieldDefFile RstRep, PubRepoPath & "\SprStkVerify.ttx", True
    Set rpt = rdApp.OpenReport(PubRepoPath & "\SprStkVerify.RPT")

    rpt.Database.SetDataSource RstRep
    rpt.ReadRecords

    Call Report_View(rpt, RepTitle, , False)
Else
    Set ReportForm = New ReprtFormGlobal
    Select Case Menucaption
        Case UCase(Replace("Stock Ledger", " ", ""))
            ReportForm.GRepFormName = 10
        Case UCase(Replace("Stock Summary", " ", ""))
            ReportForm.GRepFormName = 11
        Case UCase(Replace("Stock In Hand", " ", ""))
            ReportForm.GRepFormName = 12
        Case UCase(Replace("Indent Register", " ", ""))
            ReportForm.GRepFormName = 15 '22
        Case UCase(Replace("Stock Above/Below/ReOrder Lavel", " ", ""))
            ReportForm.GRepFormName = 22 '30
        Case UCase(Replace("Bin-wise Spare Stock", " ", ""))
            ReportForm.GRepFormName = 23 '31
        Case UCase(Replace("Part Movement Register", " ", ""))
            ReportForm.GRepFormName = 24 '32
        Case UCase(Replace("Part Ageing Analysis", " ", ""))
            ReportForm.GRepFormName = 25 '33
    End Select
    With ReportForm
        .CAPTION = SprStkRep(Index).CAPTION
        .LblTitle = SprStkRep(Index).CAPTION
        .Show
    End With
End If
errhand:
    If err.NUMBER <> 0 Then CheckError
Set RstRep = Nothing
Set rpt = Nothing
Set ReportForm = Nothing
End Sub



'Private Sub TelRep_Click(Index As Integer)
'
'PubUParam = Permission(Replace(TelRep(Index).CAPTION, "&", ""))
'Dim rep As CrystalReport, Menucaption$
'Menucaption = UCase(Replace(Replace(TelRep(Index).CAPTION, "&", ""), " ", ""))
'
'If Menucaption = UCase(Replace("Daily Sale Report", " ", "")) Or _
'    Menucaption = UCase(Replace("Financer Certificate", " ", "")) Then
'    Dim ReportForm As Form
'End If
'
'If Menucaption = UCase(Replace("Daily Sale Report", " ", "")) Then
'    Set ReportForm = New ReportVehicle
'ElseIf Menucaption = UCase(Replace("Financer Certificate", " ", "")) Then
'    Set ReportForm = New ReportVehicle2
'End If
'
'On Error GoTo errhand
'Select Case Menucaption
'    Case UCase(Replace("Offtake Incentive Claim Letter", " ", ""))
'        If RepIncClaim.Visible = False Then RepIncClaim.Show: Set RepIncClaim = Nothing
'    Case UCase(Replace("Subvention Letter", " ", ""))
'        If RepSubvention.Visible = False Then RepSubvention.Show: Set RepSubvention = Nothing
'    Case UCase(Replace("Financer Certificate", " ", ""))
'        ReportForm.GRepFormName = 1
'    Case UCase(Replace("Daily Sale Report", " ", ""))
'        ReportForm.GRepFormName = 17
'End Select
'
'If Menucaption = UCase(Replace("Financer Certificate", " ", "")) Or _
'    Menucaption = UCase(Replace("Daily Sale Report", " ", "")) Then
'    With ReportForm
'        .CAPTION = TelRep(Index).CAPTION
'        .LblTitle = TelRep(Index).CAPTION
'        .Show
'    End With
'    Set ReportForm = Nothing
'End If
'Exit Sub
'errhand:
'    MsgBox err.Description, vbInformation, "Information": Exit Sub
'
'End Sub

Private Sub TelRep_Click(Index As Integer)

PubUParam = Permission(Replace(TelRep(Index).CAPTION, "&", ""))
Dim rep As CrystalReport, Menucaption$
Menucaption = UCase(Replace(Replace(TelRep(Index).CAPTION, "&", ""), " ", ""))

If Menucaption = UCase(Replace("Daily Sale Report", " ", "")) Or _
    Menucaption = UCase(Replace("Financer Certificate", " ", "")) Or _
    Menucaption = UCase(Replace("Subvention Claim Register", " ", "")) Then
    Dim ReportForm As Form
End If

If Menucaption = UCase(Replace("Daily Sale Report", " ", "")) Or _
    Menucaption = UCase(Replace("Subvention Claim Register", " ", "")) Then
        Set ReportForm = New ReportVehicle
ElseIf Menucaption = UCase(Replace("Financer Certificate", " ", "")) Then
    Set ReportForm = New ReportVehicle2
End If

On Error GoTo errhand
Select Case Menucaption
    Case UCase(Replace("Offtake Incentive Claim Letter", " ", ""))
        If RepIncClaim.Visible = False Then RepIncClaim.Show: Set RepIncClaim = Nothing
    Case UCase(Replace("Subvention Letter", " ", ""))
        If RepSubvention.Visible = False Then RepSubvention.Show: Set RepSubvention = Nothing
    Case UCase(Replace("Financer Certificate", " ", ""))
        ReportForm.GRepFormName = 1
    Case UCase(Replace("Daily Sale Report", " ", ""))
        ReportForm.GRepFormName = 17
    Case UCase(Replace("Subvention Claim Register", " ", ""))
        ReportForm.GRepFormName = 27
End Select

If Menucaption = UCase(Replace("Financer Certificate", " ", "")) Or _
    Menucaption = UCase(Replace("Daily Sale Report", " ", "")) Or _
    Menucaption = UCase(Replace("Subvention Claim Register", " ", "")) Then
    With ReportForm
        .CAPTION = TelRep(Index).CAPTION
        .LblTitle = TelRep(Index).CAPTION
        .Show
    End With
    Set ReportForm = Nothing
End If
Exit Sub
errhand:
    MsgBox err.Description, vbInformation, "Information": Exit Sub

End Sub

Private Sub tlcorep_Click(Index As Integer)
Dim rep As CrystalReport
PubUParam = Permission(Replace(tlcorep(Index).CAPTION, "&", ""))
Dim ReportForm As Form
On Error GoTo errhand
Select Case UCase(Replace(Replace(tlcorep(Index).CAPTION, "&", ""), " ", ""))
    Case UCase(Replace("Repeat Job Analysis Form", " ", ""))
        PubUParam = Permission(Replace(WrkTrn(Index).CAPTION, "&", ""))
        If frmRepeteJob.Visible = False Then frmRepeteJob.Show
       Exit Sub
    Case UCase(Replace("Customer Feedback Entry", " ", ""))
        PubUParam = Permission(Replace(tlcorep(Index).CAPTION, "&", ""))
        If frmFeedback.Visible = False Then frmFeedback.Show
       Exit Sub
End Select
Set ReportForm = New ReportTelco
Select Case UCase(Replace(Replace(tlcorep(Index).CAPTION, "&", ""), " ", ""))
    Case UCase(Replace("Workshop Performence Report", " ", ""))
        ReportForm.GRepFormName = 1
    Case UCase(Replace("Promise Time Deviation Report", " ", ""))
        ReportForm.GRepFormName = 2
    Case UCase(Replace("Estimated Cost Deviation", " ", ""))
        ReportForm.GRepFormName = 3
    Case UCase(Replace("ModelWise Complaint Analysis", " ", ""))
        ReportForm.GRepFormName = 4
    Case UCase(Replace("Aggregate Complaint Analysis", " ", ""))
        ReportForm.GRepFormName = 5
    Case UCase(Replace("Repaire Order Analysis", " ", ""))
        ReportForm.GRepFormName = 6
    Case UCase(Replace("ModelWise Repeat Complaint Analysis", " ", ""))
        ReportForm.GRepFormName = 7
    Case UCase(Replace("Summery of Repeat Complaint", " ", ""))
        ReportForm.GRepFormName = 10
    Case UCase(Replace("Repeat Job Analysis", " ", ""))
        ReportForm.GRepFormName = 11
    Case UCase(Replace("Service Wise Job Analysis", " ", ""))
        ReportForm.GRepFormName = 12
    Case UCase(Replace("Service Analysis Details", " ", ""))
        ReportForm.GRepFormName = 13
    Case UCase(Replace("Quantitative Complaint Analysis", " ", ""))
        ReportForm.GRepFormName = 14
    Case UCase(Replace("Daily Follow UP Calls By CRO", " ", ""))
        ReportForm.GRepFormName = 16
    Case UCase(Replace("Dissatisfied Customers", " ", ""))
        ReportForm.GRepFormName = 17
    Case UCase(Replace("Customer Satisfaction Report", " ", ""))
        ReportForm.GRepFormName = 18
    Case UCase(Replace("Workshop Profit Report", " ", ""))
        ReportForm.GRepFormName = 19
End Select
With ReportForm
    .CAPTION = tlcorep(Index).CAPTION
    .LblTitle = tlcorep(Index).CAPTION
    .Show
End With
Set ReportForm = Nothing
Exit Sub
errhand:
    MsgBox err.Description, vbInformation, "Information": Exit Sub


End Sub

Private Sub utl_Click(Index As Integer)
Dim oZip As CGZipFiles, ZipDrive As String, ZipFile$
Dim oUnZip As CGUnzipFiles
Dim DB1 As DAO.Database

ZipFile = Trim("Auto_" & PubCenCompCode & "-" & Format(Now(), "dd") & Format(Now(), "mm") & Format(Now(), "yy"))
'On Error GoTo errhand
    PubUParam = Permission(Replace(Utl(Index).CAPTION, "&", ""))
    If PubUParam = "****" Then Exit Sub
    Select Case Index
        Case 1
            If frmUser.Visible = False Then frmUser.Show: Set frmUser = Nothing
        Case 3
            If frmSyCtrl.Visible = False Then frmSyCtrl.Show: Set frmSyCtrl = Nothing
        Case 4
            If frmSyCtrlVeh.Visible = False Then frmSyCtrlVeh.Show: Set frmSyCtrlVeh = Nothing
        Case 5
            If frmSyCtrlSpr.Visible = False Then frmSyCtrlSpr.Show: Set frmSyCtrlSpr = Nothing
        Case 6
            If frmSyCtrlSrv.Visible = False Then frmSyCtrlSrv.Show: Set frmSyCtrlSrv = Nothing
        Case 7
            If frmVouPrefix.Visible = False Then frmVouPrefix.Show: Set frmVouPrefix = Nothing
        Case 13
            Call DataBackup
        Case 14 'Database Restore
            '****
            'Dim DB1 As DAO.Database
            'Checking for Exclusive mode
            If GCn.State <> 0 Then GCn.Close
            Set DB1 = OpenDatabase(Pub_DataPath & "\Auto_" & PubCenCompCode & "\Automan.mdb", True, False, ";pwd=dtman")
            Set DB1 = Nothing
            GCn.Open
            '****
            Set oUnZip = New CGUnzipFiles
            With oUnZip
                ' What Zip File ?
                .ZipFileName = PubBkpPath & "\" & ZipFile & ".ZIP"
                ' Where are we zipping to ?
'                .ExtractDir = Pub_DataPath & "\Auto_" & PubCenCompCode & "\"
                .ExtractDir = mID(Pub_DataPath, 1, 3)
                ' Keep Directory Structure of Zip ? changed to true
                .HonorDirectories = True
                ' Unzip and Display any errors as required
                'All Active Connection Closed
    '            Set GCn = Nothing
                CloseAllConn
                If .Unzip <> 0 Then
                    MsgBox .GetLastMessage
                    Exit Sub
                Else
                    MsgBox PubBkpPath & "\" & ZipFile & ".ZIP Extracted Successfully to " & Pub_DataPath & "\Auto_" & PubCenCompCode & "\"
                End If
            End With
            OpenAllConn
            Set oUnZip = Nothing
            'After Successfully Completed
            'Please Re Open Your All Connection
        Case 15 'Database Compact
            CompactDatabase
        Case 16
            AddNewFieldFAData
'        Case 17
'            UpdateNarrationProc
        Case 19
            Call DelAllTransactions
        Case 21
            Set NewObj = New FaEnvron
            NewObj.Show
        Case 22
            If pubUName = "SA" Then
                PubUParam = "AE*P"
            End If
            Set NewObj = New FaVtype
            NewObj.Show
        Case 23
            Set NewObj = New YearEnd
            NewObj.Show
        Case 24
            Call UpdateBalance
        Case 25
            Call Update_VRate
        Case 26
            If PubBackEnd = "A" Then Call DataBackup
            frmAcMerze.Show
        Case 27
            On Error GoTo errhand
            Dim rep As CrystalReport, ReportForm As Form
            On Error GoTo errhand
            Set ReportForm = New RepSprMIS
            ReportForm.GRepFormName = 9
            ReportForm.CAPTION = "Delete Log"
            Set ReportForm = Nothing
            Set rep = Nothing
        Case 28
            If MsgBox("Sure to Update Voucher Prefix Counters", vbYesNo) = vbYes Then
                Call DataBackup
                SetMaxId_VoucherPrefix
            End If
    End Select
errhand:
    If GCn.State = 0 Then GCn.Open
End Sub
Private Sub VehMas_Click(Index As Integer)
PubUParam = Permission(Replace(VehMas(Index).CAPTION, "&", ""))
If PubUParam = "****" Then Exit Sub
Select Case Index
    Case 1      'Rep-wise/Model-wise Target
        If frmRepModelTgt.Visible = False Then frmRepModelTgt.Show: Set frmRepModelTgt = Nothing
    Case 2     'Financier Master
        If frmFinMast.Visible = False Then frmFinMast.Show: Set frmFinMast = Nothing
    Case 3     'Addition / Deletion
        If frmVehAMDMast.Visible = False Then frmVehAMDMast.Show: Set frmVehAMDMast = Nothing
End Select
End Sub

Private Sub VehMktRep_Click(Index As Integer)
Dim rep As CrystalReport, Menucaption$, ReportForm As Form ', RepTitle$
Dim RepPrint As Boolean
On Error GoTo errhand
Dim RstRep As ADODB.Recordset

PubUParam = Permission(Replace(VehMktRep(Index).CAPTION, "&", ""))
Menucaption = UCase(Replace(Replace(VehMktRep(Index).CAPTION, "&", ""), " ", ""))
If Menucaption = UCase(Replace("Statement of Prospective Demands (SPADE)", " ", "")) Then
    Set ReportForm = New RepSPADE
Else
    Set ReportForm = New RepMkt
End If
    Select Case Menucaption
        Case UCase(Replace("Daily Activity Report", " ", ""))
            ReportForm.GRepFormName = 1
        Case UCase(Replace("Appointments", " ", ""))
            ReportForm.GRepFormName = 2
        Case UCase(Replace("Call Status Report", " ", ""))
            ReportForm.GRepFormName = 3
        Case UCase(Replace("Case Analysis", " ", ""))
            ReportForm.GRepFormName = 4
        Case UCase(Replace("Daily Activity Missing Report", " ", ""))
            ReportForm.GRepFormName = 5
        Case UCase(Replace("Appointments Not Kept", " ", ""))
            ReportForm.GRepFormName = 6
        Case UCase(Replace("Executive-wise Got/Lost Report", " ", ""))
            ReportForm.GRepFormName = 7
        Case UCase(Replace("Pipeline Report (Daily)", " ", ""))
            ReportForm.GRepFormName = 10
        Case UCase(Replace("Profession/Purpose Analysis", " ", ""))
            ReportForm.GRepFormName = 11
        Case UCase(Replace("Daily Sales Report", " ", ""))
            ReportForm.GRepFormName = 12
        Case UCase(Replace("Sales Tracking Report", " ", ""))
            ReportForm.GRepFormName = 13
        Case UCase(Replace("Finance Tracking Report", " ", ""))
            ReportForm.GRepFormName = 14
        Case UCase(Replace("Statement of Prospective Demands (SPADE)", " ", ""))
            ReportForm.GRepFormName = 1
    End Select
    With ReportForm
        .CAPTION = VehMktRep(Index).CAPTION
        .LblTitle = VehMktRep(Index).CAPTION
        .Show
    End With
errhand:
    If err.NUMBER <> 0 Then CheckError
Set RstRep = Nothing
Set rpt = Nothing
Set ReportForm = Nothing

End Sub

Private Sub VehMktTrn_Click(Index As Integer)
PubUParam = Permission(Replace(VehMktTrn(Index).CAPTION, "&", ""))
If PubUParam = "****" Then Exit Sub
Select Case Index
    Case 0      'Prospective Customer Master
        If frmProCust.Visible = False Then frmProCust.Show: Set frmProCust = Nothing
    Case 1     'Sales Visit / Daily Activity Entry
        If frmVisit.Visible = False Then frmVisit.Show: Set frmVisit = Nothing
    Case 2
        If frmGotLost.Visible = False Then frmGotLost.Show: Set frmGotLost = Nothing
End Select

End Sub

Private Sub VehPurTrn_Click(Index As Integer)
Dim frm1 As frmVehPur
PubUParam = Permission(Replace(VehPurTrn(Index).CAPTION, "&", ""))
If PubUParam = "****" Then Exit Sub
Select Case Index
    Case 1     'Vehicle Receipts Entry
        If frmVehRect.Visible = False Then frmVehRect.Show: Set frmVehRect = Nothing
    Case 2     'Vehicle Purchase Entry
        If FormChk(VehPurTrn(Index).CAPTION) = True Then Exit Sub
        Set frm1 = New frmVehPur
        With frm1
            .mVType = "V_PB"
            .CAPTION = VehPurTrn(Index).CAPTION
            .Show
            .ZOrder 0
        End With
        Set frm1 = Nothing
    Case 3  'Opening Stock
        If FormChk(VehPurTrn(Index).CAPTION) = True Then Exit Sub
        Set frm1 = New frmVehPur
        With frm1
             .mVType = "V_OST"
             .CAPTION = VehPurTrn(Index).CAPTION
             .Show
             .ZOrder 0
         End With
         Set frm1 = Nothing
    Case 4     'Vehicle Check List
        If frmVehCheckSheet.Visible = False Then frmVehCheckSheet.Show: Set frmVehCheckSheet = Nothing
         
    Case 5  'BMS Opening
        If FormChk(VehPurTrn(Index).CAPTION) = True Then Exit Sub
        Set frm1 = New frmVehPur
        With frm1
             .mVType = "V_OBD"
             .CAPTION = VehPurTrn(Index).CAPTION
             .Show
             .ZOrder 0
         End With
         Set frm1 = Nothing
    Case 6
        If FrmVehStkTrn.Visible = False Then FrmVehStkTrn.Show: Set FrmVehStkTrn = Nothing
    Case 7     'Offtake Entry
        If frmOffTakeTgtForeCast.Visible = False Then frmOffTakeTgtForeCast.Show: Set frmOffTakeTgtForeCast = Nothing
    Case 8     'Allocation Entry
        If frmVehAlloc.Visible = False Then frmVehAlloc.Show:  Set frmVehAlloc = Nothing
    Case 9     'Rate List Entry
        If frmVehRate.Visible = False Then frmVehRate.Show:  Set frmVehRate = Nothing
    Case 10     'Rate List Entry
        If frmVehIssue.Visible = False Then frmVehIssue.Show:  Set frmVehIssue = Nothing
    Case 11
        ShowForm FrmSubventionMast
        
End Select
End Sub

Private Sub VehRep_Click(Index As Integer)
If Index = 1 Then 'SPADE
    PubUParam = Permission(Replace(VehRep(Index).CAPTION, "&", ""))
    Dim rep As CrystalReport, ReportForm As Form
    Set ReportForm = New RepSPADE
    Select Case UCase(Replace(Replace(VehRep(Index).CAPTION, "&", ""), " ", ""))
        Case UCase(Replace("Statement of Prospective Demands (SPADE)", " ", ""))
            ReportForm.GRepFormName = 1
    End Select
    With ReportForm
        .CAPTION = VehRep(Index).CAPTION
        .Show
    End With
    Set ReportForm = Nothing
End If
Exit Sub
errhand:
    MsgBox err.Description, vbInformation, "Information": Exit Sub
End Sub

Private Sub VehSalTrn_Click(Index As Integer)
PubUParam = Permission(Replace(VehSalTrn(Index).CAPTION, "&", ""))
If PubUParam = "****" Then Exit Sub
Select Case Index
    Case 1     'Performa Vehicle
        If frmQuot.Visible = False Then frmQuot.Show: Set frmQuot = Nothing
    Case 2      'Vehicle Booking
        If frmVehBook.Visible = False Then frmVehBook.Show: Set frmVehBook = Nothing
    Case 3      'Customer Receipt
'        If frmCustRect.Visible = False Then frmCustRect.Show: Set frmCustRect = Nothing
        If frmCustRect.Visible = False Then
            frmCustRect.PubReceiptType = "Vehicle"
            frmCustRect.Show
            Set frmCustRect = Nothing
        End If
    Case 4      'Vehicle Sale Bill
        If frmVehSale.Visible = False Then frmVehSale.Show: Set frmVehSale = Nothing
    Case 5      'Vehicle Delivery Challan
        If frmVehDel.Visible = False Then frmVehDel.Show: Set frmVehDel = Nothing
End Select
End Sub

Private Sub Warr_Click(Index As Integer)
PubUParam = Permission(Replace(Warr(Index).CAPTION, "&", ""))
If PubUParam = "****" Then Exit Sub
Select Case Index
    Case 1     'Product Complaint
        If frmWarrantyPCR.Visible = False Then frmWarrantyPCR.Show: Set frmWarrantyPCR = Nothing
    Case 2     'Warranty claim data
        If FormChk("Warranty Claim Data Entry") = True Then Exit Sub
        Dim Form1 As frmWarrantyWCD
        Set Form1 = New frmWarrantyWCD
        With Form1
'            .WarrTrnType = "WE"
            .CAPTION = "Warranty Claim Data Entry"
            .Show
        End With
        Set Form1 = Nothing
    Case 3  'claim Verification
        If FormChk("Warranty Claim Verification Entry") = True Then Exit Sub
        Dim Form2 As frmWarrantyWCD
        Set Form2 = New frmWarrantyWCD
        With Form2
'            .WarrTrnType = "ZE"
            .CAPTION = "Warranty Claim Verification Entry"
            .Show
        End With
        Set Form2 = Nothing
    Case 4     'Claim dispatch
        If frmWarrantyDispatch.Visible = False Then frmWarrantyDispatch.Show: Set frmWarrantyDispatch = Nothing
    Case 5  'Warranty Billing
        If frmWarrantyBill.Visible = False Then frmWarrantyBill.Show: Set frmWarrantyBill = Nothing
    Case 6  'Warranty Cr Note / Rejection
        If frmWarrantyCredit.Visible = False Then frmWarrantyCredit.Show: Set frmWarrantyCredit = Nothing
    Case 7
        WarrFrmName = Index
        If frmWarrMast.Visible = False Then frmWarrMast.Show: Set frmWarrMast = Nothing
        frmWarrMast.CAPTION = "Complaint Code Master"
    Case 8
        WarrFrmName = Index
        If frmWarrMast.Visible = False Then frmWarrMast.Show: Set frmWarrMast = Nothing
        frmWarrMast.CAPTION = "Failure Code Master"
    Case 9
        WarrFrmName = Index
        If frmWarrMast.Visible = False Then frmWarrMast.Show: Set frmWarrMast = Nothing
        frmWarrMast.CAPTION = "Make Code Master"
    Case 10
        WarrFrmName = Index
        If frmWarrMast.Visible = False Then frmWarrMast.Show: Set frmWarrMast = Nothing
        frmWarrMast.CAPTION = "Job Code Master"
End Select
End Sub

Private Sub WarrRep_Click(Index As Integer)
PubUParam = Permission(Replace(WarrRep(Index).CAPTION, "&", ""))
Dim rep As CrystalReport, ReportForm As Form
Dim Form1 As RP_WarClmReg
Dim Form2 As RP_WarClmNotMade

    Select Case Index
        Case 0  'UCase(Replace(Replace(VehRep(Index).Caption, "&", ""), " ", ""))
            Set ReportForm = New ReportWarranty
            ReportForm.GRepFormName = 1
            With ReportForm
                .CAPTION = WarrRep(Index).CAPTION   'Warranty Claim Register
                .Show
            End With
            Set ReportForm = Nothing
        Case 1
            If FormChk("Warranty Claims not made") = True Then Exit Sub
            Set Form2 = New RP_WarClmNotMade
            With Form2
                .g_FormID = 1
                .LblName.CAPTION = "Warranty Claims not made"
                .CAPTION = "Warranty Claims not made"
                .Show
            End With
            Set Form2 = Nothing
        Case 2
            If FormChk("Warranty Claims not made") = True Then Exit Sub
            Set Form1 = New RP_WarClmReg
            With Form1
                .g_FormID = 1
                .LblName.CAPTION = "Warranty Claims not Verified"
                .CAPTION = "Warranty Claims not Verified"
                .Show
            End With
            Set Form1 = Nothing
        Case 3
            Set Form1 = New RP_WarClmReg
            With Form1
                .g_FormID = 2
                .LblName.CAPTION = "Warranty Claims not Dispatched"
                .CAPTION = "Warranty Claims not Dispatched"
                .Show
            End With
            Set Form1 = Nothing
        Case 4
            Set Form1 = New RP_WarClmReg
            With Form1
                .g_FormID = 3
                .LblName.CAPTION = "Warranty Claims Rejected"
                .CAPTION = "Warranty Claims Rejected"
                .Show
            End With
            Set Form1 = Nothing
        Case 5
            Set Form1 = New RP_WarClmReg
            With Form1
                .g_FormID = 4
                .LblName.CAPTION = "Warranty Claims Outstanding"
                .CAPTION = "Warranty Claims Outstanding"
                .Show
            End With
            Set Form1 = Nothing
        Case 6
            Set Form1 = New RP_WarClmReg
            With Form1
                .g_FormID = 5
                .LblName.CAPTION = "Overall Warranty Claims"
                .CAPTION = "Overall Warranty Claims"
                .Show
            End With
            Set Form1 = Nothing
        Case 7
            Set Form1 = New RP_WarClmReg
            With Form1
                .g_FormID = 6
                .LblName.CAPTION = "Parts Not Issued but Claimed"
                .CAPTION = "Parts Not Issued but Claimed"
                .Show
            End With
            Set Form1 = Nothing
        Case 8
            Set Form1 = New RP_WarClmReg
            With Form1
                .g_FormID = 7
                .LblName.CAPTION = "Parts Issued but Not Claimed"
                .CAPTION = "Parts Issued but Not Claimed"
                .Show
            End With
            Set Form1 = Nothing
        Case 9
            With RP_WarClmSumm
                .g_FormID = 1
                .LblName.CAPTION = "Warranty Claim Summary"
                .CAPTION = "Warranty Claim Summary"
                .Show
            End With
        Case 10
            Set ReportForm = New ReportFreeSrv
            With ReportForm
                .GRepFormName = 1
                .CAPTION = Replace(WarrRep(Index).CAPTION, "&", "")
                .LblTitle = Replace(WarrRep(Index).CAPTION, "&", "")
                .Show
            End With
            Set ReportForm = Nothing
        Case 11
            With RP_WarClmPartFail
                .g_FormID = 1
                .LblName.CAPTION = "Warranty Parts Failure Summary"
                .CAPTION = "Warranty Parts Failure Summary"
                .Show
            End With
        Case 12
            Set ReportForm = New ReportFreeSrv
            With ReportForm
                .GRepFormName = 2
                .CAPTION = Replace(WarrRep(Index).CAPTION, "&", "")
                .LblTitle = Replace(WarrRep(Index).CAPTION, "&", "")
                .Show
            End With
            Set ReportForm = Nothing
    End Select
End Sub

Private Sub WkShop_Click(Index As Integer)
Dim rep As CrystalReport
PubUParam = Permission(Replace(WkShop(Index).CAPTION, "&", ""))
Dim ReportForm As Form
On Error GoTo errhand
Set ReportForm = New ReportWorkShop
Select Case UCase(Replace(Replace(WkShop(Index).CAPTION, "&", ""), " ", ""))
    Case UCase(Replace("Labour Rate Variation Reports", " ", ""))
        ReportForm.GRepFormName = 1
    Case UCase(Replace("Service-wise Job Analysis", " ", ""))
        ReportForm.GRepFormName = 3
    Case UCase(Replace("Model-wise Service Analysis", " ", ""))
        ReportForm.GRepFormName = 4
    Case UCase(Replace("WorkShop Demand Vs Supply", " ", ""))
        ReportForm.GRepFormName = 5
    Case UCase(Replace("Mechanic Earning Report", " ", ""))
        ReportForm.GRepFormName = 6
    Case UCase(Replace("Mechanic Earning Summary", " ", ""))
        ReportForm.GRepFormName = 7
    Case UCase(Replace("Dealer-wise Vehicle Attended", " ", ""))
        ReportForm.GRepFormName = 8
    Case UCase(Replace("Model-wise Job Analysis", " ", ""))
        ReportForm.GRepFormName = 9
    Case UCase(Replace("Aggregate Group-wise Inventory", " ", ""))
        ReportForm.GRepFormName = 10
    Case UCase(Replace("Job-wise Labour Analysis", " ", ""))
        ReportForm.GRepFormName = 11
    Case UCase(Replace("Dealer-wise Job Analysis", " ", ""))
        ReportForm.GRepFormName = 12
    Case UCase(Replace("Delay Reason Analysis", " ", ""))
        ReportForm.GRepFormName = 13
    Case UCase(Replace("WorkShop Rate Variation Report", " ", ""))
        ReportForm.GRepFormName = 14
    Case UCase(Replace("Cancellation Report(W/C)", " ", ""))
        ReportForm.GRepFormName = 15
    Case UCase(Replace("Labour Incentive Report", " ", ""))
        ReportForm.GRepFormName = 16
    Case UCase(Replace("Vehicle Grading Report", " ", ""))
        ReportForm.GRepFormName = 17
    Case UCase(Replace("Service Tax Register", " ", ""))
        ReportForm.GRepFormName = 18
    Case UCase(Replace("Labour Revenue Report", " ", ""))
        ReportForm.GRepFormName = 19
    Case UCase(Replace("Service Due Register", " ", ""))
        ReportForm.GRepFormName = 20
    Case UCase(Replace("Quarterly Return Register", " ", ""))
        ReportForm.GRepFormName = 21
    Case UCase(Replace("Post Service Followups", " ", ""))
        ReportForm.GRepFormName = 22
    Case UCase(Replace("Sales Tax With Serv. Tax", " ", ""))
        ReportForm.GRepFormName = 23
    Case UCase(Replace("Repeat Job Analysis", " ", ""))
        ReportForm.GRepFormName = 24
End Select
With ReportForm
    .CAPTION = WkShop(Index).CAPTION
    .LblTitle = WkShop(Index).CAPTION
    .Show
End With
Set ReportForm = Nothing
    Exit Sub
errhand:
    MsgBox err.Description, vbInformation, "Information": Exit Sub
End Sub





Private Sub WrkDRep_Click(Index As Integer)
Dim rep As CrystalReport, Menucaption$, ReportForm As Form
PubUParam = Permission(Replace(WrkDRep(Index).CAPTION, "&", ""))
On Error GoTo errhand
Menucaption = UCase(Replace(Replace(WrkDRep(Index).CAPTION, "&", ""), " ", ""))
If Menucaption = UCase(Replace("Workshop Sale Register", " ", "")) Or Menucaption = UCase(Replace("Sale Register", " ", "")) Then
    Set ReportForm = New ReprtFormGlobal
Else
    Set ReportForm = New ReportWorkShop2
End If
Select Case Menucaption
    Case UCase(Replace("Estimate Register", " ", ""))
        ReportForm.GRepFormName = 2
    Case UCase(Replace("Performa Register", " ", ""))
        ReportForm.GRepFormName = 3
    Case UCase(Replace("Workshop Sale Register", " ", ""))
        ReportForm.GRepFormName = 14
    Case UCase(Replace("Internal Requisition Register", " ", ""))
        ReportForm.GRepFormName = 4
    Case UCase(Replace("Workshop Vehicle Diary", " ", ""))
        ReportForm.GRepFormName = 5
    Case UCase(Replace("JobCard Register", " ", ""))
        ReportForm.GRepFormName = 6
    Case UCase(Replace("Sale Register", " ", ""))
        ReportForm.GRepFormName = 28
    Case UCase(Replace("Gate Pass Register", " ", ""))
        ReportForm.GRepFormName = 7
    Case UCase(Replace("Part Grade-wise Requisition Register", " ", ""))
        ReportForm.GRepFormName = 8
    Case UCase(Replace("Out-side Labour Register", " ", ""))
        ReportForm.GRepFormName = 9
    Case UCase(Replace("Over Time Register", " ", ""))
        ReportForm.GRepFormName = 10
    Case UCase(Replace("Veh History Register", " ", ""))
        ReportForm.GRepFormName = 12
    Case UCase(Replace("Job Booking Register", " ", ""))
        ReportForm.GRepFormName = 1
End Select
With ReportForm
    .CAPTION = WrkDRep(Index).CAPTION
    .LblTitle = WrkDRep(Index).CAPTION
    .Show
End With
Set ReportForm = Nothing
errhand:
    If err.NUMBER <> 0 Then CheckError
Set ReportForm = Nothing
End Sub

Private Sub WrkMas_Click(Index As Integer)
PubUParam = Permission(Replace(WrkMas(Index).CAPTION, "&", ""))
If PubUParam = "****" Then Exit Sub
Select Case Index
    Case 1     'Service Master
        If frmService.Visible = False Then frmService.Show: Set frmService = Nothing
    Case 2     'Service Rate/Lubricants Qty Declaration Model-wise
        If frmSrvLubRate.Visible = False Then frmSrvLubRate.Show: Set frmSrvLubRate = Nothing
    Case 3     'Labour Group Master
        If frmLabGrp.Visible = False Then frmLabGrp.Show: Set frmLabGrp = Nothing
    Case 4     'Labour Type Master
        If frmLabTyp.Visible = False Then frmLabTyp.Show: Set frmLabTyp = Nothing
    Case 5     'Labour Type Master
        If frmLabDesc.Visible = False Then frmLabDesc.Show: Set frmLabDesc = Nothing
    Case 6     'Model-wise Labour Details Master
        If frmModLabDet.Visible = False Then frmModLabDet.Show: Set frmModLabDet = Nothing
    Case 7     'Model-wise Service-wise Pre-Defined Job Details
        If frmModSrvPreDefJob.Visible = False Then frmModSrvPreDefJob.Show: Set frmModSrvPreDefJob = Nothing
    Case 8     'Reason for Job Delay Master
        If frmJobDelay.Visible = False Then frmJobDelay.Show: Set frmJobDelay = Nothing
    Case 9     'Trouble Master
        If frmTrouble.Visible = False Then frmTrouble.Show: Set frmTrouble = Nothing
    Case 10     'Inspection Category Master
        If frmInspCat.Visible = False Then frmInspCat.Show: Set frmInspCat = Nothing
    Case 11     'Inspection Elements Master
        If frmInspEle.Visible = False Then frmInspEle.Show: Set frmInspEle = Nothing
    Case 12     'Workshop Vehicle Master
        If frmWorkVehiMast.Visible = False Then frmWorkVehiMast.Show: Set frmWorkVehiMast = Nothing
    Case 13     'Workshop Details Master
        If frmWorkDetMast.Visible = False Then frmWorkDetMast.Show: Set frmWorkDetMast = Nothing
    End Select
End Sub


Private Sub WrkTrn_Click(Index As Integer)
PubUParam = Permission(Replace(WrkTrn(Index).CAPTION, "&", ""))
If PubUParam = "****" Then Exit Sub
Dim Form1 As frmRequisition
Select Case Index
    Case 1
        If frmJobBooking.Visible = False Then frmJobBooking.Show: Set frmJobBooking = Nothing
    Case 2
        
        If frmJobCard.Visible = False Then frmJobCard.Show: Set frmJobCard = Nothing
    Case 3
        If FormChk(WrkTrn(Index).CAPTION) = True Then Exit Sub
        Set Form1 = New frmRequisition
        With Form1
            .PubRequisitionType = "Workshop"
            .CAPTION = WrkTrn(Index).CAPTION
            .Show
        End With
        Set Form1 = Nothing
    Case 4
        If frmJobGatePass.Visible = False Then frmJobGatePass.Show: Set frmJobGatePass = Nothing
    Case 5
        
        If frmJobLabour.Visible = False Then frmJobLabour.Show: Set frmJobLabour = Nothing
    Case 6
        If frmProfLab.Visible = False Then frmProfLab.Show: Set frmProfLab = Nothing
    Case 7
        If frmJobObserAction.Visible = False Then frmJobObserAction.Show: Set frmJobObserAction = Nothing
    Case 8
'        If frmEstimateQuot.Visible = False Then frmEstimateQuot.Show: Set frmEstimateQuot = Nothing
        If frmEstimateQuot.Visible = False Then
            frmEstimateQuot.PubEstimateType = "WorkShop"
            frmEstimateQuot.Show
            Set frmEstimateQuot = Nothing
        End If
    Case 9
        
        If frmJobClose.Visible = False Then frmJobClose.Show: Set frmJobClose = Nothing
    Case 10
        If frmCustRect.Visible = False Then
            frmCustRect.PubReceiptType = "WorkShop"
            frmCustRect.Show
            Set frmCustRect = Nothing
        End If
    Case 11
        If frmOverTime.Visible = False Then frmOverTime.Show: Set frmOverTime = Nothing
End Select
End Sub

Public Function Permission(Menucaption As String) As String
On Error GoTo err1
Dim TSQL As String
Dim rs As ADODB.Recordset
'Form_Code + Param_Str + Comp_Code + Div_Code

    TSQL = "select Param_Str from user2 where Comp_Code='" & PubCenCompCode & _
            "' and Div_code = '" & PubDivCode & "' and user_name='" & pubUName & _
            "' and form_code in (select Form_Code from User_Module where " & cUCase("Name") & "='" & UCase(Menucaption) & "')"

    Set rs = New ADODB.Recordset
    rs.Open TSQL, G_CompCn, adOpenStatic, adLockReadOnly
    If Not rs.EOF Then
        Permission = rs!param_str
'    Else
'        Permission = ""
'        MsgBox "UnAuthorised Access", vbInformation, "Access Denied"
    End If
    If RSOJPR = True Then
        If pubUName = "ADMIN" Then Permission = "AEDP": Exit Function
    Else
        If pubUName = "SA" Then Permission = "AEDP": Exit Function
    End If

    Set rs = Nothing
Exit Function
err1:
    MsgBox err.Description
End Function

Private Sub ModuleMenu()
Dim I As Integer
'     If PubVCompCode = "" Then
    If Not AllowModuleVeh Then
'        Mas(10).Visible = False
        Me.MnuVeh.Visible = False
        Utl(4).Visible = False
    End If
'   If PubVCompCode = "" And PubWCompCode = "" Then
   If Not AllowModuleVeh And Not AllowModuleWrk Then
        Me.Mas(3).Visible = False
        Me.Mas(7).Visible = False
        Me.Mas(8).Visible = False
        Me.Mas(9).Visible = False
        Me.Mas(10).Visible = False
        For I = 10 To 16
            Me.MnuLst1(I).Visible = False
        Next
    End If
'    If PubSCompCode = "" Then
    If Not AllowModuleSpr Then
        Me.Mas(12).Visible = False
        Me.MnuSpr.Visible = False
        Utl(5).Visible = False
    End If
'    If PubWCompCode = "" Then
    If Not AllowModuleWrk Then
        MnuWorks.Visible = False
        Utl(4).Visible = False
    End If
    
    If PubBackEnd = "S" Then
        Utl(13).Visible = False
        Utl(14).Visible = False
        Utl(15).Visible = False
        Utl(24).Visible = False
        Utl(25).Visible = False
    End If
End Sub

Private Sub CloseAllConn()
If GCn.State <> 0 Then GCn.Close
If GCnFaV.State <> 0 Then GCnFaV.Close
If GCnFaS.State <> 0 Then GCnFaS.Close
If GCnFaW.State <> 0 Then GCnFaW.Close
G_FaCn.Close
'G_CompCn.Close
End Sub
Private Sub OpenAllConn()
With GCn
    .CursorLocation = adUseClient
    .Provider = "Microsoft.Jet.OLEDB.4.0"
    .ConnectionString = "Data Source=" & Pub_DataPath & "\Auto_" & PubCenCompCode & "\automan.mdb" & ";Persist Security Info=False;Jet OLEDB:Database Password=dtman"
    .Open
End With
With GCnFaV
    .CursorLocation = adUseClient
    .Provider = "Microsoft.Jet.OLEDB.4.0"
    .ConnectionString = "Data Source=" & PubVFADataPath & ";Persist Security Info=False;Jet OLEDB:Database Password=dtman"
    .Open
End With
With GCnFaS
    .CursorLocation = adUseClient
    .Provider = "Microsoft.Jet.OLEDB.4.0"
    .ConnectionString = "Data Source=" & PubSFADataPath & ";Persist Security Info=False;Jet OLEDB:Database Password=dtman"
    .Open
End With
With GCnFaW
    .CursorLocation = adUseClient
    .Provider = "Microsoft.Jet.OLEDB.4.0"
    .ConnectionString = "Data Source=" & PubWFADataPath & ";Persist Security Info=False;Jet OLEDB:Database Password=dtman"
    .Open
End With
With G_FaCn
    .CursorLocation = adUseClient
    .Provider = "Microsoft.Jet.OLEDB.4.0"
    .ConnectionString = "Data Source=" & PubVFADataPath & ";Persist Security Info=False;Jet OLEDB:Database Password=dtman"
    .Open
End With
End Sub

Public Sub CompactDatabase()
'   1.Check User Status must be Administrator
'   2.Necessary Disk Space
'   3.Tag G_FACN connect string
'   4.Close All Connections
'   5.Check for exclusive mode / make sure all users log out
If PubULabel <> "Y" Then MsgBox "Permission Denied", vbCritical, "Permission Not Found !"
MsgBox "At least twice Disk space of exisiting database size required", vbCritical, "Extra Disk Space Required!"
If MsgBox("Are You Sure To Compact Database ? ", vbYesNo + vbCritical + vbDefaultButton2, "Compact Database !") = vbNo Then Exit Sub

On Error GoTo ELoop
'declare array for multiple databases
Dim DataBases(4) As DBDetails, I As Byte
Dim DB As DAO.Database
Dim NewDataPath$, DatabaseSep As Byte
DataBases(0).DataPath = Pub_DataPath & "\Auto_" & PubCenCompCode & "\Automan.mdb"
DataBases(0).PassWord = "dtman"
If PubVFADataPath = PubSFADataPath And PubVFADataPath = PubWFADataPath Then
    DataBases(1).DataPath = PubVFADataPath
    DataBases(1).PassWord = ""
ElseIf PubVFADataPath = PubSFADataPath And PubVFADataPath <> PubWFADataPath Then
    DataBases(1).DataPath = PubVFADataPath
    DataBases(1).PassWord = ""
    DataBases(2).DataPath = PubWFADataPath
    DataBases(2).PassWord = ""
ElseIf PubVFADataPath <> PubSFADataPath And PubVFADataPath = PubWFADataPath Then
    DataBases(1).DataPath = PubVFADataPath
    DataBases(1).PassWord = ""
    DataBases(2).DataPath = PubSFADataPath
    DataBases(2).PassWord = ""
ElseIf PubVFADataPath <> PubSFADataPath And PubVFADataPath <> PubWFADataPath Then
    DataBases(1).DataPath = PubVFADataPath
    DataBases(1).PassWord = ""
    DataBases(2).DataPath = PubSFADataPath
    DataBases(2).PassWord = ""
    DataBases(3).DataPath = PubWFADataPath
    DataBases(3).PassWord = ""
End If
GCn.Close
GCnFaV.Close
GCnFaS.Close
GCnFaW.Close
G_FaCn.Close
    For I = 0 To UBound(DataBases)
        If DataBases(I).DataPath <> "" Then
            '*******
            Picture1.Visible = True
            Label1.CAPTION = "Please wait compacting (" & DataBases(I).DataPath & ") ..."
            '********

            DatabaseSep = InStrRev(DataBases(I).DataPath, "\")
            NewDataPath = left(DataBases(I).DataPath, DatabaseSep) & "DB1.MDB"
            'Check disk space
            
            'Checking for Exclusive mode
'            If DataBases(i).PassWord = "" Then
'                Set DB = OpenDatabase(DataBases(i).DataPath, True)
'            Else
                Set DB = OpenDatabase(DataBases(I).DataPath, True, False, ";pwd=" & DataBases(I).PassWord)
'            End If
            DB.Close
            
            ' Make sure there isn't already a file with the
            ' name of the compacted database.
            If Dir(NewDataPath) <> "" Then _
                Kill NewDataPath
            
            'This statement creates a compact Microsoft Jet database.
            If DataBases(I).PassWord = "" Then
                DBEngine.CompactDatabase DataBases(I).DataPath, NewDataPath
            Else
                DBEngine.CompactDatabase DataBases(I).DataPath, NewDataPath, , , ";pwd=" & DataBases(I).PassWord
            End If
            Kill DataBases(I).DataPath
            Name NewDataPath As DataBases(I).DataPath   ' Rename file.
        End If
    Next
    MsgBox "Database Compact Completed successfully!", vbOKOnly, "Compact Database"
    
ELoop:
Picture1.Visible = False
Set DB = Nothing
GCn.Open
GCnFaV.Open
GCnFaS.Open
GCnFaW.Open
G_FaCn.Open
' any errors
If err.NUMBER <> 0 Then CheckError
End Sub

Public Sub AddFieldTable(DB As DAO.Database, TableName As String, FieldName As String, _
        FIELDTYPE As Variant, Optional FieldSize As Integer, Optional RequiredYesNo As Boolean, _
        Optional AllowZero As Boolean, Optional DefValue As Variant)
'TableName$, FieldName$, FIELDTYPE As Variant, Optional FieldSize As Integer,
'Optional RequiredYesNo As Boolean, Optional AllowZero As Boolean, Optional DefValue As Variant
Dim tmprs As DAO.Recordset
Dim N As Integer, TDF As TableDef, FLD As DAO.Field
    Set tmprs = DB.OpenRecordset("select * from " & TableName)
    For N = 0 To tmprs.Fields.Count - 1
        If UCase(tmprs.Fields(N).Name) = UCase(FieldName) Then
            GoTo Myexit
        End If
        'MsgBox UCase(tmprs.Fields(N).Name)
        'MsgBox tmprs.Fields(N)
    Next
    Set tmprs = Nothing
    Set TDF = DB.TableDefs(TableName)
    Set FLD = TDF.CreateField(FieldName)
    
    FLD.Type = FIELDTYPE
    
    If FIELDTYPE = 10 Then      '' Text Field
        FLD.Size = FieldSize
        If Not IsMissing(AllowZero) Then FLD.AllowZeroLength = AllowZero
    End If
    If Not IsMissing(DefValue) Then FLD.DefaultValue = DefValue
    If Not IsMissing(RequiredYesNo) Then FLD.Required = RequiredYesNo
    TDF.Fields.Append FLD
Myexit:
    Set tmprs = Nothing
End Sub
Public Sub AddNewFieldFAData()
Dim TempRs As ADODB.Recordset
Dim RsUser As ADODB.Recordset
If MsgBox("Are You Sure To Update Table Structure ? ", vbYesNo + vbCritical + vbDefaultButton2, "Modify Database !") = vbNo Then Exit Sub
'On Error Resume Next
If PubBackEnd = "A" Then DataBackup
Picture1.Visible = True
Label1.CAPTION = "Please Wait ! Table Structure Updation in progress....."
Dim DataPath$, DataPathFa$
Dim DB As DAO.Database



If PubBackEnd = "A" Then
    DataPath = Pub_DataPath & "\Auto_" & PubCenCompCode & "\Automan.mdb"
    DataPathFa = PubFADataPath
    
    'FilmMenu
    'dbBinInt,dbBoolean,dbByte,dbDate,dbDecimal,dbDouble,dbFloat
    'dbInteger,dbMemo,dbNumeric,dbSingle,dbText,dbTime,dbTimestamp
        'Checking for Exclusive mode
        If GCn.State = 1 Then GCn.Close
        If GCnFaV.State = 1 Then GCnFaV.Close
        If GCnFaS.State = 1 Then GCnFaS.Close
        If GCnFaW.State = 1 Then GCnFaW.Close
        If G_FaCn.State = 1 Then G_FaCn.Close
        
        Dim tmpDb As DAO.Database
        Set tmpDb = OpenDatabase(DataPath, True, False, ";pwd=dtman")
        Dim tmpDbFA As DAO.Database
        Set tmpDbFA = OpenDatabase(DataPathFa, True, False)
        
        
        'From 20-09-2003
        Call AddFieldTable(tmpDb, "Job_Lab", "ActualHrs", dbDouble, 10, False, True, 0)
        Call AddFieldTable(tmpDb, "Veh_Order", "SubventionScheme", dbText, 20, False, True, "")
        Call AddFieldTable(tmpDb, "Veh_Order", "HandlingCharges", dbDouble, 10, False, True, 0)
        Call AddFieldTable(tmpDb, "Veh_Order", "DealerContribution", dbDouble, 10, False, True, 0)
        Call AddFieldTable(tmpDb, "Veh_Order", "TataContribution", dbDouble, 10, False, True, 0)
        Call AddFieldTable(tmpDb, "Veh_Order", "Subvention", dbDouble, 10, False, True, 0)
        Call AddFieldTable(tmpDb, "Veh_Order", "DeliveryFrom", dbText, 10, False, True, "")
        Call AddFieldTable(tmpDb, "Veh_Rate", "HandlingCharges", dbDouble, 10, False, True, 0)
        Call AddFieldTable(tmpDb, "Veh_Rate", "GenExGodRate", dbDouble, 10, False, True, 0)
        Call AddFieldTable(tmpDb, "Veh_Rate", "GovtExGodRate", dbDouble, 10, False, True, 0)
        Call AddFieldTable(tmpDbFA, "AcControls", "SubventionClaimAc", dbText, 8, False, True, "")
        Call AddFieldTable(tmpDbFA, "AcControls", "SubventionAc", dbText, 8, False, True, "")
        Call AddFieldTable(tmpDbFA, "AcControls", "IndirectExpAc", dbText, 8, False, True, "")
        Call AddFieldTable(tmpDbFA, "AcControls", "OctraiAc", dbText, 8, False, True, "")
        Call AddFieldTable(tmpDbFA, "AcControls", "RegnFeeAc", dbText, 8, False, True, "")
        Call AddFieldTable(tmpDbFA, "AcControls", "InsuranceFeeAc", dbText, 8, False, True, "")
        Call AddFieldTable(tmpDbFA, "AcControls", "CreditCardAc", dbText, 8, False, True, "")
        Call AddFieldTable(tmpDbFA, "AcControls", "ChqClrAc", dbText, 8, False, True, "")
        
        Call AddFieldTable(tmpDb, "Job_Card", "FreeWarrLabAmt", dbDouble, 8, False, True, 0)
        Call AddFieldTable(tmpDb, "Job_Card", "CreditCardNo", dbText, 20, False, True, "")
        Call AddFieldTable(tmpDb, "Job_Card", "ChqNo", dbText, 20, False, True, "")
        Call AddFieldTable(tmpDb, "Job_Card", "ChqDate", dbDate, 15, False, True, "")
        Call AddFieldTable(tmpDb, "Estimate", "NamePrefix", dbText, 4, False, True, 0)
        Call AddFieldTable(tmpDb, "Job_Card", "LabAmt_Out", dbDouble, 5, False, True, 0)
        Call AddFieldTable(tmpDb, "Syctrl", "SrvTaxOnOutSideLab", dbByte, 1, True, True, 0)
        Call AddFieldTable(tmpDb, "Syctrl", "PostRegnFeeYn", dbByte, 1, True, True, 0)
        Call AddFieldTable(tmpDb, "Syctrl", "PostInsuranceFeeYn", dbByte, 1, True, True, 0)
        Call AddFieldTable(tmpDb, "Syctrl", "PostOctraiSaperatelyYn", dbByte, 1, True, True, 0)
        Call AddFieldTable(tmpDb, "Syctrl", "VatPerOnLube", dbDouble, , True, True, 0)
        Call AddFieldTable(tmpDb, "Syctrl", "eCessPer", dbDouble, , True, True, 0)
        Call AddFieldTable(tmpDb, "Part_Grade", "VatPer", dbDouble, , True, True, 0)
        Call AddFieldTable(tmpDb, "Job_Card", "eCessPer", dbDouble, , True, True, 0)
        Call AddFieldTable(tmpDb, "Job_Card", "eCessAmt", dbDouble, , True, True, 0)
        Call AddFieldTable(tmpDb, "Syctrl", "DebtorInSupplierHelp", dbByte, 1, True, True, 0)
        Call AddFieldTable(tmpDb, "Hiscard", "DisSprMRP", dbSingle, 1, False, True, 0)
        Call AddFieldTable(tmpDb, "Hiscard", "DisSprTB", dbSingle, 1, False, True, 0)
        Call AddFieldTable(tmpDb, "Hiscard", "DisSprTP", dbSingle, 1, False, True, 0)
        Call AddFieldTable(tmpDb, "Hiscard", "DisOilMRP", dbSingle, 1, False, True, 0)
        Call AddFieldTable(tmpDb, "Hiscard", "DisOilTB", dbSingle, 1, False, True, 0)
        Call AddFieldTable(tmpDb, "Hiscard", "DisOilTP", dbSingle, 1, False, True, 0)
        Call AddFieldTable(tmpDb, "Job_Warr2", "AggNo", dbText, 15, False, True, "")
        Call AddFieldTable(tmpDb, "Job_Demand", "Lab_Code", dbText, 8, False, True, "")
        Call AddFieldTable(tmpDb, "Model", "ServiceTax_YN", dbByte, 1, False, True, "")
        Call AddFieldTable(tmpDb, "Model", "Sale_Rate", dbDouble, 8, False, True, 0)
        Call AddFieldTable(tmpDb, "Veh_Order", "TOT_Per", dbSingle, 5, False, True, 0)
        Call AddFieldTable(tmpDb, "Veh_Order", "TOT_Amt", dbDouble, 5, False, True, 0)
        Call AddFieldTable(tmpDb, "Rect", "Veh_Amt", dbDouble, 5, False, True, 0)
        Call AddFieldTable(tmpDb, "Rect", "Tax_Amt", dbDouble, 5, False, True, 0)
        Call AddFieldTable(tmpDb, "Rect", "Surcharge_Amt", dbDouble, 5, False, True, 0)
        Call AddFieldTable(tmpDb, "Rect", "TOT_Amt", dbDouble, 5, False, True, 0)
        Call AddFieldTable(tmpDb, "Syctrl", "PostFinAmt", dbByte, 1, False, True, 0)
        Call AddFieldTable(tmpDb, "Job_Lab", "Chrg_Type", dbText, 1, False, True, 0)
        Call AddFieldTable(tmpDb, "Emp_Mast", "OT_Rate", dbSingle, 6, False, True, 0)
        Call AddFieldTable(tmpDb, "Estimate", "Suppl_YN", dbByte, 1, False, True, 0)
        Call AddFieldTable(tmpDb, "Syctrl", "DiscOnLube", dbByte, 1, False, True, 0)
        Call AddFieldTable(tmpDb, "Syctrl", "TOTOnLube", dbByte, 1, False, True, 0)
        Call AddFieldTable(tmpDb, "Syctrl", "JobCardPrePrintedYN", dbByte, 1, False, True, 0)
        Call AddFieldTable(tmpDb, "Syctrl", "JobBillPrePrintedYN", dbByte, 1, False, True, 0)
        Call AddFieldTable(tmpDb, "Syctrl", "SprBillPrePrintedYN", dbByte, 1, False, True, 0)
        Call AddFieldTable(tmpDb, "Syctrl", "VehBillPrePrintedYN", dbByte, 1, False, True, 0)
        Call AddFieldTable(tmpDb, "Job_GatePass", "Complaints", dbText, 150, False, True, "")
        Call AddFieldTable(tmpDb, "Job_GatePass", "Instructions", dbText, 150, False, True, "")
        Call AddFieldTable(tmpDb, "SP_Purch", "Transportation", dbDouble, 10, False, True, 0)
        Call AddFieldTable(tmpDbFA, "AcControls", "SprPurTrans_Ac", dbText, 8, False, True, 0)
        Call AddFieldTable(tmpDb, "SubGroup", "RC_No", dbText, 50, False, True, "")
        Call AddFieldTable(tmpDbFA, "SubGroup", "RC_No", dbText, 50, False, True, "")
        Call AddFieldTable(tmpDb, "SubGroupAlias", "RC_No", dbText, 50, False, True, "")
        Call AddFieldTable(tmpDbFA, "SubGroupAlias", "RC_No", dbText, 50, False, True, "")
        Call AddFieldTable(tmpDb, "SP_Order", "CustOrd_Det", dbText, 50, False, True, "")
        Call AddFieldTable(tmpDb, "Part", "PhyStk", dbDouble, 7, False, True, 0)
        Call AddFieldTable(tmpDb, "Trouble", "TRelated", dbText, 3, False, True, "")
        Call AddFieldTable(tmpDb, "Trouble", "TType", dbText, 9, False, True, "")
        Call AddFieldTable(tmpDb, "Job_Demand", "Complaint_YN", dbDouble, 1, False, True, 0)
        Call AddFieldTable(tmpDb, "Job_Demand", "Repeat_YN", dbDouble, 1, False, True, 0)
        Call AddFieldTable(tmpDb, "Veh_SubGroupQuot", "OrdDocID", dbText, 21, False, True, "")
        Call AddFieldTable(tmpDb, "Veh_SubGroupQuot", "PurchModel", dbText, 20, False, True, "")
        Call AddFieldTable(tmpDb, "Visits", "Schemes", dbByte, 1, False, True, 0)
        Call AddFieldTable(tmpDb, "Visits", "SalesNos", dbByte, 1, False, True, 0)
        Call AddFieldTable(tmpDb, "Visits", "Prices", dbByte, 1, False, True, 0)
        Call AddFieldTable(tmpDb, "Visits", "Pamphlets", dbByte, 1, False, True, 0)
        Call AddFieldTable(tmpDb, "Visits", "Hoardings", dbByte, 1, False, True, 0)
        Call AddFieldTable(tmpDb, "Visits", "Events", dbByte, 1, False, True, 0)
        Call AddFieldTable(tmpDb, "Visits", "MediaAds", dbByte, 1, False, True, 0)
        Call AddFieldTable(tmpDb, "Visits", "Misc", dbByte, 1, False, True, 0)
        Call AddFieldTable(tmpDb, "HisCard", "Varient", dbText, 10, False, True, "")
        Call AddFieldTable(tmpDb, "HisCard", "VehDet", dbText, 10, False, True, "")
        Call AddFieldTable(tmpDb, "HisCard", "ExtendWar", dbByte, 1, False, True, 0)
        Call AddFieldTable(tmpDb, "HisCard", "ExtendWar", dbByte, 1, False, True, 0)
        Call AddFieldTable(tmpDb, "Syctrl", "HelpLineNo", dbText, 20, False, True, "")
        Call AddFieldTable(tmpDb, "Part", "PurDocId", dbText, 21, False, True, "")
        Call AddFieldTable(tmpDb, "Part", "PurDate", dbDate, 15, False, True, "")
        Call AddFieldTable(tmpDb, "Part", "PurRate", dbDouble, 15, False, True, "")
        Call AddFieldTable(tmpDb, "Estimate", "Remarks", dbText, 50, False, True, "")
        Call AddFieldTable(tmpDb, "Syctrl", "SrvTaxNo", dbText, 30, False, True, "")
        Call AddFieldTable(tmpDbFA, "AcControls", "JobContractor", dbText, 8, False, True, "")
        Call AddFieldTable(tmpDb, "Job_Card", "KmsHrs", dbText, 1, False, True, "")
        Call AddFieldTable(tmpDb, "Syctrl", "VAT_YN", dbByte, 1, False, True, 0)
        Call AddFieldTable(tmpDbFA, "SubGroup", "NewYrSubCode", dbText, 8, False, True, "")
        Call AddFieldTable(tmpDbFA, "SubGroupAlias", "NewYrSubCode", dbText, 8, False, True, "")
        Call AddFieldTable(tmpDb, "SubGroup", "NewYrSubCode", dbText, 8, False, True, "")
        Call AddFieldTable(tmpDb, "SubGroupAlias", "NewYrSubCode", dbText, 8, False, True, "")
        Call AddFieldTable(tmpDb, "Syctrl", "SDT_YN", dbByte, 1, False, True, 0)
        Call AddFieldTable(tmpDb, "Syctrl", "TOTCaption", dbText, 5, False, True, "T O T")
        Call AddFieldTable(tmpDb, "SP_Stock", "TaxPer", dbDouble, 8, False, True, 0)
        Call AddFieldTable(tmpDb, "SP_Stock", "TaxAmt", dbDouble, 8, False, True, 0)
        Call AddFieldTable(tmpDb, "Syctrl", "VehRateIncTax", dbByte, 1, False, True, 0)
        Call AddFieldTable(tmpDb, "Veh_Order", "SubTot", dbDouble, 10, False, True, 0)
        Call AddFieldTable(tmpDb, "Veh_Order", "RegBy", dbText, 6, False, True, "")
        Call AddFieldTable(tmpDb, "Veh_Order1", "SubTot", dbDouble, 10, False, True, 0)
        Call AddFieldTable(tmpDb, "Veh_Order1", "RegBy", dbText, 6, False, True, "")
        Call AddFieldTable(tmpDbFA, "SubGroup", "FinCode", dbText, 8, False, True, "")
        Call AddFieldTable(tmpDbFA, "SubGroupAlias", "FinCode", dbText, 8, False, True, "")
        Call AddFieldTable(tmpDb, "SubGroup", "FinCode", dbText, 8, False, True, "")
        Call AddFieldTable(tmpDb, "SubGroupAlias", "FinCode", dbText, 8, False, True, "")
        Call AddFieldTable(tmpDb, "Veh_Stock", "TrfParty", dbText, 8, False, True, "")
        Call AddFieldTable(tmpDb, "Syctrl", "ZeroBill", dbByte, 1, False, True, 0)
        Call AddFieldTable(tmpDb, "Job_Card", "HrMeter", dbText, 12, False, True, "")
        Call AddFieldTable(tmpDb, "SP_Sale", "PType", dbText, 7, False, True, "General")
        Call AddFieldTable(tmpDb, "Veh_Stock", "RectType", dbText, 1, False, True, "")
        Call AddFieldTable(tmpDb, "Veh_Order", "AdvEMI", dbDouble, 10, False, True, 0)
        Call AddFieldTable(tmpDb, "Veh_Order", "AccCode", dbText, 100, False, True, "")
        Call AddFieldTable(tmpDb, "Veh_Order", "AccQty", dbText, 50, False, True, "")
        
        Call AddFieldTable(tmpDb, "Veh_Order", "OffTake", dbDouble, 10, False, True, 0)
        Call AddFieldTable(tmpDb, "Veh_Order", "InsComm", dbDouble, 10, False, True, 0)
        Call AddFieldTable(tmpDb, "Veh_Order", "FinPayOut", dbDouble, 10, False, True, 0)
        Call AddFieldTable(tmpDb, "Veh_Order", "FinInc", dbDouble, 10, False, True, 0)
        Call AddFieldTable(tmpDb, "Veh_Order", "EBTA", dbDouble, 10, False, True, 0)
        Call AddFieldTable(tmpDb, "Veh_Order", "Retail", dbDouble, 10, False, True, 0)
        Call AddFieldTable(tmpDb, "Veh_Order", "SPInc", dbDouble, 10, False, True, 0)
        Call AddFieldTable(tmpDb, "Veh_Order", "Brokrage", dbDouble, 10, False, True, 0)
        Call AddFieldTable(tmpDb, "Veh_Order", "Subvention", dbDouble, 10, False, True, 0)
        Call AddFieldTable(tmpDb, "Veh_Order", "AmtRecd", dbDouble, 10, False, True, 0)
        
        Call AddFieldTable(tmpDb, "Veh_Order1", "AdvEMI", dbDouble, 10, False, True, 0)
        Call AddFieldTable(tmpDb, "Veh_Order1", "AccCode", dbText, 100, False, True, "")
        Call AddFieldTable(tmpDb, "Veh_Order1", "AccQty", dbText, 50, False, True, "")
        Call AddFieldTable(tmpDb, "Veh_Order1", "OffTake", dbDouble, 10, False, True, 0)
        Call AddFieldTable(tmpDb, "Veh_Order1", "InsComm", dbDouble, 10, False, True, 0)
        Call AddFieldTable(tmpDb, "Veh_Order1", "FinPayOut", dbDouble, 10, False, True, 0)
        Call AddFieldTable(tmpDb, "Veh_Order1", "FinInc", dbDouble, 10, False, True, 0)
        Call AddFieldTable(tmpDb, "Veh_Order1", "EBTA", dbDouble, 10, False, True, 0)
        Call AddFieldTable(tmpDb, "Veh_Order1", "Retail", dbDouble, 10, False, True, 0)
        Call AddFieldTable(tmpDb, "Veh_Order1", "SPInc", dbDouble, 10, False, True, 0)
        Call AddFieldTable(tmpDb, "Veh_Order1", "Brokrage", dbDouble, 10, False, True, 0)
        Call AddFieldTable(tmpDb, "Veh_Order1", "Subvention", dbDouble, 10, False, True, 0)
        Call AddFieldTable(tmpDb, "Veh_Order1", "AmtRecd", dbDouble, 10, False, True, 0)
        
        Call AddFieldTable(tmpDbFA, "Voucher_Type", "DefaultDrAc", dbText, 8, False, True, "")
        Call AddFieldTable(tmpDbFA, "Voucher_Type", "DefaultCrAc", dbText, 8, False, True, "")
        Call AddFieldTable(tmpDbFA, "Voucher_Type", "FirstDrCr", dbText, 8, False, True, "")
        Call AddFieldTable(tmpDbFA, "AcControls", "OthDealerGrp", dbText, 8, False, True, "")
        Call AddFieldTable(tmpDbFA, "AcControls", "FSBCrAc", dbText, 8, False, True, "")
        Call AddFieldTable(tmpDbFA, "AcControls", "FSBOnlinePost", dbByte, 1, False, True, 0)
        Call AddFieldTable(tmpDb, "Estimate1", "ReqNo", dbDouble, 10, False, True, 0)
        Call AddFieldTable(tmpDb, "Job_Card", "LabD_Per", dbDouble, 10, False, True, 0)
        Call AddFieldTable(tmpDb, "Job_Card", "LastInvDocid", dbText, 21, False, True, "")
        Call AddFieldTable(tmpDb, "Job_Card", "LastLabInvDocId", dbText, 21, False, True, "")
        Call AddFieldTable(tmpDb, "Job_Card", "LastInvNoSuff", dbDouble, 10, False, True, 0)
        Call AddFieldTable(tmpDb, "Job_Card", "LastLabInvNoSuff", dbDouble, 10, False, True, 0)
        
        Call AddFieldTable(tmpDb, "SP_Stock", "PurDocNo", dbText, 21, False, True, "")
        Call AddFieldTable(tmpDb, "SP_Stock", "PurDocDate", dbDate, 15, False, True, "")
        Call AddFieldTable(tmpDb, "Job_Card", "JobType", dbText, 1, False, True, "")
        Call AddFieldTable(tmpDb, "Job_Card", "JobType", dbText, 1, False, True, "")
        Call AddFieldTable(tmpDb, "Job_Lab", "JobCode", dbText, 6, False, True, "")
        
        Call AddFieldTable(tmpDb, "Wrk_Details", "HrsPerDay", dbDouble, 2, False, True, 0)
        Call AddFieldTable(tmpDb, "Wrk_Details", "TotAtms", dbDouble, 2, False, True, 0)
        Call AddFieldTable(tmpDb, "Wrk_Details", "WorkRunCost", dbDouble, 10, False, True, 0)
        Call AddFieldTable(tmpDb, "Rect", "DiscAc", dbText, 8, False, True, "")
        Call AddFieldTable(tmpDb, "Rect", "DiscAmt", dbDouble, 10, False, True, 0)
        Call AddFieldTable(tmpDb, "Job_Lab", "Mech_Voice", dbText, 40, False, True, "")
        
        '' Vishal Jain (Dhule Changes)
        Call AddFieldTable(tmpDb, "Job_Booking", "SiebelDocID", dbText, 50, False, True, "")
        Call AddFieldTable(tmpDb, "Job_Booking", "SellingDealerCode", dbText, 10, False, True, "")
        
        Call AddFieldTable(tmpDb, "Job_Card", "SiebelDocID", dbText, 50, False, True, "")
        
        Call AddFieldTable(tmpDb, "Model", "Col_Code", dbText, 4, False, True, "")
        Call AddFieldTable(tmpDb, "Model", "RegulatoryCertificate", dbText, 15, False, True, "")
        Call AddFieldTable(tmpDb, "Model", "SteeringType", dbText, 20, False, True, "")
        Call AddFieldTable(tmpDb, "Model", "Vehicle_Drive", dbText, 6, False, True, "")
        Call AddFieldTable(tmpDb, "Model", "FuelTankCapacity", dbDouble, 2, False, True, 0)
        Call AddFieldTable(tmpDb, "Model", "RearAxleMake", dbText, 30, False, True, "")
        Call AddFieldTable(tmpDb, "Model", "FMSN", dbText, 1, False, True, "")
        Call AddFieldTable(tmpDb, "Model", "CubicCapacity", dbText, 10, False, True, "")
        Call AddFieldTable(tmpDb, "Model", "BodyType", dbText, 25, False, True, "")
        
        Call AddFieldTable(tmpDb, "Rect", "SiebelRectNo", dbText, 30, False, True, "")
        
        Call AddFieldTable(tmpDb, "Sp_Purch", "SiebelDocID", dbText, 30, False, True, "")
        Call AddFieldTable(tmpDb, "Sp_Sale", "SiebelDocID", dbText, 30, False, True, "")
        Call AddFieldTable(tmpDb, "Sp_Stock", "SiebelDocID", dbText, 50, False, True, "")
        
        Call AddFieldTable(tmpDb, "SubGroup", "SiebelCode", dbText, 20, False, True, "")
        Call AddFieldTable(tmpDb, "SubGroupAlias", "SiebelCode", dbText, 20, False, True, "")
        Call AddFieldTable(tmpDbFA, "SubGroup", "SiebelCode", dbText, 20, False, True, "")
        Call AddFieldTable(tmpDbFA, "SubGroupAlias", "SiebelCode", dbText, 20, False, True, "")
        
        Call AddFieldTable(tmpDb, "Veh_Order", "SiebelOrderNo", dbText, 25, False, True, "")
        Call AddFieldTable(tmpDb, "Veh_Order", "SiebelInvoiceNo", dbText, 25, False, True, "")
        
        Call AddFieldTable(tmpDb, "Veh_Order1", "SiebelOrderNo", dbText, 25, False, True, "")
        Call AddFieldTable(tmpDb, "Veh_Order1", "SiebelInvoiceNo", dbText, 25, False, True, "")
        
        Call AddFieldTable(tmpDb, "Syctrl", "SiebelActiveYN", dbByte, 1, False, True, 0)
        Call AddFieldTable(tmpDb, "Service_Type", "RateEditableYN", dbByte, 1, False, True, 0)
        
        
        'New Field Added for storing LSt No Pervious LstNo will now use for Storing TIN No
        Call AddFieldTable(tmpDb, "Division", "LstDate", dbDate, 15, False, True, "")
        Call AddFieldTable(tmpDb, "Division", "LstNo", dbText, 30, False, True, "")
        Call AddFieldTable(tmpDb, "Division", "LstDateV", dbDate, 15, False, True, "")
        Call AddFieldTable(tmpDb, "Division", "LstNoV", dbText, 30, False, True, "")
        Call AddFieldTable(tmpDb, "Division", "LstDateS", dbDate, 15, False, True, "")
        Call AddFieldTable(tmpDb, "Division", "LstNoS", dbText, 30, False, True, "")
        Call AddFieldTable(tmpDb, "Division", "LstDateW", dbDate, 15, False, True, "")
        Call AddFieldTable(tmpDb, "Division", "LstNoW", dbText, 30, False, True, "")
        Call AddFieldTable(tmpDb, "AssociatedFirms", "LstDate", dbDate, 15, False, True, "")
        Call AddFieldTable(tmpDb, "AssociatedFirms", "LstNo", dbText, 30, False, True, "")

        
        Call AddFieldTable(tmpDb, "Job_Demand", "Lab_Rate", dbDouble, 8, False, True, 0)
        Call AddFieldTable(tmpDb, "Job_Demand", "Time_Req", dbDouble, 8, False, True, 0)
        Call AddFieldTable(tmpDb, "Job_Demand", "Amount", dbDouble, 8, False, True, 0)
        Call AddFieldTable(tmpDb, "Job_Card", "TempCloseDate", dbDate, 15, False, True, "")
        Call AddFieldTable(tmpDb, "Syctrl", "TaxOnFreeLabYN", dbByte, 1, False, True, 0)
        
        
        Set tmpDb = Nothing
        Set tmpDbFA = Nothing
        GCn.Open
        
        Set TempRs = GCn.Execute("Select Chassis,Inv_DocId From Veh_Order ")
        If TempRs.RecordCount > 0 Then
            Do Until TempRs.EOF
                GCn.Execute ("Update Veh_Stock Set Sal_DocId='" & XNull(TempRs!Inv_DocId) & "' Where ChassisNo='" & TempRs!Chassis & "' ")
                TempRs.MoveNext
            Loop
        End If
       
            
        'For Upadting Last Purchase DocId And Date
        If MsgBox("Do you want to update Last Invoice No of part for Warranty purpose ? ", vbYesNo) = vbYes Then
            Dim LstPur As ADODB.Recordset, TotalRec As ADODB.Recordset, I As Double
            Set TotalRec = GCn.Execute("Select Distinct Part_No from Sp_Stock")
            If TotalRec.RecordCount > 0 Then
                TotalRec.MoveFirst
                For I = 1 To TotalRec.RecordCount
                    Set LstPur = GCn.Execute("Select SP_Purch.Party_Doc_No,SP_Purch.Party_Doc_Date,SP_Stock.V_rate as Rate,SP_stock.Part_No from SP_Stock Left Join SP_Purch on SP_Stock.DocId=SP_Purch.DOCId where SP_Stock.Part_No='" & TotalRec!Part_No & "' and SP_Stock.V_Type in('SXGR','SXAO') and Left(SP_Stock.DocId,1)='" & PubDivCode & "' order by SP_Purch.Party_Doc_Date DESC")
                    If LstPur.RecordCount > 0 Then
                        LstPur.MoveFirst
                        GCn.Execute ("Update Part Set PurDocId='" & XNull(LstPur!Party_Doc_No) & "', PurDate=" & ConvertDate(LstPur!Party_Doc_Date) & ", PurRate=" & VNull(LstPur!Rate) & " where Part_No ='" & TotalRec!Part_No & "' and Div_Code='" & PubDivCode & "'")
                    End If
                Label1.CAPTION = "Updating Last purchase Invoice No of Part : " & TotalRec!Part_No & "'"
                Label1.Refresh
                TotalRec.MoveNext
                Next
            End If
            Set LstPur = Nothing
        End If
        '*************************************************************************************************
        'For Upadting V_Rate of Opening Stock
        If MsgBox("Do you want to update VRate of opening Stock ? ", vbYesNo) = vbYes Then
            Dim TempVal As Double, mDisPer As Double, TmpRst As ADODB.Recordset
            Set TotalRec = GCn.Execute("Select * from Sp_Stock where V_type='SXAO'")
            For I = 1 To TotalRec.RecordCount
                TempVal = 0: mDisPer = 0
                Set TmpRst = GCn.Execute("Select TP_SRate from Part where Part_No='" & TotalRec!Part_No & "'")
                If TmpRst.RecordCount > 0 Then
                    TempVal = GCn.Execute("Select TP_SRate from Part where Part_No='" & TotalRec!Part_No & "'").Fields(0).Value
                    mDisPer = IIf(IsNull(GCn.Execute("Select Part.Part_No,DF.PurcDisc_Per from Part Left Join Part_DiscFactor DF on Part.Disc_Factor = DF.DiscFac_Catg where Part.Part_No='" & TotalRec!Part_No & "'").Fields(1).Value), 0, GCn.Execute("Select Part.Part_No,DF.PurcDisc_Per from Part Left Join Part_DiscFactor DF on Part.Disc_Factor = DF.DiscFac_Catg where Part.Part_No='" & TotalRec!Part_No & "'").Fields(1).Value)
                    If mDisPer > 0 Then
                         TempVal = Round(TempVal - ((TempVal * mDisPer) / 100), 2)
                    End If
                End If
                Label1.CAPTION = "Updating VRate of Part : " & TotalRec!Part_No & "'"
                Label1.Refresh
                GCn.Execute ("Update SP_Stock set v_Rate=" & TempVal & " where DocId='" & TotalRec!DocID & "' and Part_No='" & TotalRec!Part_No & "'")
                TotalRec.MoveNext
            Next
        End If
        '**********************************************************************************************
        Label1.CAPTION = "Please Wait ! Table Structure Updation in progress....."
        Label1.Refresh
        Set TotalRec = Nothing
        
        GCn.Execute "Alter table Job_Gatepass ALTER COLUMN Purpose TEXT(90)"
        'To update Ladger V_Sno
        G_FaCn.Open
        G_FaCn.Execute "Alter table lEDGER ALTER COLUMN V_SNO INTEGER "
        
        
        
        
        GCn.Execute "ALTER TABLE Veh_Order  ALTER COLUMN Model TEXT(25) NULL DEFAULT " & "" & ""
        GCn.Execute "ALTER TABLE Veh_Purch1  ALTER COLUMN OBNO TEXT(20) NULL DEFAULT " & "" & ""
        GCn.Execute "ALTER TABLE Veh_Quot1  ALTER COLUMN Model TEXT(25) NULL DEFAULT " & "" & ""
        GCn.Execute "ALTER TABLE Model      ALTER COLUMN Model TEXT(25) NULL DEFAULT " & "" & ""
        GCn.Execute "ALTER TABLE Veh_Stock  ALTER COLUMN Model TEXT(25) NULL DEFAULT " & "" & ""
        GCn.Execute "ALTER TABLE HisCard    ALTER COLUMN Model TEXT(25) NULL DEFAULT " & "" & ""
        GCn.Execute "Alter Table Job_Lab Alter Column Lab_Code Text(8) Null Default " & "" & " "
    '        GCn.Execute "ALTER TABLE Model1     ALTER COLUMN Model TEXT(25) NULL DEFAULT " & "" & ""
        
        GCn.Execute "ALTER TABLE Model ALTER COLUMN Vehicle_Type TEXT(25) NULL DEFAULT " & "" & ""
     
        '*************************************************************************************************
    '    Drop Query View SubGroup
        
        'G_FaCn.Execute "Drop view ViewSubGroup"
        '*************************************************************************************************
        
        '*************************************************************************************************
        AddNewFieldForDatamanFa (PubFADataPath)
        '*************************************************************************************************
             
          'For Updation in Data transfer protocol
        GCn.Execute "Update  TableGroupClient set  UserDate='' where Table_Name='SubGroupCounter'"
        GCn.Execute "Update  TableGroupHO set  UserDate='' where Table_Name='SubGroupCounter'"
        '*************************************************************************************************
        GCn.Execute "UPDATE Job_Lab SET Hrs_Taken = val(int(Hrs_Taken)&'.'& ((Hrs_Taken -int(Hrs_Taken))*60))"
        
        'Create New Tables
            CreateNewTable
            
        '*************************************************************************************************
       ' Removing Nulls
            'RemoveNulls
        '*************************************************************************************************
         'Do passwd field of 15 char
    '      G_CompCn.Execute "Alter table UserMast ALTER COLUMN PASSWD TEXT(15)"
        '*************************************************************************************************
        Set TmpRst = G_FaCn.Execute("Select * from Voucher_type where V_Type='W_SAC'")
        If TmpRst.RecordCount = 0 Then
            G_FaCn.Execute ("Insert Into Voucher_Type(Category,NCat,V_Type,Description,Description_Help,Short_Name,Number_Method,Separate_Narr,Common_Narr,Narration,ChqNo,ChqDt,ClgDt,Print_VNo,U_Name,U_EntDt,U_AE) Values " & _
                          "('Workshop','','W_SAC','Workshop Acc Bill Cash','WorksAccBillCa','WkABillCa','Automatic','N','N','N','N','N','','N','" & pubUName & "'," & FaConvertDate(PubLoginDate) & ",'A'" & ")")
            G_FaCn.Execute ("Insert Into Voucher_Prefix(V_Type,Date_From,Date_To,Prefix,Start_Srl_No,Div_CODE) Values ('W_SAC'," & ConvertDate(PubStartDate) & "#," & ConvertDate(PubEndDate) & "#,'W_SAC',900000,'" & PubDivCode & "')")
        End If
        
        Set TmpRst = G_FaCn.Execute("Select * from Voucher_type where V_Type='W_SAR'")
        If TmpRst.RecordCount = 0 Then
            G_FaCn.Execute ("Insert Into Voucher_Type(Category,NCat,V_Type,Description,Description_Help,Short_Name,Number_Method,Separate_Narr,Common_Narr,Narration,ChqNo,ChqDt,ClgDt,Print_VNo,U_Name,U_EntDt,U_AE) Values " & _
                          "('Workshop','','W_SAR','Workshop Acc Bill Credit','WorksAccBillCredit','WkABillCr','Automatic','N','N','N','N','N','','N','" & pubUName & "'," & FaConvertDate(PubLoginDate) & ",'A'" & ")")
            G_FaCn.Execute ("Insert Into Voucher_Prefix(V_Type,Date_From,Date_To,Prefix,Start_Srl_No,Div_CODE) Values ('W_SAR'," & ConvertDate(PubStartDate) & "," & ConvertDate(PubEndDate) & ",'W_SAR',900000,'" & PubDivCode & "')")
        End If
        
        Set TmpRst = G_FaCn.Execute("Select * from Voucher_type where V_Type='W_LAC'")
        If TmpRst.RecordCount = 0 Then
            G_FaCn.Execute ("Insert Into Voucher_Type(Category,NCat,V_Type,Description,Description_Help,Short_Name,Number_Method,Separate_Narr,Common_Narr,Narration,ChqNo,ChqDt,ClgDt,Print_VNo,U_Name,U_EntDt,U_AE) Values " & _
                          "('Workshop','','W_LAC','Workshop Acc Lab Cash','WorksAccLabCash','WkALabCa','Automatic','N','N','N','N','N','','N','" & pubUName & "'," & FaConvertDate(PubLoginDate) & ",'A'" & ")")
            G_FaCn.Execute ("Insert Into Voucher_Prefix(V_Type,Date_From,Date_To,Prefix,Start_Srl_No,Div_CODE) Values ('W_LAC'," & ConvertDate(PubStartDate) & "," & ConvertDate(PubEndDate) & ",'W_LAC',900000,'" & PubDivCode & "')")
        End If
        
        Set TmpRst = G_FaCn.Execute("Select * from Voucher_type where V_Type='W_LAR'")
        If TmpRst.RecordCount = 0 Then
            G_FaCn.Execute ("Insert Into Voucher_Type(Category,NCat,V_Type,Description,Description_Help,Short_Name,Number_Method,Separate_Narr,Common_Narr,Narration,ChqNo,ChqDt,ClgDt,Print_VNo,U_Name,U_EntDt,U_AE) Values " & _
                          "('Workshop','','W_LAR','Workshop Acc Lab Credit','WorksAccLabCredit','WkALabCr','Automatic','N','N','N','N','N','','N','" & pubUName & "'," & FaConvertDate(PubLoginDate) & ",'A'" & ")")
            G_FaCn.Execute ("Insert Into Voucher_Prefix(V_Type,Date_From,Date_To,Prefix,Start_Srl_No,Div_CODE) Values ('W_LAR'," & ConvertDate(PubStartDate) & "," & ConvertDate(PubEndDate) & ",'W_LAR',900000,'" & PubDivCode & "')")
        End If
        
        '*************************************************************************************************
        
        
        
        If UCase(left(PubComp_Name, 10)) = "GANGANAGAR" Then
            GCn.Execute "Delete From [" & PubFADataPath & "].Ledger Where DocId In " & _
                        "(Select DocId From [" & PubFADataPath & "].LedgerM Where V_Type='W_SIR' " & _
                        "And DocId Not In (Select DocId_InvSpr From Job_Card))"
            
            GCn.Execute "(Delete From [" & PubFADataPath & "].LedgerM Where V_Type='W_SIR' " & _
                        "And DocId Not In (Select DocId_InvSpr From Job_Card))"
            
            G_FaCn.Execute "Delete From Ledger Where DocId In ('1SSSYSCTTCJAN  600181', '1SSSYSCTTCJAN  600150')"
            G_FaCn.Execute "Delete From LedgerM Where DocId In ('1SSSYSCTTCJAN  600181', '1SSSYSCTTCJAN  600150')"
        End If
        
        
        
        
        '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        'Adding Records Of Add Edit Delete Permissions Deleted Automatically for FA Forms
        Set RsUser = G_CompCn.Execute("Select User_Name From UserMast")
        If RsUser.RecordCount > 0 Then
            Do Until RsUser.EOF
                If G_CompCn.Execute("Select * From User2 Where User_Name = '" & RsUser!user_name & "' And Module_Name='Account' And Form_Code='FaGrEnt' And Comp_Code = '" & PubCenCompCode & "' And Div_Code = '" & PubDivCode & "'").RecordCount = 0 Then
                    G_CompCn.Execute "Insert Into User2 (User_Name, Module_Name, Form_Code, Param_Str, Comp_Code, Div_Code) " & _
                                   "Values('" & RsUser!user_name & "', 'Account', 'FaGrEnt', 'AEDP', '" & PubCenCompCode & "', '" & PubDivCode & "')"
                End If
                
                If G_CompCn.Execute("Select * From User2 Where User_Name = '" & RsUser!user_name & "' And Module_Name='Account' And Form_Code='frmSubGroup' And Comp_Code = '" & PubCenCompCode & "' And Div_Code = '" & PubDivCode & "'").RecordCount = 0 Then
                    G_CompCn.Execute "Insert Into User2 (User_Name, Module_Name, Form_Code, Param_Str, Comp_Code, Div_Code) " & _
                                   "Values('" & RsUser!user_name & "', 'Account', 'frmSubGroup', 'AEDP', '" & PubCenCompCode & "', '" & PubDivCode & "')"
                End If
                
                If G_CompCn.Execute("Select * From User2 Where User_Name = '" & RsUser!user_name & "' And Module_Name='Account' And Form_Code='FAVRENT' And Comp_Code = '" & PubCenCompCode & "' And Div_Code = '" & PubDivCode & "'").RecordCount = 0 Then
                    G_CompCn.Execute "Insert Into User2 (User_Name, Module_Name, Form_Code, Param_Str, Comp_Code, Div_Code) " & _
                                   "Values('" & RsUser!user_name & "', 'Account', 'FAVRENT', 'AEDP', '" & PubCenCompCode & "', '" & PubDivCode & "')"
                End If
                
                If G_CompCn.Execute("Select * From User2 Where User_Name = '" & RsUser!user_name & "' And Module_Name='Account' And Form_Code='FAVTYPE' And Comp_Code = '" & PubCenCompCode & "' And Div_Code = '" & PubDivCode & "'").RecordCount = 0 Then
                    G_CompCn.Execute "Insert Into User2 (User_Name, Module_Name, Form_Code, Param_Str, Comp_Code, Div_Code) " & _
                                   "Values('" & RsUser!user_name & "', 'Account', 'FAVTYPE', 'AEDP', '" & PubCenCompCode & "', '" & PubDivCode & "')"
                End If
                
                If G_CompCn.Execute("Select * From User2 Where User_Name = '" & RsUser!user_name & "' And Module_Name='Account' And Form_Code='FATDSCAT' And Comp_Code = '" & PubCenCompCode & "' And Div_Code = '" & PubDivCode & "'").RecordCount = 0 Then
                    G_CompCn.Execute "Insert Into User2 (User_Name, Module_Name, Form_Code, Param_Str, Comp_Code, Div_Code) " & _
                                   "Values('" & RsUser!user_name & "', 'Account', 'FATDSCAT', 'AEDP', '" & PubCenCompCode & "', '" & PubDivCode & "')"
                End If
                            
                If G_CompCn.Execute("Select * From User2 Where User_Name = '" & RsUser!user_name & "' And Module_Name='Account' And Form_Code='FATDSCERTIFICATE' And Comp_Code = '" & PubCenCompCode & "' And Div_Code = '" & PubDivCode & "'").RecordCount = 0 Then
                    G_CompCn.Execute "Insert Into User2 (User_Name, Module_Name, Form_Code, Param_Str, Comp_Code, Div_Code) " & _
                                   "Values('" & RsUser!user_name & "', 'Account', 'FATDSCERTIFICATE', 'AEDP', '" & PubCenCompCode & "', '" & PubDivCode & "')"
                End If
                            
                If G_CompCn.Execute("Select * From User2 Where User_Name = '" & RsUser!user_name & "' And Module_Name='Account' And Form_Code='FATDSCHAL' And Comp_Code = '" & PubCenCompCode & "' And Div_Code = '" & PubDivCode & "'").RecordCount = 0 Then
                    G_CompCn.Execute "Insert Into User2 (User_Name, Module_Name, Form_Code, Param_Str, Comp_Code, Div_Code) " & _
                                   "Values('" & RsUser!user_name & "', 'Account', 'FATDSCHAL', 'AEDP', '" & PubCenCompCode & "', '" & PubDivCode & "')"
                End If
                            
                RsUser.MoveNext
            Loop
        End If
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        
        
        
        
        
        GCn.Execute ("Delete * from AcMerge")
        GCn.Execute ("insert into AcMERGE values('SaleTarget','Party_Code','Automan')")
        GCn.Execute ("insert into AcMERGE values('SP_Order','Party_Code','Automan')")
        GCn.Execute ("insert into AcMERGE values('SP_Order1','Party_Code','Automan')")
        GCn.Execute ("insert into AcMERGE values('SP_Purch','Party_Code','Automan')")
        GCn.Execute ("insert into AcMERGE values('SP_Sale','Party_Code','Automan')")
        GCn.Execute ("insert into AcMERGE values('SP_Stock','Party_Code','Automan')")
        GCn.Execute ("insert into AcMERGE values('Veh_Order','PartyCode','Automan')")
        GCn.Execute ("insert into AcMERGE values('Veh_Order1','PartyCode','Automan')")
        GCn.Execute ("insert into AcMERGE values('Veh_Purch1','PartyCode','Automan')")
        
        GCn.Execute ("insert into AcMERGE values('Veh_Stock','PartyCode','Automan')")
        GCn.Execute ("insert into AcMERGE values('Rect','PartyCode','Automan')")
        
        GCn.Execute ("insert into AcMERGE values('Ledger','SubCode','FaDATA')")
        GCn.Execute ("insert into AcMERGE values('LedgerAdj','SubCode','FaDATA')")
        
        GCn.Execute ("insert into AcMERGE values('LedgerRef','SubCode','FaDATA')")
        GCn.Execute ("insert into AcMERGE values('LedgerAdj','SubCode','FaDATA')")
        GCn.Execute ("Update Model set Manufacturer='TATA MOTORS LTD.'")
        
        
        'filling A/C Control TABLE
        Dim fname As String, Val1 As String
        For I = 0 To 52
            fname = G_FaCn.Execute("select * from accontrols").Fields(I).Name
            Val1 = G_FaCn.Execute("select * from accontrols").Fields(I).DefinedSize
            If Val1 = 8 Then
                GCn.Execute ("insert into AcMERGE values('AcControls','" & fname & "','FaDATA')")
            End If
        Next
        For I = 0 To 100
            fname = GCn.Execute("select * from syctrl").Fields(I).Name
            Val1 = GCn.Execute("select * from syctrl").Fields(I).DefinedSize
            If Val1 = 8 Then
                GCn.Execute ("insert into AcMERGE values('syctrl','" & fname & "','Automan')")
            End If
        Next
        
        
        GCn.Execute "Delete From Job_Lab  Where Job_DocId Not In (Select DocId From Job_Card)"
        GCn.Execute "Delete From Job_Lab2 Where Job_DocId Not In (Select DocId From Job_Card)"
        
        GCn.Execute "Delete From Sp_Stock Where Job_DocId Not In (Select DocId From Job_Card) And Job_DocId <> '' And Job_DocId Is Not Null"
        GCn.Execute "Delete From Sp_Sale Where Job_DocId Not In (Select DocId From Job_Card)  And Job_DocId <> '' And Job_DocId Is Not Null"
        
        
        
        If UCase(left(PubComp_Name, 3)) = "JMK" Then
            GCn.Execute "Delete From Part Where Left(Part_No,6)='tinter'"
        End If
    
        GCn.Execute "Update Job_Card Set eCessPer=" & cIIF("Lab_TaxPer=12.24 Or Lab_TaxPer=12.25", "2", "3") & ", eCessAmt=Lab_TaxAmt*" & cIIF("Lab_TaxPer=12.24 Or Lab_TaxPer=12.25", "2", "3") & "/(100+" & cIIF("Lab_TaxPer=12.24 Or Lab_TaxPer=12.25", "2", "3") & ")"
        GCn.Execute "Update Job_Card Set eCessPer=0, eCessAmt=0 where Lab_TaxPer=0"
ElseIf PubBackEnd = "S" Then
    GCn.Execute "Delete from Job_Lab where job_docId not in (select distinct docid from job_card)"
End If
    
    MsgBox "Table Structure Updation completed!" & vbCrLf & "Please reload programme", vbCritical, "Modify Table"
    End
errorbox:
    Set tmpDb = Nothing
    Set tmpDbFA = Nothing
    Set DB = Nothing
    GCn.Open
    G_FaCn.Open
    GCnFaV.Open
    GCnFaS.Open
    GCnFaW.Open
    MsgBox err.Description, vbInformation
    End
End Sub
'End Sub
'End Update

'Nra Updation
Public Sub UpdateQry(DB As DAO.Database, QryName As String, NQry As String)
Dim QDF As QueryDef
    Set QDF = DB.QueryDefs(QryName)
    QDF.SQL = NQry
Myexit:

End Sub
'End Update

Private Sub DelAllTransactions()
If pubUName <> "SA" Then
    MsgBox "Permission Denied !", vbCritical, "Delete Transactions !"
    Exit Sub
End If
If MsgBox("Are You Sure To Delete Transactions from Database ? ", vbYesNo + vbCritical + vbDefaultButton2, "Delete Transactions !") = vbNo Then Exit Sub
If MsgBox("Records will be removed permanentaly, Continue ? ", vbYesNo + vbCritical + vbDefaultButton2, "Delete Transactions-2 !") = vbNo Then Exit Sub

On Error GoTo errorbox
Dim DataPath$, DataPathFa$
Dim DB As DAO.Database, I As Integer, mTrans As Boolean
Dim fob As New FileSystemObject

DataPath = Pub_DataPath & "\Auto_" & PubCenCompCode & "\Automan.mdb"
DataPathFa = PubFADataPath
'dbBinInt,dbBoolean,dbByte,dbDate,dbDecimal,dbDouble,dbFloat
'dbInteger,dbMemo,dbNumeric,dbSingle,dbText,dbTime,dbTimestamp

    'Checking for Exclusive mode
'    GCn.Close
'    G_FaCn.Close
'    GCnFaV.Close
'    GCnFaS.Close
'    GCnFaW.Close
'
'    Dim tmpDb As DAO.Database
'    Set tmpDb = OpenDatabase(DataPath, True, False, ";pwd=dtman")
'
'    Dim tmpDbFA As DAO.Database
'    Set tmpDbFA = OpenDatabase(DataPathFa, True, False)
'
'    Close #1
'    If Fob.FileExists("C:\RepPrint.Txt") = False Then
'        Fob.CreateTextFile ("C:\TableName.Txt")
'    End If
'    Close #1
'    Open "C:\TableName.Txt" For Output As #1
'    For I = 0 To tmpDb.TableDefs.Count - 1
'        Print #1, tmpDb.TableDefs(I).Name
'    Next
'    Print #1, "FA Tables"
'    For I = 0 To tmpDbFA.TableDefs.Count - 1
'        Print #1, tmpDbFA.TableDefs(I).Name
'    Next
'
'    Close #1
'    Set tmpDb = Nothing
'    Set tmpDbFA = Nothing
'    GCn.Open
'    G_FaCn.Open
'    GCnFaV.Open
'    GCnFaS.Open
'    GCnFaW.Open
    '*******************
GCn.BeginTrans
G_FaCn.BeginTrans

GCn.Execute ("Delete from Estimate")
GCn.Execute ("Delete from Estimate1")
GCn.Execute ("Delete from Indent")
GCn.Execute ("Delete from Job_Booking")
GCn.Execute ("Delete from Job_Card")
GCn.Execute ("Delete from Job_Card2")
GCn.Execute ("Delete from Job_Demand")
GCn.Execute ("Delete from Job_GatePass")
GCn.Execute ("Delete from Job_Inspection")
GCn.Execute ("Delete from Job_Inspection2")
GCn.Execute ("Delete from Job_Lab")
GCn.Execute ("Delete from Job_Lab2")
GCn.Execute ("Delete from Job_WarBill")
GCn.Execute ("Delete from Job_Warr1")
GCn.Execute ("Delete from Job_Warr2")
GCn.Execute ("Delete from OverTime")
GCn.Execute ("Delete from Part_Import")
GCn.Execute ("Delete from Part_PriceList")
GCn.Execute ("Delete from PartList_New")
GCn.Execute ("Delete from Rect")
GCn.Execute ("Delete from SP_Order")
GCn.Execute ("Delete from SP_Order1")
GCn.Execute ("Delete from SP_Purch")
GCn.Execute ("Delete from SP_Sale")
GCn.Execute ("Delete from SP_Stock")

'Fa Tables
G_FaCn.Execute ("Delete from Ledger")
G_FaCn.Execute ("Delete from LedgerAdj")
G_FaCn.Execute ("Delete from LedgerM")
G_FaCn.Execute ("Update VehBill_Counter set Start_Srl_No=0")
G_FaCn.Execute ("Update Voucher_Prefix set Start_Srl_No=0")

GCn.CommitTrans
G_FaCn.CommitTrans

    MsgBox "All Transactions from Database removed sucessfully" & vbCrLf & "Please reload programme", vbCritical, "Delete Transactions"
    End
errorbox:
'    Set tmpDb = Nothing
'    Set tmpDbFA = Nothing
    Set DB = Nothing
    If mTrans Then GCn.RollbackTrans
    If mTrans Then G_FaCn.RollbackTrans
    MsgBox err.Description, vbInformation
    End

End Sub
Private Sub RemoveNulls()
On Error GoTo errorbox
Dim Conn As ADODB.Connection, aaaa As String, J As Integer, DataPath$, tmpDb1 As DAO.Database, N As Integer, I As Integer
Dim tmprs As DAO.Recordset, TDF As DAO.TableDef, FLD As DAO.Field
For I = 1 To 2
    If I = 1 Then
        DataPath = Pub_DataPath & "\Auto_01\Automan.Mdb"
    Else
        DataPath = PubFADataPath
    End If
    Set tmpDb1 = DBEngine.OpenDatabase(DataPath, False, False, ";pwd=dtman")
    For J = 0 To tmpDb1.TableDefs.Count - 1
        If InStr(1, UCase(tmpDb1.TableDefs(J).Name), "SYS") = 0 And InStr(1, UCase(tmpDb1.TableDefs(J).Name), "~") = 0 And InStr(1, tmpDb1.TableDefs(J).Name, "Paste Errors") = 0 Then
            Set TDF = tmpDb1.TableDefs(tmpDb1.TableDefs(J).Name)
            For N = 0 To TDF.Fields.Count - 1
                Set FLD = TDF.Fields(N)
                If (FLD.Type = dbText Or FLD.Type = 0) Then
                    If FLD.DefaultValue = "" Then FLD.DefaultValue = """"""
                    tmpDb1.Execute "Update " & TDF.Name & " set " & TDF.Fields(N).Name & " = '' where " & TDF.Fields(N).Name & " is null"
                ElseIf (FLD.Type = dbNumeric Or FLD.Type = dbSingle Or FLD.Type = dbDouble Or FLD.Type = dbLong) Then
                    If FLD.DefaultValue = "" Then FLD.DefaultValue = 0
                    tmpDb1.Execute "Update " & TDF.Name & " set " & TDF.Fields(N).Name & " = 0 where " & TDF.Fields(N).Name & " is null"
                End If
errorbox:
            Next
        End If
    Next
    Set tmpDb1 = Nothing
    Set tmprs = Nothing
Next

''errorbox:
''    If err.NUMBER = 3343 Then
''        MsgBox "Database is currupt or not a Database file"
''    Else
''        MsgBox err.Description, vbInformation
''    End If
End Sub
Public Sub DataBackup()
Dim oZip As CGZipFiles, ZipDrive As String, ZipFile$
Dim oUnZip As CGUnzipFiles
Dim DB1 As DAO.Database
On Error GoTo disperr


ZipFile = Trim("Auto_" & PubCenCompCode & "-" & Format(Now(), "dd") & Format(Now(), "mm") & Format(Now(), "yy"))
  'Database Backup
            '****
           ' Dim DB1 As DAO.Database
            'Checking for Exclusive mode
            If GCn.State = 1 Then GCn.Close
            Set DB1 = OpenDatabase(Pub_DataPath & "\Auto_" & PubCenCompCode & "\Automan.mdb", True, False, ";pwd=dtman")
            Set DB1 = Nothing
            GCn.Open
            '****
            Picture1.Visible = True
            Label1.CAPTION = "Please wait (" & ZipFile & ") Backup being Process..."
            Set oZip = New CGZipFiles
            With oZip
                ' Give Zip File a Name / Path
                .ZipFileName = PubBkpPath & "\" & ZipFile & ".ZIP"
                ' Are we updating a Zip File ?
                ' - This doesn't seem to work -
                .UpdatingZip = False ' ensures a new zip is created
                .RootDirectory = mID(Pub_DataPath, 1, Len(Pub_DataPath) - 4)
                .AddFile Pub_DataPath & "\Auto_" & PubCenCompCode & "\Automan.mdb"
                
                Set GRs = GCn.Execute("select FADataPath from AssociatedFirms")
                
                While Not GRs.EOF
                    .AddFile Pub_DataPath & "\" & GRs!FADataPath & "\FaData.mdb"
                    GRs.MoveNext
                Wend
                ' Make the zip file & display any errors
                If .MakeZipFile <> 0 Then
                    MsgBox .GetLastMessage ' any errors
                    Picture1.Visible = False
                    Exit Sub
                Else
                    Picture1.Visible = False
                    MsgBox ZipFile & ".ZIP Created Successfully", vbInformation, "Information"
                End If
            End With
            Set oZip = Nothing
Exit Sub
disperr:
    MsgBox err.Description & " In DataBackUp Procedure"
    
End Sub

Private Function CreateNewTable()
On Error GoTo LblErr
    Dim Cat As New ADOX.Catalog, PubDatamanFa As New DMFa.ClsFa, Rough As Boolean
    Cat.ActiveConnection = "Provider=Microsoft.Jet.OLEDB.4.0;Jet OLEDB:Database Password=dtman;Data Source=" & Pub_DataPath & "\" & PubCenDataPath & "\Automan.Mdb"
    PubDatamanFa.FaBackEnd = PubBackEnd

'Creating RepeatJob Table
    'Creating A/C MERZE Table
    Rough = PubDatamanFa.SanFaCreateTable(Cat, "AcMERGE")
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "AcMERGE", "Table", adWChar, 50, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "AcMERGE", "FldName", adWChar, 50, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "AcMERGE", "Database", adWChar, 50, False, "", True)

    Rough = PubDatamanFa.SanFaCreateTable(Cat, "RepeatJob")
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "RepeatJob", "Job_DocId", adWChar, 21, True, "", False)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "RepeatJob", "JobNo", adDouble, 8, True, 0, False)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "RepeatJob", "Job_Date", adDate, , True, "", False)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "RepeatJob", "RegNo", adWChar, 14, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "RepeatJob", "Mech", adWChar, 40, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "RepeatJob", "PrvJobNo", adDouble, 8, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "RepeatJob", "PrvJobDate", adDate, , False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "RepeatJob", "Comp_Name", adWChar, 40, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "RepeatJob", "Batch_Code", adWChar, 25, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "RepeatJob", "Make", adWChar, 20, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "RepeatJob", "Ord_Placed", adInteger, 1, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "RepeatJob", "Cust_Informed", adInteger, 1, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "RepeatJob", "Imp_Date1", adDate, , False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "RepeatJob", "Imp_Date2", adDate, , False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "RepeatJob", "Imp_Date3", adDate, , False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "RepeatJob", "Imp_Date4", adDate, , False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "RepeatJob", "Imp_Date5", adDate, , False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "RepeatJob", "Imp_Date6", adDate, , False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "RepeatJob", "U_Name", adWChar, 15, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "RepeatJob", "U_EntDt", adDate, , False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "RepeatJob", "U_AE", adWChar, 1, False, "", True)
    Rough = PubDatamanFa.SanFaCreateIndex(Cat, "RepeatJob", "PrimaryKey", True, True, adIndexNullsDisallow, "Job_DocId")
    
    
    'Creating CustFeedBack Table
    Rough = PubDatamanFa.SanFaCreateTable(Cat, "CustFeedback")
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustFeedback", "Job_DocId", adWChar, 21, True, "", False)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustFeedback", "Parameter1", adDouble, 2, False, 0, False)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustFeedback", "Parameter2", adDouble, 2, False, 0, False)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustFeedback", "Parameter3", adDouble, 2, False, 0, False)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustFeedback", "Parameter4", adDouble, 2, False, 0, False)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustFeedback", "Parameter5", adDouble, 2, False, 0, False)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustFeedback", "Parameter6", adDouble, 2, False, 0, False)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustFeedback", "Parameter7", adDouble, 2, False, 0, False)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustFeedback", "Parameter8", adDouble, 2, False, 0, False)
    
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustFeedback", "Point1", adDouble, 2, False, 0, False)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustFeedback", "Point2", adDouble, 2, False, 0, False)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustFeedback", "Point3", adDouble, 2, False, 0, False)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustFeedback", "Point4", adDouble, 2, False, 0, False)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustFeedback", "Point5", adDouble, 2, False, 0, False)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustFeedback", "Point6", adDouble, 2, False, 0, False)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustFeedback", "Point7", adDouble, 2, False, 0, False)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustFeedback", "Point8", adDouble, 2, False, 0, False)
    
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustFeedback", "FeedbackStat", adWChar, 20, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustFeedback", "NxtVisit", adWChar, 50, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustFeedback", "CompNature", adWChar, 50, False, "", True)
    
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustFeedback", "U_Name", adWChar, 15, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustFeedback", "U_EntDt", adDate, , False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustFeedback", "U_AE", adWChar, 1, False, "", True)
    Rough = PubDatamanFa.SanFaCreateIndex(Cat, "CustFeedback", "PrimaryKey", True, True, adIndexNullsDisallow, "Job_DocId")
    
    'Creating CustInfo Table
    Rough = PubDatamanFa.SanFaCreateTable(Cat, "CustInfo")
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "Cust_Code", adDouble, 8, True, 0, False)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "Cust_Name", adWChar, 40, True, "", False)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "Add1", adWChar, 40, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "Add2", adWChar, 40, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "Add3", adWChar, 40, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "City", adWChar, 20, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "Pin", adDouble, 6, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "State", adWChar, 20, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "PhoneO", adWChar, 30, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "PhoneR", adWChar, 30, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "Mobile", adWChar, 15, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "Fax", adWChar, 30, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "EMail", adWChar, 30, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "PCY_N", adInteger, 1, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "Sex", adWChar, 6, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "MState", adWChar, 6, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "NoOfChild", adDouble, 2, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "BDate", adDate, , False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "WDate", adDate, , False, "", True)
    
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "MTounge", adWChar, 20, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "Ugrd", adInteger, 1, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "Grd", adInteger, 1, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "Pgrd", adInteger, 1, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "OthEdu", adWChar, 20, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "Salaried", adInteger, 1, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "Businessman", adInteger, 1, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "Retired", adInteger, 1, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "Student", adInteger, 1, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "Housewife", adInteger, 1, False, 0, True)
    
    
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "OthMod1", adWChar, 20, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "OthMod2", adWChar, 20, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "ModPur1Dt", adDate, , False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "ModPur2Dt", adDate, , False, "", True)
    
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "Self", adInteger, 1, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "Driver", adInteger, 1, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "Both1", adInteger, 1, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "AuthWorkshop", adInteger, 1, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "OtherWorkshop", adInteger, 1, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "AvgDist1", adInteger, 1, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "AvgDist2", adInteger, 1, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "AvgDist3", adInteger, 1, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "AvgDist4", adInteger, 1, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "Citibank", adInteger, 1, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "HDFC", adInteger, 1, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "ICICI", adInteger, 1, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "HSBC", adInteger, 1, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "SBI", adInteger, 1, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "Diners", adInteger, 1, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "Stanchart", adInteger, 1, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "Amex", adInteger, 1, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "BOB", adInteger, 1, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "OtherBank", adWChar, 20, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "IA", adInteger, 1, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "Jet", adInteger, 1, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "Sahara", adInteger, 1, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "OtherAir", adWChar, 50, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "TravelRelated", adInteger, 1, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "LifeRelated", adInteger, 1, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "Entertainment", adInteger, 1, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "Parsonal", adInteger, 1, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "CarRelated", adInteger, 1, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "OtherInterest", adWChar, 20, False, "", True)
    
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "DInv_No", adDouble, 8, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "DInv_Date", adDate, , False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "Model", adWChar, 15, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "Varient", adWChar, 10, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "RegNo", adWChar, 14, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "Color", adWChar, 20, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "Chassis", adWChar, 15, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "CEligibility", adWChar, 200, False, "", True)
    
    
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "U_Name", adWChar, 15, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "U_EntDt", adDate, , False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "CustInfo", "U_AE", adWChar, 1, False, "", True)
    Rough = PubDatamanFa.SanFaCreateIndex(Cat, "CustInfo", "PrimaryKey", True, True, adIndexNullsDisallow, "Cust_Code")
    
    
    'Creating VEH_CustConcn Table
    Rough = PubDatamanFa.SanFaCreateTable(Cat, "VEH_CustConcn")
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_CustConcn", "Sl_No", adDouble, 8, True, 0, False)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_CustConcn", "VDate", adDate, , False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_CustConcn", "Cust_Name", adWChar, 50, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_CustConcn", "Cust_add1", adWChar, 50, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_CustConcn", "Cust_add2", adWChar, 50, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_CustConcn", "Tel_R", adDouble, 10, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_CustConcn", "Tel_O", adDouble, 10, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_CustConcn", "Mobile", adDouble, 15, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_CustConcn", "VehModel", adWChar, 15, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_CustConcn", "Concern", adWChar, 250, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_CustConcn", "Received_By", adWChar, 25, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_CustConcn", "Imm_Act_Taken1", adWChar, 50, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_CustConcn", "Imm_Act_Taken2", adWChar, 50, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_CustConcn", "Root_Cause_Analysis1", adWChar, 50, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_CustConcn", "Root_Cause_Analysis2", adWChar, 50, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_CustConcn", "Pre_Action1", adWChar, 50, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_CustConcn", "Pre_Action2", adWChar, 50, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_CustConcn", "Remarks", adWChar, 250, False, "", True)
    
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_CustConcn", "U_Name", adWChar, 15, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_CustConcn", "U_EntDt", adDate, , False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_CustConcn", "U_AE", adWChar, 1, False, "", True)
    Rough = PubDatamanFa.SanFaCreateIndex(Cat, "VEH_CustConcn", "PrimaryKey", True, True, adIndexNullsDisallow, "Sl_No")
    
    'Creating VEH_MargineStatistics Table
    Rough = PubDatamanFa.SanFaCreateTable(Cat, "VEH_Margin")
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "Sl_No", adDouble, 8, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "CustName", adWChar, 50, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "SPerson", adWChar, 50, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "FinCode", adWChar, 8, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "FinAmt", adDouble, 6, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "SalInv", adWChar, 8, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "Model", adWChar, 15, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "VehPriceAP", adDouble, 6, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "VehPriceAR", adDouble, 6, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "RegChrgAP", adDouble, 6, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "RegChrgAR", adDouble, 6, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "SPNoChrgAP", adDouble, 6, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "SPNoChrgAR", adDouble, 6, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "AffiChrgAP", adDouble, 6, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "AffiChrgAR", adDouble, 6, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "InsuChrgAP", adDouble, 6, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "InsuChrgAR", adDouble, 6, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "EWPChrgAP", adDouble, 6, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "EWPChrgAR", adDouble, 6, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "AccessoriesAP", adDouble, 6, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "AccessoriesAR", adDouble, 6, False, 0, True)
    
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "TotalAP", adDouble, 6, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "TotalAR", adDouble, 6, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "ExcessAP", adDouble, 6, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "ExcessAR", adDouble, 6, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "ShortageAP", adDouble, 6, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "ShortageAR", adDouble, 6, False, 0, True)
    
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "AdjBill1", adWChar, 50, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "AdjBill2", adWChar, 50, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "AdjBill3", adWChar, 50, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "AdjBill1STot", adDouble, 6, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "AdjBill1Tot", adDouble, 6, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "AdjBill2STot", adDouble, 6, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "AdjBill2Tot", adDouble, 6, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "AdjBill3STot", adDouble, 6, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "AdjBill3Tot", adDouble, 6, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "AdjBillSTotal", adDouble, 6, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "AdjBillTotal", adDouble, 6, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "AdjBillBalSTot", adDouble, 6, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "AdjBillBalTot", adDouble, 6, False, 0, True)
    
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "AdjVehCostAA", adDouble, 6, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "AdjVehCostAP", adDouble, 6, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "AdjRegChrgAA", adDouble, 6, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "AdjRegChrgAP", adDouble, 6, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "CashPayAA", adDouble, 6, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "CashPayAP", adDouble, 6, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "FitmentAA", adDouble, 6, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "FitmentAP", adDouble, 6, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "DMAAA", adDouble, 6, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "DMAAP", adDouble, 6, False, 0, True)
    
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "DisTotalAA", adDouble, 6, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "DisTotalAP", adDouble, 6, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "DisBalAA", adDouble, 6, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "DisBalAP", adDouble, 6, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "MrgVeh", adDouble, 6, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "MrgRegn", adDouble, 6, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "CorpInc", adDouble, 6, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "FinIncentive", adDouble, 6, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "MrgSplNo", adDouble, 6, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "PurIncentive", adDouble, 6, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "InventCost", adDouble, 6, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "Petrol", adDouble, 6, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "Discount", adDouble, 6, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "Misc", adDouble, 6, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "RTO", adDouble, 6, False, 0, True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "NetMrg", adDouble, 6, False, 0, True)
    
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "U_Name", adWChar, 15, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "U_EntDt", adDate, , False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "VEH_Margin", "U_AE", adWChar, 1, False, "", True)
    Rough = PubDatamanFa.SanFaCreateIndex(Cat, "VEH_Margin", "PrimaryKey", True, True, adIndexNullsDisallow, "Sl_No")
    
    'Creating Warrenty Complaint Master Table
    Rough = PubDatamanFa.SanFaCreateTable(Cat, "WarrCompMast")
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "WarrCompMast", "Code", adWChar, 3, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "WarrCompMast", "Description", adWChar, 50, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "WarrCompMast", "U_Name", adWChar, 15, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "WarrCompMast", "U_EntDt", adDate, , False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "WarrCompMast", "U_AE", adWChar, 1, False, "", True)
    Rough = PubDatamanFa.SanFaCreateIndex(Cat, "WarrCompMast", "PrimaryKey", True, True, adIndexNullsDisallow, "Code")
    
    'Creating Warranty Failure Master Table
    Rough = PubDatamanFa.SanFaCreateTable(Cat, "WarrFailMast")
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "WarrFailMast", "Code", adWChar, 7, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "WarrFailMast", "Description", adWChar, 50, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "WarrFailMast", "U_Name", adWChar, 15, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "WarrFailMast", "U_EntDt", adDate, , False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "WarrFailMast", "U_AE", adWChar, 1, False, "", True)
    Rough = PubDatamanFa.SanFaCreateIndex(Cat, "WarrFailMast", "PrimaryKey", True, True, adIndexNullsDisallow, "Code")
    
    'Creating Warranty Make Master Table
    Rough = PubDatamanFa.SanFaCreateTable(Cat, "WarrMakeMast")
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "WarrMakeMast", "Code", adWChar, 6, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "WarrMakeMast", "Description", adWChar, 50, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "WarrMakeMast", "U_Name", adWChar, 15, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "WarrMakeMast", "U_EntDt", adDate, , False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "WarrMakeMast", "U_AE", adWChar, 1, False, "", True)
    Rough = PubDatamanFa.SanFaCreateIndex(Cat, "WarrMakeMast", "PrimaryKey", True, True, adIndexNullsDisallow, "Code")
    
    'Creating Warranty Job Master Table
    Rough = PubDatamanFa.SanFaCreateTable(Cat, "WarrJobMast")
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "WarrJobMast", "Code", adWChar, 6, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "WarrJobMast", "Description", adWChar, 50, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "WarrJobMast", "U_Name", adWChar, 15, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "WarrJobMast", "U_EntDt", adDate, , False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "WarrJobMast", "U_AE", adWChar, 1, False, "", True)
    Rough = PubDatamanFa.SanFaCreateIndex(Cat, "WarrJobMast", "PrimaryKey", True, True, adIndexNullsDisallow, "Code")
    
    Rough = PubDatamanFa.SanFaCreateTable(Cat, "DeleteLog")
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "DeleteLog", "DocId", adWChar, 21, True, "")
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "DeleteLog", "CancelCount", adDouble, 50, False, 0)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "DeleteLog", "Bill_Amt", adDouble, 10, False, 0)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "DeleteLog", "User_Name", adWChar, 50, False, "")
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "DeleteLog", "Del_Date", adDate, 50, False, "")
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "DeleteLog", "Del_Time", adWChar, 20, False, "")
        
        
    Rough = PubDatamanFa.SanFaCreateTable(Cat, "Lab_Trouble")
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "Lab_Trouble", "Srl", adDouble, 8, True, 0)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "Lab_Trouble", "Lab_Code", adWChar, 8, True, "")
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "Lab_Trouble", "CCCode", adWChar, 6, True, "")
        
    
    
    
    'Creating Subvention Table
    Rough = PubDatamanFa.SanFaCreateTable(Cat, "Subvention")
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "Subvention", "SchemeNo", adWChar, 20, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "Subvention", "FromDate", adDate, , False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "Subvention", "ToDate", adDate, , False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "Subvention", "ModelGroup", adWChar, 5, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "Subvention", "Model", adWChar, 24, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "Subvention", "DealerContribution", adDouble, 10, False, 0)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "Subvention", "TataContribution", adDouble, 10, False, 0)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "Subvention", "TotalSubvention", adDouble, 10, False, 0)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "Subvention", "U_Name", adWChar, 15, False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "Subvention", "U_EntDt", adDate, , False, "", True)
    Rough = PubDatamanFa.SanFaCreatFields(Cat, "Subvention", "U_AE", adWChar, 1, False, "", True)
    Rough = PubDatamanFa.SanFaCreateIndex(Cat, "Subvention", "PrimaryKey", True, True, adIndexNullsDisallow, "SchemeNo")
    
    Set PubDatamanFa = Nothing
    Set Cat = Nothing
' Creating Veh_Order1
    Exit Function
LblErr:
'    If Err.NUMBER = "-2147217900" Then
'        CreateNewTable = 1
'    Else
        CheckError
'        CreateNewTable = 0
'    End If
End Function



'FUNCTION MODIFIED BY ASHISH GUPTA 5-APR-07
''Private Function UpdateBalance()
''On Error GoTo DispErr
''Dim K As Integer, MRPYN As Integer
''Dim Condstr$, SourcePath$, DocID$, mQRY$, sQry$, mOldPath$
''Dim RsSprStkOld As ADODB.Recordset, RsQtyRec As ADODB.Recordset
''Dim GCN1 As ADODB.Connection
''Dim PBIncrVal As Long
''Dim Counter As Long
''Dim TempStock As Double, TempAmount As Double
''Dim MyPart_No, MyTax_YN, MyMRP_YN, MyDiv_Code, MyEof As Byte
''Dim RstVeh_Stk As ADODB.Recordset
''Dim RstVeh_Stk1 As ADODB.Recordset
''Dim RstVeh_Pur As ADODB.Recordset
''Dim RstVeh_Pur1 As ADODB.Recordset
''Dim I As Long
''Dim Found As Boolean
'''TAKE BACKUP
''
''If UCase(left(PubComp_Name, 3)) <> "JMK" And PubBackEnd = "A" Then DataBackup
''
'''UPDATING SP_STOCK TABLE
''    If UCase(left(PubComp_Name, 3)) <> "JMK" Then
''        mOldPath = G_CompCn.Execute("Select OldPath from Company where CentralData_Path='" & PubCenDataPath & "'").Fields(0).Value
''        SourcePath = Pub_DataPath & "\" & mOldPath    'G_CompCn.Execute("Select OldPath from Company where CentralData_Path='" & PubCenDataPath & "'").Fields(0).Value
''    Else
''        SourcePath = Pub_DataPath & "\Auto_03\Automan.mdb"
''    End If
''
''    Set GCN1 = New ADODB.Connection
''    With GCN1
''        .CursorLocation = adUseClient
''        If PubBackEnd = "A" Then
''            .Provider = "Microsoft.Jet.OLEDB.4.0"
''            .ConnectionString = "Data Source=" & SourcePath & ";Persist Security Info=False;Jet OLEDB:Database Password=dtman"
''        Else
''            .Provider = "Provider=SQLOLEDB.1"
''            .ConnectionString = "Persist Security Info=False;User ID=sa;Initial Catalog=" & mOldPath & ";Data Source=" & PubServerName
''        End If
''
''        .Open
''        .BeginTrans
''    End With
''
''
''
''
''    GCn.BeginTrans
''
''        GCn.Execute ("Delete from SP_Stock where V_Type='SXAO'")
''        sQry = " (Select PurRate From Part Where Part.Part_No = SS.Part_No And Part.Div_Code = Left(SS.DocId,1)) "
''        Condstr = " And SS.V_Type='SXAO' and SS.V_Date = " & ConvertDate(Format(DateAdd("YYYY", -2, PubEndDate), "dd/MMM/yyyy")) & "  "
''                        mQRY = " Select Left(SS.DocId,1) as Div_Code, SS.Part_No,Sum(SS.Qty_Rec) - Sum(SS.Qty_Iss)+Sum(SS.Qty_Ret) as mQty," & _
''                                                "1 as Tax_YN, 1 as MRP_YN, " & sQry & " as mRate, mQty*mRate as Amount, Max(SS.V_Rate) as V_Rate " & _
''                                       " From Sp_Stock SS  " & _
''                                       " Where Tax_YN=1 And MRP_YN=1 and SS.V_Date >= " & ConvertDate(Format(DateAdd("YYYY", -1, PubStartDate), "dd/MMM/yyyy")) & " " & _
''                                       " Group By SS.Part_No,SS.Tax_YN,SS.MRP_YN,Left(SS.DocId,1) " & _
''                                       " Union All " & _
''                                       " Select Left(SS.DocId,1) as Div_Code, SS.Part_No, Sum(SS.Qty_Rec) as mQty," & _
''                                                "1 as Tax_YN, 1 as MRP_YN,  " & sQry & " as mRate, Amount, SS.V_Rate as V_Rate " & _
''                                       " From (Sp_Stock SS Left Join Sp_Purch On SS.DocId =  Sp_Purch.DocId) " & _
''                                       " Where Tax_YN=1 And MRP_YN=1 " & Condstr & " " & _
''                                       " Group By SS.Part_No,SS.Tax_YN,SS.MRP_YN,Left(SS.DocId,1),Amount,SS.V_Rate "
''                        mQRY = mQRY & " Union All " & _
''                                       " Select Left(SS.DocId,1) as Div_Code, SS.Part_No,Sum(SS.Qty_Rec)-Sum(SS.Qty_Iss)+Sum(SS.Qty_Ret)  as mQty," & _
''                                                 "1 as Tax_YN, 0 as MRP_YN,  " & sQry & "  as mRate, mQty*mRate as Amount, Max(SS.V_Rate) as V_Rate " & _
''                                       " From Sp_Stock SS " & _
''                                       " Where Tax_YN=1 And MRP_YN=0 and SS.V_Date >= " & ConvertDate(Format(DateAdd("YYYY", -1, PubStartDate), "dd/MMM/yyyy")) & " " & _
''                                       " Group By SS.Part_No,SS.Tax_YN,SS.MRP_YN,Left(SS.DocId,1) " & _
''                                       " Union All " & _
''                                       " Select Left(SS.DocId,1) as Div_Code, SS.Part_No,Sum(SS.Qty_Rec)  as mQty," & _
''                                                 "1 as Tax_YN, 0 as MRP_YN, " & sQry & "  as mRate, Amount, SS.V_Rate as V_Rate " & _
''                                       " From (Sp_Stock SS Left Join Sp_Purch On SS.DocId =  Sp_Purch.DocId) " & _
''                                       " Where Tax_YN=1 And MRP_YN=0  " & Condstr & "" & _
''                                       " Group By SS.Part_No,SS.Tax_YN,SS.MRP_YN,Left(SS.DocId,1),Amount,SS.V_Rate "
''
''                        mQRY = mQRY & " Union All " & _
''                                       " Select Left(SS.DocId,1) as Div_Code, SS.Part_No,Sum(SS.Qty_Rec)-Sum(SS.Qty_Iss)+Sum(SS.Qty_Ret)  as mQty, " & _
''                                                 "0 as Tax_YN, 1 as MRP_YN,  " & sQry & "  as mRate, mQty*mRate as Amount, Max(SS.V_Rate) as V_Rate " & _
''                                       " From Sp_Stock SS " & _
''                                       " Where Tax_YN=0 And MRP_YN=1 and SS.V_Date >= " & ConvertDate(Format(DateAdd("YYYY", -1, PubStartDate), "dd/MMM/yyyy")) & " " & _
''                                       " Group By SS.Part_No,SS.Tax_YN,SS.MRP_YN,Left(SS.DocId,1) " & _
''                                       " Union All " & _
''                                       " Select Left(SS.DocId,1) as Div_Code, SS.Part_No, Sum(SS.Qty_Rec) as mQty, " & _
''                                                 "0 as Tax_YN, 1 as MRP_YN,  " & sQry & " as mRate, Amount, SS.V_Rate as V_Rate " & _
''                                       " From (Sp_Stock SS Left Join Sp_Purch On SS.DocId =  Sp_Purch.DocId) " & _
''                                       " Where Tax_YN=0 And MRP_YN=1 " & Condstr & "" & _
''                                       " Group By SS.Part_No,SS.Tax_YN,SS.MRP_YN,Left(SS.DocId,1),Amount,SS.V_Rate "
''
''                        mQRY = mQRY & " Union All " & _
''                                       " Select Left(SS.DocId,1) as Div_Code, SS.Part_No,Sum(SS.Qty_Rec) - Sum(SS.Qty_Iss)+Sum(SS.Qty_Ret)  as mQty, " & _
''                                                 "0 as Tax_YN, 0 as MRP_YN,  " & sQry & "  as mRate, mQty*mRate as Amount, Max(SS.V_Rate) as V_Rate " & _
''                                       " From Sp_Stock SS " & _
''                                       " Where Tax_YN=0 And MRP_YN=0  and SS.V_Date >= " & ConvertDate(Format(DateAdd("YYYY", -1, PubStartDate), "dd/MMM/yyyy")) & " " & _
''                                       " Group By SS.Part_No,SS.Tax_YN,SS.MRP_YN,Left(SS.DocId,1) " & _
''                                       " Union All " & _
''                                       " Select Left(SS.DocId,1) as Div_Code, SS.Part_No,Sum(SS.Qty_Rec) as mQty, " & _
''                                                 "0 as Tax_YN, 0 as MRP_YN,  " & sQry & " as mRate, Amount, SS.V_Rate as V_Rate " & _
''                                       " From (Sp_Stock SS Left Join Sp_Purch On SS.DocId = Sp_Purch.DocId) " & _
''                                       " Where Tax_YN=0 And MRP_YN=0 " & Condstr & "" & _
''                                       " Group By SS.Part_No,SS.Tax_YN,SS.MRP_YN,Left(SS.DocId,1),Amount,SS.V_Rate  "
''                        mQRY = mQRY & "Order By SS.Part_No,Tax_YN,MRP_YN,Div_Code"
''
''        Set RsSprStkOld = GCN1.Execute(mQRY)
''        TempStock = 0
''        MyEof = 0
''        If RsSprStkOld.RecordCount > 0 Then
''            PBIncrVal = RsSprStkOld.RecordCount / 100
''
''            MyPart_No = RsSprStkOld!Part_No
''            MyTax_YN = RsSprStkOld!Tax_YN
''            MyMRP_YN = RsSprStkOld!MRP_YN
''            MyDiv_Code = RsSprStkOld!Div_Code
''            TempStock = 0
''            TempAmount = 0
''
''            Do While Not RsSprStkOld.EOF
''                If MyEof = 0 Then
''                    Do While MyPart_No = RsSprStkOld!Part_No And MyTax_YN = RsSprStkOld!Tax_YN And MyMRP_YN = RsSprStkOld!MRP_YN And MyDiv_Code = RsSprStkOld!Div_Code
''                        TempStock = TempStock + VNull(RsSprStkOld!mQty)
''                        TempAmount = TempAmount + VNull(RsSprStkOld!AMOUNT)
''                        RsSprStkOld.MoveNext
''                        If RsSprStkOld.EOF Then
''                            MyEof = 1
''                            GoTo xx
''                        End If
''                    Loop
''xx:
''                    If RsSprStkOld.EOF Then
''                        RsSprStkOld.MovePrevious
''                        MyEof = 1
''                    Else
''                        RsSprStkOld.MovePrevious
''                    End If
''                    Counter = Counter + 1
''                    DocID = RsSprStkOld!Div_Code & PubSiteCode & PubSiteCode & " SXAO" & " SPOP" & Format(Counter, "00000000")
''
''                    GCn.Execute "INSERT INTO SP_STOCK (DocID,Srl_No,V_Type,V_No,V_Date,Part_No," & _
''                        "Godown,MRP_YN,TAX_YN,Qty_Rec,Rate,Amount,V_Rate,MRP_Rate," & _
''                        "Site_Code,U_Name,U_EntDt,U_AE) " & _
''                        "VALUES ('" & DocID & "',1,'SXAO'," & Format(Counter, "00000000") & "," & ConvertDate(DateAdd("yyyy", -1, PubEndDate)) & ",'" & RsSprStkOld!Part_No & _
''                        "','" & PubSprCounterGodown & "'," & RsSprStkOld!MRP_YN & "," & RsSprStkOld!Tax_YN & "," & TempStock & "," & VNull(RsSprStkOld!mRate) & "," & Round(TempAmount, 2) & "," & VNull(RsSprStkOld!V_Rate) & ",0" & _
''                        ",'" & PubSiteCode & "','" & pubUName & "'," & ConvertDate(PubServerDate) & ",'A')"
''                Else
''                    GoTo ZZ
''                End If
''                RsSprStkOld.MoveNext
''                If Not RsSprStkOld.EOF Then
''                    MyPart_No = RsSprStkOld!Part_No
''                    MyTax_YN = RsSprStkOld!Tax_YN
''                    MyMRP_YN = RsSprStkOld!MRP_YN
''                    MyDiv_Code = RsSprStkOld!Div_Code
''                    TempStock = 0
''                    TempAmount = 0
''                End If
''            Loop
''        End If
''
''
''
''
''        Found = False
''        Set RstVeh_Stk = GCN1.Execute("select * from Veh_Stock where len(Sal_DocID) = 0")
''        Set RstVeh_Pur = GCN1.Execute("select * from Veh_Purch1 where DocID in (select Pur_DocID from Veh_Stock where len(Sal_DocID) = 0)")
''
''        GCn.Execute ("Delete from Veh_Stock where len(Sal_DocID) = 0 and Pur_VType='V_OST'")
''        GCn.Execute ("Delete from Veh_Purch1 where DocID not in (Select Pur_DocID from Veh_Stock)")
''
''        Set RstVeh_Stk1 = GCn.Execute("Select ChassisNo as Chassis  from Veh_Stock where  Pur_VType='V_OST'")
''
''        For I = 1 To RstVeh_Stk.RecordCount
''            DocID = left(RstVeh_Stk!Pur_DocId, 3) & "V_OST" & "VOSTK" & Right(RstVeh_Stk!Pur_DocId, 8)
''            If RstVeh_Stk1.RecordCount > 0 Then
''                RstVeh_Stk1.MoveFirst
''            End If
''            For J = 1 To RstVeh_Stk1.RecordCount
''                If RstVeh_Stk!ChassisNo = RstVeh_Stk1!Chassis Then
''                    Found = True
''                End If
''                RstVeh_Stk1.MoveNext
''            Next
''            If Found = False Then
''                GCn.Execute ("insert into veh_stock " & _
''                    "(Pur_DocId,Pur_SrlNo,Pur_DocIDHelp,Pur_SiteCode,Pur_VType,Pur_VNO, " & _
''                    "Chassis_RctDocNo ,Pur_VDate, Mfg_Month, Mfg_Yr, RSO_WORK,InDate, " & _
''                    "MODEL,Godown,ChassisNo,EngineNo,VehSerialNo, " & _
''                    "Srv_BookNo,RATE,vrate,Colour_Code,TAX_YN,SDM_STM_NO, " & _
''                    "PBILL_NO,PBILL_DATE,PartyCode, U_Name, U_EntDt,U_AE, " & _
''                    "OfftakeIncentiveSrlNo,OfftakeIncentive,TgtLinkIncentive,SubventionSrlNo,MfgShare) " & _
''                    "values('" & DocID & "','" & RstVeh_Stk!Pur_SrlNo & "','" & UCase(Trim(DocID)) & "','" & PubSiteCode & PubSiteCode & "','V_OST'," & RstVeh_Stk!Pur_VNo & ", " & _
''                    "" & RstVeh_Stk!Chassis_RctDocNo & "," & ConvertDate(RstVeh_Stk!Pur_VDate) & ",'" & RstVeh_Stk!Mfg_Month & "','" & RstVeh_Stk!Mfg_Yr & "'," & RstVeh_Stk!RSO_WORK & "," & ConvertDate(RstVeh_Stk!InDate) & ", " & _
''                    "'" & RstVeh_Stk!Model & "','" & RstVeh_Stk!Godown & "','" & RstVeh_Stk!ChassisNo & "','" & RstVeh_Stk!EngineNo & "','" & RstVeh_Stk!VehSerialNo & "' , " & _
''                    "'" & RstVeh_Stk!Srv_BookNo & "'," & RstVeh_Stk!Rate & "," & RstVeh_Stk!vrate & ",'" & RstVeh_Stk!Colour_Code & "'," & RstVeh_Stk!Tax_YN & ",'" & RstVeh_Stk!SDM_STM_NO & "', " & _
''                    "'" & RstVeh_Stk!PBILL_NO & "'," & ConvertDate(RstVeh_Stk!PBILL_DATE) & ",'" & RstVeh_Stk!PartyCode & "','" & pubUName & "'," & ConvertDate(PubServerDate) & ",'E', " & _
''                    "'" & RstVeh_Stk!OfftakeIncentiveSrlNo & "'," & RstVeh_Stk!OfftakeIncentive & "," & _
''                    "" & RstVeh_Stk!TgtLinkIncentive & ",'" & RstVeh_Stk!SubventionSrlNo & _
''                    "', " & RstVeh_Stk!MfgShare & ")")
''
''                GCn.Execute ("Delete from Veh_Purch1 where DocId='" & RstVeh_Stk!Pur_DocId & "'")
''
''                GCn.Execute ("insert into Veh_Purch1( " & _
''                    "DocID,DocIDHelp,Site_Code,V_Type,V_NO,V_Date, " & _
''                    "PARTYCODE,PBILL_NO,PBILL_DATE,OBNO, " & _
''                    "OBDate,BMS_CATEGORY,RSO_WORK,RSO_Code,DueDate, " & _
''                    "GATE,GATEDATE,Form_Code,AMOUNT,Addition,Deduction,Exsice, " & _
''                    "Tax_Per,TaxSur_Per,Tax_Amt,TaxSur_Amt,Misc_Amt, " & _
''                    "Tot_Amount, U_Name, U_EntDt, U_AE,AcPostByU_Name,AcPostByU_EntDt,DrAcCode) " & _
''                    "values( '" & DocID & "','" & UCase(Trim(DocID)) & "','" & PubSiteCode & PubSiteCode & "','V_OST'," & RstVeh_Pur!V_NO & "," & ConvertDate(RstVeh_Pur!V_DATE) & _
''                    ",'" & RstVeh_Pur!PartyCode & "','" & RstVeh_Pur!PBILL_NO & "'," & ConvertDate(RstVeh_Pur!PBILL_DATE) & ",'" & RstVeh_Pur!OBNO & "'," & ConvertDate(RstVeh_Pur!OBDate) & _
''                    ",'" & RstVeh_Pur!BMS_CATEGORY & "'," & RstVeh_Pur!RSO_WORK & ",'" & RstVeh_Pur!RSO_Code & "'," & ConvertDate(RstVeh_Pur!DueDate) & _
''                    " ,'" & RstVeh_Pur!GATE & "'," & ConvertDate(RstVeh_Pur!GATEDATE) & ",'" & RstVeh_Pur!Form_Code & "','" & RstVeh_Pur!AMOUNT & "'," & RstVeh_Pur!Addition & "," & RstVeh_Pur!Deduction & _
''                    " , " & RstVeh_Pur!exsice & "," & RstVeh_Pur!Tax_Per & "," & RstVeh_Pur!TaxSur_Per & "," & RstVeh_Pur!Tax_Amt & "," & RstVeh_Pur!TaxSur_Amt & "," & RstVeh_Pur!Misc_Amt & _
''                    " , " & RstVeh_Pur!Tot_Amount & ",'" & pubUName & "'," & ConvertDate(PubServerDate) & ",'A','" & RstVeh_Pur!AcPostByU_Name & "'," & ConvertDate(RstVeh_Pur!AcPostByU_EntDt) & ",'" & RstVeh_Pur!DrAcCode & "')")
''
''                GCn.Execute ("Delete from Veh_Purch2 where DocId='" & RstVeh_Stk!Pur_DocId & "'")
''
''                Set RstVeh_Pur1 = GCN1.Execute("select * from Veh_Purch2 where DocID ='" & RstVeh_Stk!Pur_DocId & "'")
''
''                If RstVeh_Pur1.RecordCount > 0 Then
''                    For J = 0 To RstVeh_Pur1.RecordCount
''                          GCn.Execute ("insert into veh_purch2(DocId,Srl_No,Site_Code,V_TYPE,V_NO,PROD_CODE,trn_type,QTY,RATE, U_Name, U_EntDt, U_AE) " & _
''                                "values('" & DocID & "'," & RstVeh_Pur1!Srl_No & ",'" & PubSiteCode & PubSiteCode & "','V_OST','" & RstVeh_Pur1!V_NO & "', " & _
''                                "'" & RstVeh_Pur1!Prod_Code & "','" & RstVeh_Pur1!Trn_Type & "'," & RstVeh_Pur1!Qty & "," & RstVeh_Pur1!Rate & ",'" & pubUName & "'," & ConvertDate(PubServerDate) & ",'A')")
''                    Next
''                End If
''
''            End If
''            RstVeh_Stk.MoveNext
''            RstVeh_Pur.MoveNext
''            Found = False
''        Next
''
''
''    If MsgBox("Do You Want to Update Fa Balance?", vbYesNo) = vbYes Then
''
''            SourcePathFA = Pub_DataPath & "\" & G_CompCn.Execute("Select OldPathFA from Company where CentralData_Path='" & PubCenDataPath & "'").Fields(0).Value
''            GCn.BeginTrans
''            G_FaCn.BeginTrans
''            Set GFa_Cn = New ADODB.Connection
''            With GFa_Cn
''                 .CursorLocation = adUseClient
''                 .Provider = "Microsoft.Jet.OLEDB.4.0"
''                 .ConnectionString = "Data Source=" & SourcePathFA & ";Persist Security Info=False;Jet OLEDB:Database Password=dtman"
''                 .Open
''                 .BeginTrans
''            End With
''            Set RST1 = GFa_Cn.Execute("select Nature as NAT,GroupCode As MCODE, IIF(Len(SUBGROUP.NewYrSubCode) > 0, SUBGROUP.NewYrSubCode, SUBGROUP.SubCode) AS PARTY_CODE,SUBGROUP.NAME,SUM(AMTCR)-SUM(AMTDR) AS BALANCE FROM LEDGER LEFT JOIN SUBGROUP ON LEDGER.SUBCODE=SUBGROUP.SUBCODE WHERE GroupNature IN ('A','L') GROUP BY GroupCode,NAME,subgroup.SUBCODE,Nature,GroupCode,SUBGROUP.NewYrSubCode")
''            Label1.CAPTION = "Please Wait ! Updating Last Year FA Balances.."
''            Label1.Refresh
''            G_FaCn.Execute "delete from ledger where V_Type='F_AO'"
''            G_FaCn.Execute "delete from ledgerM where V_Type='F_AO'"
''            mCode = ""
''            NewSubCode = ""
''            mVNo = 0
''            Do Until RST1.EOF
''                NewSubCode = RST1!Party_code
''                If mCode <> RST1!mCode Then
''                    mVNo = mVNo + 1
''                    mDocId = FaSetW(PubDivCode, 1) + PubSiteCode + PubSiteCode + FaSetW("F_AO", 5) + FaSetW(Trim(STR(Year(DateAdd("YYYY", 1, PubStartDate)))), 5) + FaSetN(STR(mVNo), 8)
''                    mCode = RST1!mCode
''                    mS_NO = 1
''                    G_FaCn.Execute ("INSERT INTO LEDGERM (DocId,V_Type,v_Prefix,V_No,Site_Code,V_Date,Narration,U_Name,U_EntDt,U_AE) VALUES (" & FaChk_Text(mDocId) & ",'F_AO'," & FaChk_Text(Trim(STR(Year(DateAdd("YYYY", 1, PubStartDate))))) & "," & mVNo & "," & FaChk_Text(PubSiteCode) & "," & FaConvertDate(DateAdd("yyyy", -1, PubEndDate)) & ",'Opening Balance'," & FaChk_Text(pubUName) & "," & FaConvertDate(Now) & ",'A')")
''                End If
''                If RST1!Balance < 0 Then       'DEBIT
''                    G_FaCn.Execute ("INSERT INTO LEDGER (DocId,V_SNo,V_Type,V_No,v_Prefix,Site_Code,V_Date,SubCode,AmtCr,AmtDr,U_Name,U_EntDt,U_AE) VALUES (" & FaChk_Text(mDocId) & "," & mS_NO & ",'F_AO'," & mVNo & "," & FaChk_Text(Trim(STR(Year(DateAdd("yyyy", -1, PubEndDate))))) & "," & FaChk_Text(PubSiteCode) & "," & FaConvertDate(DateAdd("yyyy", -1, PubEndDate)) & "," & FaChk_Text(NewSubCode) & ",0," & Abs(RST1!Balance) & "," & FaChk_Text(pubUName) & "," & FaConvertDate(Now) & ",'A')")
''                    FaCalCurrBal G_FaCn, NewSubCode, Abs(RST1!Balance), 0
''                    FaCalCurrBal GCn, NewSubCode, Abs(RST1!Balance), 0
''                ElseIf RST1!Balance > 0 Then     'CREDIT
''                    G_FaCn.Execute ("INSERT INTO LEDGER (DocId,V_SNo,V_Type,V_No,v_Prefix,Site_Code,V_Date,SubCode,AmtCr,AmtDr,U_Name,U_EntDt,U_AE) VALUES (" & FaChk_Text(mDocId) & "," & mS_NO & ",'F_AO'," & mVNo & "," & FaChk_Text(Trim(STR(Year(DateAdd("yyyy", -1, PubEndDate))))) & "," & FaChk_Text(PubSiteCode) & "," & FaConvertDate(DateAdd("yyyy", -1, PubEndDate)) & "," & FaChk_Text(NewSubCode) & "," & Abs(RST1!Balance) & ",0," & FaChk_Text(pubUName) & "," & FaConvertDate(Now) & ",'A')")
''                    FaCalCurrBal G_FaCn, NewSubCode, 0, Abs(RST1!Balance)
''                    FaCalCurrBal GCn, NewSubCode, 0, Abs(RST1!Balance)
''                End If
''                mS_NO = mS_NO + 1
''                RST1.MoveNext
''            Loop
''
''            G_FaCn.Execute ("update SubGroup set Curr_Bal=0 where FirmCode='" & PubFirmCode & "'")
''            G_FaCn.Execute ("update SubGroupAlias set Curr_Bal=0 where FirmCode='" & PubFirmCode & "'")
''            GCn.Execute ("update SubGroup set Curr_Bal=0 where FirmCode='" & PubFirmCode & "'")
''
''            GSQL = "SELECT Ledger.SubCode,SUM(AmtCr-AmtDr) as CBal " & _
''                    "FROM Ledger left join SubGroup SG on SG.SubCOde=Ledger.SubCode " & _
''                    "group by Ledger.subcode,Name"
''            Set Rst = G_FaCn.Execute(GSQL)
''            If Rst.RecordCount > 0 Then
''                Do While Rst.EOF = False
''                    GCn.Execute ("Update SubGroup set Curr_Bal=" & Rst!CBal & " where SubCode='" & Rst!SubCode & "'")
''                    G_FaCn.Execute ("Update SubGroup set Curr_Bal=" & Rst!CBal & " where SubCode='" & Rst!SubCode & "'")
''                    G_FaCn.Execute ("Update SubGroupAlias set Curr_Bal=" & Rst!CBal & " where SubCode='" & Rst!SubCode & "'")
''                    Rst.MoveNext
''                Loop
''            End If
''
''
''            G_FaCn.Execute ("Delete from subgroupAlias")
''            G_FaCn.Execute ("INSERT INTO SUBGROUPAlias SELECT * FROM SUBGROUP")
''            GCn.Execute ("Delete from subgroup")
''            GCn.Execute ("INSERT INTO SUBGROUP SELECT * FROM [" & PubFADataPath & "].SUBGROUP")
''            GCn.Execute ("Drop Table SubGroupAlias")
''            GCn.Execute ("Select SubGroup.* into SubGroupAlias from SubGroup")
''
''
''            Set Rst = Nothing
''            Set RST1 = Nothing
''            Set Rst2 = Nothing
''            Screen.MousePointer = vbDefault
''            GCn.CommitTrans
''            G_FaCn.CommitTrans
''            GFa_Cn.CommitTrans
''            MsgBox "All FA Balances has been updated to the new Year.", vbInformation + vbOKOnly, "Update Ballence"
''
''    End If
''
''    MsgBox "Now Software Is ReLoading."
''
''
''
''ZZ:
''    GCn.CommitTrans
''    GCN1.CommitTrans
''MsgBox "All Balances has been updated to the new Year.Please reload the Software", vbInformation + vbOKOnly, "Update Balance"
''End
''Exit Function
''DispErr:
''    GCn.RollbackTrans
''    MsgBox err.Description
''End Function

Private Function UpdateBalance()
On Error GoTo disperr
Dim K As Integer, MRPYN As Integer
Dim Condstr$, SourcePath$, DocID$, mQRY$, sQry$, CondStr1$
Dim mQty As Double, mFifoCost As Double, mReqQty As Double
Dim RsSprStkOld As ADODB.Recordset, RsTemp As ADODB.Recordset
Dim RstVeh_Stk As ADODB.Recordset
Dim RstVeh_Pur As ADODB.Recordset
Dim RstVeh_Stk1 As ADODB.Recordset
Dim RstVeh_Pur1 As ADODB.Recordset
Dim I As Long
Dim GCN1 As ADODB.Connection
Dim Found As Boolean
Dim PBIncrVal As Long
Dim Counter As Long
Dim TempStock As Double, TempAmount As Double
Dim MyPart_No, MyTax_YN, MyMRP_YN, MyDiv_Code, MyEof As Byte
Dim GFa_Cn As New ADODB.Connection
Dim Rst As ADODB.Recordset, RST1 As ADODB.Recordset, Rst2 As ADODB.Recordset, mTrans As Boolean, DataPath$, SourcePathFA$
Dim NewSubCode$, mCode$, mDocId$
Dim mVNo As Long
Dim mS_NO As Long


'TAKE BACKUP
Call DataBackup


    
    
    
    SourcePath = Pub_DataPath & "\" & G_CompCn.Execute("Select OldPath from Company where CentralData_Path='" & PubCenDataPath & "'").Fields(0).Value
    Set GCN1 = New ADODB.Connection
             With GCN1
                    .CursorLocation = adUseClient
                    .Mode = adModeWrite
                    .Provider = "Microsoft.Jet.OLEDB.4.0"
                    .ConnectionString = "Data Source=" & SourcePath & ";Persist Security Info=False;Jet OLEDB:Database Password=dtman"
                    .Open
             End With
    





'UPDATING SP_STOCK TABLE
    If MsgBox("Do u Want to Update Spare Balances?", vbYesNo) = vbYes Then
            
        GCN1.BeginTrans
        GCn.BeginTrans
            mQRY = "SELECT Left(S.DocId,1) As Div_Code, S.Part_No, sum(S.Qty_Rec)-Sum(S.Qty_Iss)+Sum(S.Qty_Ret) As mQty, Tax_Yn, Mrp_Yn, " & _
                   "Max(Rate) As mRate, Max(Amount) As Amount, Max(S.V_Rate) As V_Rate " & _
                   "From sp_stock S " & _
                   "WHERE iif(S.v_Date=" & ConvertDate(Format(DateAdd("YYYY", -2, PubEndDate), "dd/MMM/yyyy")) & ",S.V_Type='SXAO',IIF(S.V_Date>=" & ConvertDate(Format(DateAdd("YYYY", -1, PubStartDate), "dd/MMM/yyyy")) & ",S.V_Type<>'SXAO')) " & _
                   "Group By Left(S.DocId,1), Part_No, Tax_Yn, Mrp_Yn " & _
                   "Having sum(Qty_Rec)-Sum(Qty_Iss)+Sum(Qty_Ret)<>0 "
                   
                Set RsSprStkOld = New ADODB.Recordset
                If RsSprStkOld.State <> 0 Then RsSprStkOld.Close
                RsSprStkOld.CursorLocation = adUseClient
                RsSprStkOld.Open mQRY, GCN1, adOpenDynamic, adLockBatchOptimistic
                GCn.Execute ("Delete From SP_Stock Where V_Type='SXAO'")
                        
                        
                With RsSprStkOld
                    If .RecordCount > 0 Then
                        Do While Not .EOF
                            Set RsTemp = GCN1.Execute("Select Part_No, V_Date, Qty_Rec, Rate " & _
                                                  "From Sp_Stock S " & _
                                                  "Where S.Part_No='" & !Part_No & "' And S.Tax_Yn = " & !Tax_YN & " And S.Mrp_Yn = " & !MRP_YN & " " & _
                                                  "And Left(S.DocId,1)='" & !Div_Code & "' And Qty_Rec>0  " & _
                                                  "Order by V_Date Desc")
                                                                        
                            mQty = 0
                            mReqQty = 0
                            mFifoCost = 0
                            Debug.Print RsTemp.RecordCount
                            Do Until RsTemp.EOF
                                If mQty < VNull(!mQty) Then
                                    mReqQty = IIf((mQty + VNull(RsTemp!Qty_Rec)) > VNull(!mQty), VNull(!mQty) - mQty, RsTemp!Qty_Rec)
                                    mQty = mQty + VNull(RsTemp!Qty_Rec)
                                    
                                    mFifoCost = mFifoCost + (mReqQty * VNull(RsTemp!Rate))
                                    RsTemp.MoveNext
                                Else
                                    Exit Do
                                End If
                            Loop
                            
                            !AMOUNT = mFifoCost
                            !mRate = mFifoCost / VNull(!mQty)
                            
                            Counter = Counter + 1
                            DocID = !Div_Code & PubSiteCode & PubSiteCode & " SXAO" & " SPOP" & Format(Counter, "00000000")
                            
                            GCn.Execute "INSERT INTO SP_STOCK (DocID,Srl_No,V_Type,V_No,V_Date,Part_No," & _
                                "Godown,MRP_YN,TAX_YN,Qty_Rec,Rate,Amount,V_Rate,MRP_Rate," & _
                                "Site_Code,U_Name,U_EntDt,U_AE) " & _
                                "VALUES ('" & DocID & "',1,'SXAO'," & Format(Counter, "00000000") & ",#" & DateAdd("yyyy", -1, PubEndDate) & "#,'" & !Part_No & _
                                "','" & PubSprCounterGodown & "'," & !MRP_YN & "," & !Tax_YN & "," & VNull(!mQty) & "," & VNull(!mRate) & "," & Round(VNull(!AMOUNT), 2) & ", " & VNull(!V_Rate) & ", " & VNull(!mRate) & " " & _
                                ",'" & PubSiteCode & "','" & pubUName & "',#" & PubServerDate & "#,'A')"
                            .MoveNext
                        Loop
                    End If
                End With
            GCn.CommitTrans
            GCN1.CommitTrans
            
            MsgBox "All Spare Balances has been Updated to the new Year.", vbInformation + vbOKOnly, "Update Balance"
    End If
    
    
    
    
    
    
    
    
    If MsgBox("Do You Want to Update Vehicle Balance?", vbYesNo) = vbYes Then
        Found = False
        
        
        GCN1.BeginTrans
        GCn.BeginTrans
            Set RstVeh_Stk = GCN1.Execute("select * from Veh_Stock where len(Sal_DocID) = 0")
            Set RstVeh_Pur = GCN1.Execute("select * from Veh_Purch1 where DocID in (select Pur_DocID from Veh_Stock where len(Sal_DocID) = 0)")
    
            GCn.Execute ("Delete from Veh_Stock where len(Sal_DocID) = 0 and Pur_VType='V_OST'")
            GCn.Execute ("Delete from Veh_Purch1 where DocID not in (Select Pur_DocID from Veh_Stock)")
    
            'Set RstVeh_Stk1 = GCn.Execute("Select ChassisNo as Chassis  from Veh_Stock where  Pur_VType='V_OST'")
            Set RstVeh_Stk1 = GCn.Execute("Select ChassisNo as Chassis  from Veh_Stock ")
    
            For I = 1 To RstVeh_Stk.RecordCount
                DocID = left(RstVeh_Stk!Pur_DocId, 3) & "V_OST" & "VOSTK" & Right(RstVeh_Stk!Pur_DocId, 8)
                If RstVeh_Stk1.RecordCount > 0 Then
                    RstVeh_Stk1.MoveFirst
                End If
                For J = 1 To RstVeh_Stk1.RecordCount
                    If RstVeh_Stk!ChassisNo = RstVeh_Stk1!Chassis Then
                        Found = True
                    End If
                    RstVeh_Stk1.MoveNext
                Next
                If Found = False Then
                    GCn.Execute ("insert into veh_stock " & _
                        "(Pur_DocId,Pur_SrlNo,Pur_DocIDHelp,Pur_SiteCode,Pur_VType,Pur_VNO, " & _
                        "Chassis_RctDocNo ,Pur_VDate, Mfg_Month, Mfg_Yr, RSO_WORK,InDate, " & _
                        "MODEL,Godown,ChassisNo,EngineNo,VehSerialNo, " & _
                        "Srv_BookNo,RATE,vrate,Colour_Code,TAX_YN,SDM_STM_NO, " & _
                        "PBILL_NO,PBILL_DATE,PartyCode, U_Name, U_EntDt,U_AE, " & _
                        "OfftakeIncentiveSrlNo,OfftakeIncentive,TgtLinkIncentive,SubventionSrlNo,MfgShare) " & _
                        "values('" & DocID & "','" & RstVeh_Stk!Pur_SrlNo & "','" & UCase(Trim(DocID)) & "','" & PubSiteCode & PubSiteCode & "','V_OST'," & RstVeh_Stk!Pur_VNo & ", " & _
                        "" & RstVeh_Stk!Chassis_RctDocNo & "," & ConvertDate(RstVeh_Stk!Pur_VDate) & ",'" & RstVeh_Stk!Mfg_Month & "','" & RstVeh_Stk!Mfg_Yr & "'," & RstVeh_Stk!RSO_WORK & "," & ConvertDate(RstVeh_Stk!InDate) & ", " & _
                        "'" & RstVeh_Stk!Model & "','" & RstVeh_Stk!Godown & "','" & RstVeh_Stk!ChassisNo & "','" & RstVeh_Stk!EngineNo & "','" & RstVeh_Stk!VehSerialNo & "' , " & _
                        "'" & RstVeh_Stk!Srv_BookNo & "'," & RstVeh_Stk!Rate & "," & RstVeh_Stk!vrate & ",'" & RstVeh_Stk!Colour_Code & "'," & RstVeh_Stk!Tax_YN & ",'" & RstVeh_Stk!SDM_STM_NO & "', " & _
                        "'" & RstVeh_Stk!PBILL_NO & "'," & ConvertDate(RstVeh_Stk!PBILL_DATE) & ",'" & RstVeh_Stk!PartyCode & "','" & pubUName & "'," & ConvertDate(PubServerDate) & ",'E', " & _
                        "'" & RstVeh_Stk!OfftakeIncentiveSrlNo & "'," & RstVeh_Stk!OfftakeIncentive & "," & _
                        "" & RstVeh_Stk!TgtLinkIncentive & ",'" & RstVeh_Stk!SubventionSrlNo & _
                        "', " & RstVeh_Stk!MfgShare & ")")
    
                    GCn.Execute ("Delete from Veh_Purch1 where DocId='" & RstVeh_Stk!Pur_DocId & "'")
    
                    GCn.Execute ("insert into Veh_Purch1( " & _
                        "DocID,DocIDHelp,Site_Code,V_Type,V_NO,V_Date, " & _
                        "PARTYCODE,PBILL_NO,PBILL_DATE,OBNO, " & _
                        "OBDate,BMS_CATEGORY,RSO_WORK,RSO_Code,DueDate, " & _
                        "GATE,GATEDATE,Form_Code,AMOUNT,Addition,Deduction,Exsice, " & _
                        "Tax_Per,TaxSur_Per,Tax_Amt,TaxSur_Amt,Misc_Amt, " & _
                        "Tot_Amount, U_Name, U_EntDt, U_AE,AcPostByU_Name,AcPostByU_EntDt,DrAcCode) " & _
                        "values( '" & DocID & "','" & UCase(Trim(DocID)) & "','" & PubSiteCode & PubSiteCode & "','V_OST'," & RstVeh_Pur!V_NO & "," & ConvertDate(RstVeh_Pur!V_DATE) & _
                        ",'" & RstVeh_Pur!PartyCode & "','" & RstVeh_Pur!PBILL_NO & "'," & ConvertDate(RstVeh_Pur!PBILL_DATE) & ",'" & RstVeh_Pur!OBNO & "'," & ConvertDate(RstVeh_Pur!OBDate) & _
                        ",'" & RstVeh_Pur!BMS_CATEGORY & "'," & RstVeh_Pur!RSO_WORK & ",'" & RstVeh_Pur!RSO_Code & "'," & ConvertDate(RstVeh_Pur!DueDate) & _
                        " ,'" & RstVeh_Pur!GATE & "'," & ConvertDate(RstVeh_Pur!GATEDATE) & ",'" & RstVeh_Pur!Form_Code & "','" & RstVeh_Pur!AMOUNT & "'," & RstVeh_Pur!Addition & "," & RstVeh_Pur!Deduction & _
                        " , " & RstVeh_Pur!exsice & "," & RstVeh_Pur!Tax_Per & "," & RstVeh_Pur!TaxSur_Per & "," & RstVeh_Pur!Tax_Amt & "," & RstVeh_Pur!TaxSur_Amt & "," & RstVeh_Pur!Misc_Amt & _
                        " , " & RstVeh_Pur!Tot_Amount & ",'" & pubUName & "'," & ConvertDate(PubServerDate) & ",'A','" & RstVeh_Pur!AcPostByU_Name & "'," & ConvertDate(RstVeh_Pur!AcPostByU_EntDt) & ",'" & RstVeh_Pur!DrAcCode & "')")
    
                    GCn.Execute ("Delete from Veh_Purch2 where DocId='" & RstVeh_Stk!Pur_DocId & "'")
    
                    Set RstVeh_Pur1 = GCN1.Execute("select * from Veh_Purch2 where DocID ='" & RstVeh_Stk!Pur_DocId & "'")
    
                    If RstVeh_Pur1.RecordCount > 0 Then
                        For J = 0 To RstVeh_Pur1.RecordCount
                              GCn.Execute ("insert into veh_purch2(DocId,Srl_No,Site_Code,V_TYPE,V_NO,PROD_CODE,trn_type,QTY,RATE, U_Name, U_EntDt, U_AE) " & _
                                    "values('" & DocID & "'," & RstVeh_Pur1!Srl_No & ",'" & PubSiteCode & PubSiteCode & "','V_OST','" & RstVeh_Pur1!V_NO & "', " & _
                                    "'" & RstVeh_Pur1!Prod_Code & "','" & RstVeh_Pur1!Trn_Type & "'," & RstVeh_Pur1!Qty & "," & RstVeh_Pur1!Rate & ",'" & pubUName & "'," & ConvertDate(PubServerDate) & ",'A')")
                        Next
                    End If
    
                End If
                RstVeh_Stk.MoveNext
                RstVeh_Pur.MoveNext
                Found = False
            Next
        GCn.CommitTrans
        GCN1.CommitTrans
    End If
    
    
    
    
    
    
    
    
    If MsgBox("Do You Want to Update Fa Balance?", vbYesNo) = vbYes Then
            
            SourcePathFA = Pub_DataPath & "\" & G_CompCn.Execute("Select OldPathFA from Company where CentralData_Path='" & PubCenDataPath & "'").Fields(0).Value
            GCn.BeginTrans
            G_FaCn.BeginTrans
            Set GFa_Cn = New ADODB.Connection
            With GFa_Cn
                 .CursorLocation = adUseClient
                 .Provider = "Microsoft.Jet.OLEDB.4.0"
                 .ConnectionString = "Data Source=" & SourcePathFA & ";Persist Security Info=False;Jet OLEDB:Database Password=dtman"
                 .Open
                 .BeginTrans
            End With
            Set RST1 = GFa_Cn.Execute("select Nature as NAT,GroupCode As MCODE, IIF(Len(SUBGROUP.NewYrSubCode) > 0, SUBGROUP.NewYrSubCode, SUBGROUP.SubCode) AS PARTY_CODE,SUBGROUP.NAME,SUM(AMTCR)-SUM(AMTDR) AS BALANCE FROM LEDGER LEFT JOIN SUBGROUP ON LEDGER.SUBCODE=SUBGROUP.SUBCODE WHERE GroupNature IN ('A','L') GROUP BY GroupCode,NAME,subgroup.SUBCODE,Nature,GroupCode,SUBGROUP.NewYrSubCode")
            Label1.CAPTION = "Please Wait ! Updating Last Year FA Balances.."
            Label1.Refresh
            G_FaCn.Execute "delete from ledger where V_Type='F_AO'"
            G_FaCn.Execute "delete from ledgerM where V_Type='F_AO'"
            mCode = ""
            NewSubCode = ""
            mVNo = 0
            Do Until RST1.EOF
                NewSubCode = RST1!Party_code
                If mCode <> RST1!mCode Then
                    mVNo = mVNo + 1
                    mDocId = FaSetW(PubDivCode, 1) + PubSiteCode + PubSiteCode + FaSetW("F_AO", 5) + FaSetW(Trim(STR(Year(DateAdd("YYYY", 1, PubStartDate)))), 5) + FaSetN(STR(mVNo), 8)
                    mCode = RST1!mCode
                    mS_NO = 1
                    G_FaCn.Execute ("INSERT INTO LEDGERM (DocId,V_Type,v_Prefix,V_No,Site_Code,V_Date,Narration,U_Name,U_EntDt,U_AE) VALUES (" & FaChk_Text(mDocId) & ",'F_AO'," & FaChk_Text(Trim(STR(Year(DateAdd("YYYY", 1, PubStartDate))))) & "," & mVNo & "," & FaChk_Text(PubSiteCode) & "," & FaConvertDate(DateAdd("yyyy", -1, PubEndDate)) & ",'Opening Balance'," & FaChk_Text(pubUName) & "," & FaConvertDate(Now) & ",'A')")
                End If
                If RST1!Balance < 0 Then       'DEBIT
                    G_FaCn.Execute ("INSERT INTO LEDGER (DocId,V_SNo,V_Type,V_No,v_Prefix,Site_Code,V_Date,SubCode,AmtCr,AmtDr,U_Name,U_EntDt,U_AE) VALUES (" & FaChk_Text(mDocId) & "," & mS_NO & ",'F_AO'," & mVNo & "," & FaChk_Text(Trim(STR(Year(DateAdd("yyyy", -1, PubEndDate))))) & "," & FaChk_Text(PubSiteCode) & "," & FaConvertDate(DateAdd("yyyy", -1, PubEndDate)) & "," & FaChk_Text(NewSubCode) & ",0," & Abs(RST1!Balance) & "," & FaChk_Text(pubUName) & "," & FaConvertDate(Now) & ",'A')")
                    FaCalCurrBal G_FaCn, NewSubCode, Abs(RST1!Balance), 0
                    FaCalCurrBal GCn, NewSubCode, Abs(RST1!Balance), 0
                ElseIf RST1!Balance > 0 Then     'CREDIT
                    G_FaCn.Execute ("INSERT INTO LEDGER (DocId,V_SNo,V_Type,V_No,v_Prefix,Site_Code,V_Date,SubCode,AmtCr,AmtDr,U_Name,U_EntDt,U_AE) VALUES (" & FaChk_Text(mDocId) & "," & mS_NO & ",'F_AO'," & mVNo & "," & FaChk_Text(Trim(STR(Year(DateAdd("yyyy", -1, PubEndDate))))) & "," & FaChk_Text(PubSiteCode) & "," & FaConvertDate(DateAdd("yyyy", -1, PubEndDate)) & "," & FaChk_Text(NewSubCode) & "," & Abs(RST1!Balance) & ",0," & FaChk_Text(pubUName) & "," & FaConvertDate(Now) & ",'A')")
                    FaCalCurrBal G_FaCn, NewSubCode, 0, Abs(RST1!Balance)
                    FaCalCurrBal GCn, NewSubCode, 0, Abs(RST1!Balance)
                End If
                mS_NO = mS_NO + 1
                RST1.MoveNext
            Loop
            
            G_FaCn.Execute ("update SubGroup set Curr_Bal=0 where FirmCode='" & PubFirmCode & "'")
            G_FaCn.Execute ("update SubGroupAlias set Curr_Bal=0 where FirmCode='" & PubFirmCode & "'")
            GCn.Execute ("update SubGroup set Curr_Bal=0 where FirmCode='" & PubFirmCode & "'")
            
            GSQL = "SELECT Ledger.SubCode,SUM(AmtCr-AmtDr) as CBal " & _
                    "FROM Ledger left join SubGroup SG on SG.SubCOde=Ledger.SubCode " & _
                    "group by Ledger.subcode,Name"
            Set Rst = G_FaCn.Execute(GSQL)
            If Rst.RecordCount > 0 Then
                Do While Rst.EOF = False
                    GCn.Execute ("Update SubGroup set Curr_Bal=" & Rst!CBal & " where SubCode='" & Rst!SubCode & "'")
                    G_FaCn.Execute ("Update SubGroup set Curr_Bal=" & Rst!CBal & " where SubCode='" & Rst!SubCode & "'")
                    G_FaCn.Execute ("Update SubGroupAlias set Curr_Bal=" & Rst!CBal & " where SubCode='" & Rst!SubCode & "'")
                    Rst.MoveNext
                Loop
            End If
            
            
            G_FaCn.Execute ("Delete from subgroupAlias")
            G_FaCn.Execute ("INSERT INTO SUBGROUPAlias SELECT * FROM SUBGROUP")
            GCn.Execute ("Delete from subgroup")
            GCn.Execute ("INSERT INTO SUBGROUP SELECT * FROM [" & PubFADataPath & "].SUBGROUP")
            GCn.Execute ("Drop Table SubGroupAlias")
            GCn.Execute ("Select SubGroup.* into SubGroupAlias from SubGroup")
        
        
            Set Rst = Nothing
            Set RST1 = Nothing
            Set Rst2 = Nothing
            Screen.MousePointer = vbDefault
            GCn.CommitTrans
            G_FaCn.CommitTrans
            GFa_Cn.CommitTrans
            MsgBox "All FA Balances has been updated to the new Year.", vbInformation + vbOKOnly, "Update Ballence"
                        
    End If

    MsgBox "Now Software Is ReLoading."
    End
Exit Function
disperr:
    GCn.RollbackTrans
    MsgBox err.Description
End Function

Public Function UpdtCurrBalances()

Dim DataPath$
Dim I As Integer, GSQL1$
On Error Resume Next
'If MsgBox("Are You Sure To Update Current Balance of A/c ? ", vbYesNo + vbCritical + vbDefaultButton2, "Update Current Stock !") = vbYes Then
    
    Dim Rst As ADODB.Recordset, mTrans As Boolean
    
    GCn.BeginTrans
    G_FaCn.BeginTrans
    mTrans = True
    G_FaCn.Execute ("update SubGroup set Curr_Bal=0")
    GCn.Execute ("update SubGroup set Curr_Bal=0 where FirmCode='" & PubFirmCode & "'")
    
    GSQL = "SELECT Ledger.SubCode,SUM(AmtCr-AmtDr) as CBal " & _
            "FROM Ledger left join SubGroup SG on SG.SubCOde=Ledger.SubCode " & _
            "group by Ledger.subcode,Name"
    Set Rst = G_FaCn.Execute(GSQL)
    If Rst.RecordCount > 0 Then
        Do While Rst.EOF = False
            GCn.Execute ("Update SubGroup set Curr_Bal=" & Rst!CBal & " where SubCode='" & Rst!SubCode & "'")
            G_FaCn.Execute ("Update SubGroup set Curr_Bal=" & Rst!CBal & " where SubCode='" & Rst!SubCode & "'")
            Rst.MoveNext
        Loop
    End If
    DataPath = Pub_DataPath & "\" & PubCenDataPath & "\Automan.mdb;pwd=dtman"
    Set Rst = G_FaCn.Execute("select SG.SubCode from SubGroup as SG where SubCode not in (Select SubCode from [" & DataPath & "].SubGroup where FirmCode='" & PubFirmCode & "')")
    If Rst.RecordCount > 0 Then
        Do Until Rst.EOF
            GCn.Execute ("Delete From SubGroup where Subcode='" & Rst!SubCode & "'")
            GCn.Execute ("INSERT INTO SUBGROUP SELECT * FROM [" & PubFADataPath & "].SUBGROUP WHERE SUBCODE = '" & Rst!SubCode & "'")
            Rst.MoveNext
        Loop
        GCn.Execute ("Drop Table SubGroupAlias")
        GCn.Execute ("Select SubGroup.* into SubGroupAlias from SubGroup")
    End If
    GCn.CommitTrans
    G_FaCn.CommitTrans
    mTrans = False
    Set Rst = Nothing

    
    
    GCn.BeginTrans
    '***
    GCn.Execute ("update Part Set Cur_TP_Stk=0,Cur_TB_Stk=0,Cur_MRP_TPStk=0,Cur_MRP_TBStk=0 where Div_Code='" & PubDivCode & "'")
    '***
    GSQL = "Select Part_No,sum((Qty_Rec)-(Qty_Iss-Qty_Ret)) as BalQty " & _
        " from Sp_Stock where Tax_YN=0 and MRP_YN=0 and Left(DocId,1)='" & PubDivCode & "' and V_Date >= " & ConvertDate(PubStartDate) & "" & _
        " Group By Part_No"
        
    GSQL1 = "Select Part_No,sum((Qty_Rec)-(Qty_Iss-Qty_Ret)) as BalQty " & _
        " from Sp_Stock where Tax_YN=0 and MRP_YN=0 and Left(DocId,1)='" & PubDivCode & "' and V_Date = " & ConvertDate(DateAdd("d", -1, PubStartDate)) & " and V_Type='SXAO'" & _
        " Group By Part_No"
            
    GSQL = GSQL & " Union All " & GSQL1
    
    GSQL1 = "Select Part_No,Sum(BalQty) as Bal_Qty From (" & GSQL & ") Group By Part_No"
    
    Set Rst = GCn.Execute(GSQL1)
    
    If Rst.RecordCount > 0 Then
        For I = 1 To Rst.RecordCount
            GCn.Execute ("update Part Set Cur_TP_Stk=Cur_TP_Stk+" & Rst!Bal_Qty & " where Part_No='" & Rst!Part_No & "' and Div_Code='" & PubDivCode & "'")
            Rst.MoveNext
        Next
    End If
    
    GSQL = "Select Part_No,sum((Qty_Rec)-(Qty_Iss-Qty_Ret)) as BalQty " & _
        " from Sp_Stock where Tax_YN=1 and MRP_YN=0 and Left(DocId,1)='" & PubDivCode & "' and V_Date >= " & ConvertDate(PubStartDate) & " " & _
        " Group By Part_No"
        
    GSQL1 = "Select Part_No,sum((Qty_Rec)-(Qty_Iss-Qty_Ret)) as BalQty " & _
        " from Sp_Stock where Tax_YN=1 and MRP_YN=0 and Left(DocId,1)='" & PubDivCode & "' and V_Date = " & ConvertDate(DateAdd("d", -1, PubStartDate)) & " and V_Type='SXAO'" & _
        " Group By Part_No"
            
    GSQL = GSQL & " Union All " & GSQL1
    
    GSQL1 = "Select Part_No,Sum(BalQty)as Bal_Qty From (" & GSQL & ") Group By Part_No"
    
    Set Rst = GCn.Execute(GSQL1)
    If Rst.RecordCount > 0 Then
        For I = 1 To Rst.RecordCount
            GCn.Execute ("update Part Set Cur_TB_Stk=Cur_TB_Stk+" & Rst!Bal_Qty & " where Part_No='" & Rst!Part_No & "' and Div_Code='" & PubDivCode & "'")
            Rst.MoveNext
        Next
    End If
    
    GSQL = "Select Part_No,sum((Qty_Rec))-sum((Qty_Iss-Qty_Ret)) as BalQty " & _
        " from Sp_Stock where Tax_YN=0 and MRP_YN=1 and Left(DocId,1)='" & PubDivCode & "' and V_Date >= " & ConvertDate(PubStartDate) & "" & _
        " Group By Part_No"
    
    GSQL1 = "Select Part_No,sum((Qty_Rec))-sum((Qty_Iss-Qty_Ret)) as BalQty " & _
        " from Sp_Stock where Tax_YN=0 and MRP_YN=1 and Left(DocId,1)='" & PubDivCode & "' and V_Date = " & ConvertDate(DateAdd("d", -1, PubStartDate)) & " and V_Type='SXAO'" & _
        " Group By Part_No"
            
    GSQL = GSQL & " Union All " & GSQL1
    
    GSQL1 = "Select Part_No,Sum(BalQty) as Bal_Qty From (" & GSQL & ") Group By Part_No"
    
    Set Rst = GCn.Execute(GSQL1)
    If Rst.RecordCount > 0 Then
        For I = 1 To Rst.RecordCount
            GCn.Execute ("update Part Set Cur_MRP_TPStk=Cur_MRP_TPStk+" & Rst!Bal_Qty & " where Part_No='" & Rst!Part_No & "' and Div_Code='" & PubDivCode & "'")
            Rst.MoveNext
        Next
    End If
    GSQL = "Select Part_No,sum((Qty_Rec)-(Qty_Iss-Qty_Ret)) as BalQty " & _
        " from Sp_Stock where Tax_YN=1 and MRP_YN=1 and Left(DocId,1)='" & PubDivCode & "' and V_Date >= " & ConvertDate(PubStartDate) & " " & _
        " Group By Part_No"
    
    GSQL1 = "Select Part_No,sum((Qty_Rec)-(Qty_Iss-Qty_Ret)) as BalQty " & _
        " from Sp_Stock where Tax_YN=1 and MRP_YN=1 and Left(DocId,1)='" & PubDivCode & "' and V_Date = " & ConvertDate(DateAdd("d", -1, PubStartDate)) & " and V_Type='SXAO'" & _
        " Group By Part_No"
            
    GSQL = GSQL & " Union All " & GSQL1
    
    GSQL1 = "Select Part_No,Sum(BalQty) as Bal_Qty From (" & GSQL & ") Group By Part_No"
    
    Set Rst = GCn.Execute(GSQL1)
    If Rst.RecordCount > 0 Then
        For I = 1 To Rst.RecordCount
            GCn.Execute ("update Part Set Cur_MRP_TBStk=Cur_MRP_TBStk+" & Rst!Bal_Qty & " where Part_No='" & Rst!Part_No & "' and Div_Code='" & PubDivCode & "'")
            Rst.MoveNext
        Next
    End If
    GCn.CommitTrans
    RsPart.Requery
    Set Rst = Nothing

ELoop:
If mTrans Then GCn.RollbackTrans: G_FaCn.RollbackTrans

End Function


Private Sub X_Val1(ByRef Temp06 As ADODB.Recordset, ByRef TRec1 As ADODB.Recordset, xQty As Double, xRate As Double, Optional xNARR As String)
    If TRec1.RecordCount <= 0 Or TRec1.EOF = True Or TRec1.BOF = True Then
        xRate = 0
        mOP_TB_QTY = mOP_TB_QTY - xQty
        mOP_TB_VAL = mOP_TB_VAL - (xQty * xRate)
        If mTrf = False And xQty <> 0 Then
            If mPART_ADD = False Then
                mPART_ADD = True
                With Temp06
                    .AddNew
                    .Fields("Part_Name") = RstPart!Part_Name
                    .Fields("Part_No") = RstPart!Part_No
                    .Fields("Job_Age") = "Y"
                    .Update
                End With
            End If
            With Temp06
                .AddNew
                .Fields("Date") = RstStock!V_DATE
                .Fields("V_No") = RstStock!V_tYPE + "-" + STR(RstStock!V_NO)
                .Fields("Part_Name") = mname
                .Fields("Narr") = xNARR
                .Fields("Inv_No") = mInv_No
                .Fields("Inv_Date") = mInv_Date
                .Fields("Part_No") = RstPart!Part_No
                .Fields("Rate") = xRate
                
                .Fields("Is_Tb") = xQty
                .Fields("Tb_Val") = xQty * xRate
                .Fields("Tb_BQty") = mOP_TB_QTY
                .Fields("Tb_BVal") = mOP_TB_VAL
                
                .Fields("Is_Tp") = 0
                .Fields("Tp_Val") = 0
                .Fields("Tp_BQty") = 0
                .Fields("Tp_BVal") = 0
                
                .Update
            End With
        End If
        Exit Sub
    End If
    If xQty = TRec1!Qty Then
        TRec1.Fields("QTY") = 0
        TRec1.Update
        xRate = TRec1!Rate
        mOP_TB_QTY = mOP_TB_QTY - xQty
        mOP_TB_VAL = mOP_TB_VAL - (xQty * xRate)
        If mTrf = False And xQty <> 0 Then
            If mPART_ADD = False Then
                mPART_ADD = True
                With Temp06
                    .AddNew
                    .Fields("Part_Name") = RstPart!Part_Name
                    .Fields("Part_No") = RstPart!Part_No
                    .Fields("Job_Age") = "Y"
                    .Update
                End With
            End If
            With Temp06
                .AddNew
                .Fields("Date") = RstStock!V_DATE
                .Fields("V_No") = RstStock!V_tYPE + "-" + STR(RstStock!V_NO)
                .Fields("Part_Name") = mname
                .Fields("Narr") = xNARR
                .Fields("Inv_No") = mInv_No
                .Fields("Inv_Date") = mInv_Date
                .Fields("Part_No") = RstPart!Part_No
                .Fields("Rate") = xRate
                
                .Fields("Is_Tb") = xQty
                .Fields("Tb_Val") = xQty * xRate
                .Fields("Tb_BQty") = mOP_TB_QTY
                .Fields("Tb_BVal") = mOP_TB_VAL
                
                .Fields("Is_Tp") = 0
                .Fields("Tp_Val") = 0
                .Fields("Tp_BQty") = 0
                .Fields("Tp_BVal") = 0
                
                .Update
            End With
        End If
        TRec1.MoveNext
    ElseIf xQty < TRec1!Qty Then
        TRec1.Fields("QTY") = TRec1!Qty - xQty
        TRec1.Update
        
        xRate = TRec1!Rate
        mOP_TB_QTY = mOP_TB_QTY - xQty
        mOP_TB_VAL = mOP_TB_VAL - (xQty * xRate)
        
        If mTrf = False And xQty <> 0 Then
            If mPART_ADD = False Then
                mPART_ADD = True
                With Temp06
                    .AddNew
                    .Fields("Part_Name") = RstPart!Part_Name
                    .Fields("Part_No") = RstPart!Part_No
                    .Fields("Job_Age") = "Y"
                    .Update
                End With
            End If
            With Temp06
                .AddNew
                .Fields("Date") = RstStock!V_DATE
                .Fields("V_No") = RstStock!V_tYPE + "-" + STR(RstStock!V_NO)
                .Fields("Part_Name") = mname
                .Fields("Narr") = xNARR
                .Fields("Inv_No") = mInv_No
                .Fields("Inv_Date") = mInv_Date
                .Fields("Part_No") = RstPart!Part_No
                .Fields("Rate") = xRate
                
                .Fields("Is_Tb") = xQty
                .Fields("Tb_Val") = xQty * xRate
                .Fields("Tb_BQty") = mOP_TB_QTY
                .Fields("Tb_BVal") = mOP_TB_VAL
                
                .Fields("Is_Tp") = 0
                .Fields("Tp_Val") = 0
                .Fields("Tp_BQty") = 0
                .Fields("Tp_BVal") = 0
                
                .Update
            End With
        End If
    ElseIf xQty > TRec1!Qty Then
        TQty = xQty
        Do While TQty <> 0 And Not TRec1.EOF
            If TRec1!Part_No <> RstPart!Part_No Then
                GoTo MyNextRecord
            End If
            If TRec1!Qty <= TQty Then
                TQty = TQty - TRec1!Qty
                xRate = TRec1!Rate
                mOP_TB_QTY = mOP_TB_QTY - TRec1!Qty
                mOP_TB_VAL = mOP_TB_VAL - (TRec1!Qty * xRate)
                If mTrf = False Then
                    If mPART_ADD = False Then
                        mPART_ADD = True
                        With Temp06
                            .AddNew
                            .Fields("Part_Name") = RstPart!Part_Name
                            .Fields("Part_No") = RstPart!Part_No
                            .Fields("Job_Age") = "Y"
                            .Update
                        End With
                    End If
                    With Temp06
                        .AddNew
                        .Fields("Date") = RstStock!V_DATE
                        .Fields("V_No") = RstStock!V_tYPE + "-" + STR(RstStock!V_NO)
                        .Fields("Part_Name") = mname
                        .Fields("Narr") = left(xNARR, 25)
                        .Fields("Inv_No") = mInv_No
                        .Fields("Inv_Date") = mInv_Date
                        .Fields("Part_No") = RstPart!Part_No
                        .Fields("Rate") = xRate
                        
                        .Fields("Is_Tb") = TRec1!Qty
                        .Fields("Tb_Val") = TRec1!Qty * xRate
                        .Fields("Tb_BQty") = mOP_TB_QTY
                        .Fields("Tb_BVal") = mOP_TB_VAL
                        
                        .Fields("Is_Tp") = 0
                        .Fields("Tp_Val") = 0
                        .Fields("Tp_BQty") = 0
                        .Fields("Tp_BVal") = 0
                        .Update
                    End With
                    TRec1.Fields("QTY") = 0
                    TRec1.Update
                End If
            Else
                TRec1.Fields("QTY") = TRec1!Qty - TQty
                TRec1.Update
                xRate = TRec1!Rate
                mOP_TB_QTY = mOP_TB_QTY - TQty
                mOP_TB_VAL = mOP_TB_VAL - (TQty * xRate)
                If mTrf = False Then
                    If mPART_ADD = False Then
                        mPART_ADD = True
                        With Temp06
                            .AddNew
                            .Fields("Part_Name") = RstPart!Part_Name
                            .Fields("Part_No") = RstPart!Part_No
                            .Fields("Job_Age") = "Y"
                            .Update
                        End With
                    End If
                    With Temp06
                        .AddNew
                        .Fields("Part_No") = RstPart!Part_No
                        .Fields("Rate") = xRate
                        
                        .Fields("Is_Tb") = TQty
                        .Fields("Tb_Val") = TQty * xRate
                        .Fields("Tb_BQty") = mOP_TB_QTY
                        .Fields("Tb_BVal") = mOP_TB_VAL
                        
                        .Fields("Is_Tp") = 0
                        .Fields("Tp_Val") = 0
                        .Fields("Tp_BQty") = 0
                        .Fields("Tp_BVal") = 0
                        .Update
                    End With
                    TQty = 0
                    Exit Do
                End If
            End If
MyNextRecord:
            TRec1.MoveNext
            If TRec1.EOF = True And TQty <> 0 Then
                mOP_TB_QTY = mOP_TB_QTY - TQty
                mOP_TB_VAL = mOP_TB_VAL - (TQty * xRate)
                If mPART_ADD = False Then
                    mPART_ADD = True
                    With Temp06
                        .AddNew
                        .Fields("Part_Name") = RstPart!Part_Name
                        .Fields("Part_No") = RstPart!Part_No
                        .Fields("Job_Age") = "Y"
                        .Update
                    End With
                End If
                With Temp06
                    .AddNew
                    .Fields("Part_No") = RstPart!Part_No
                    .Fields("Rate") = xRate
                    
                    .Fields("Is_Tb") = TQty
                    .Fields("Tb_Val") = TQty * xRate
                    .Fields("Tb_BQty") = mOP_TB_QTY
                    .Fields("Tb_BVal") = mOP_TB_VAL
                    
                    .Fields("Is_Tp") = 0
                    .Fields("Tp_Val") = 0
                    .Fields("Tp_BQty") = 0
                    .Fields("Tp_BVal") = 0
                    .Update
                End With
            
            End If
        Loop
    End If
End Sub

Private Sub X_Val2(ByRef Temp06 As ADODB.Recordset, ByRef TRec2 As ADODB.Recordset, xQty As Double, xRate As Double, Optional xNARR As String)
    If TRec2.RecordCount <= 0 Or TRec2.EOF = True Or TRec2.BOF = True Then
        xRate = 0
        mOP_TP_QTY = mOP_TP_QTY - xQty
        mOP_TP_VAL = mOP_TP_VAL - (xQty * xRate)
        If mTrf = False And xQty <> 0 Then
            If mPART_ADD = False Then
                mPART_ADD = True
                With Temp06
                    .AddNew
                    .Fields("Part_Name") = RstPart!Part_Name
                    .Fields("Part_No") = RstPart!Part_No
                    .Fields("Job_Age") = "Y"
                    .Update
                End With
            End If
            With Temp06
                .AddNew
                .Fields("Date") = RstStock!V_DATE
                .Fields("V_No") = PrinID(RstStock!DocID)
                .Fields("Part_Name") = mname
                .Fields("Narr") = xNARR
                .Fields("Inv_No") = mInv_No
                .Fields("Inv_Date") = mInv_Date
                .Fields("Part_No") = RstPart!Part_No
                .Fields("Rate") = xRate
                
                .Fields("Is_Tb") = 0
                .Fields("Tb_Val") = 0
                .Fields("Tb_BQty") = 0
                .Fields("Tb_BVal") = 0
                
                .Fields("Is_Tp") = xQty
                .Fields("Tp_Val") = xQty * xRate
                .Fields("Tp_BQty") = mOP_TP_QTY
                .Fields("Tp_BVal") = mOP_TP_VAL
                
                .Update
            End With
        End If
        Exit Sub
    End If
    
    If xQty = TRec2!Qty Then
        TRec2.Fields("QTY") = 0
        TRec2.Update
        xRate = TRec2!Rate
        mOP_TP_QTY = mOP_TP_QTY - xQty
        mOP_TP_VAL = mOP_TP_VAL - (xQty * xRate)
        If mTrf = False And xQty <> 0 Then
            If mPART_ADD = False Then
                mPART_ADD = True
                With Temp06
                    .AddNew
                    .Fields("Part_Name") = RstPart!Part_Name
                    .Fields("Part_No") = RstPart!Part_No
                    .Fields("Job_Age") = "Y"
                    .Update
                End With
            End If
            With Temp06
                .AddNew
                .Fields("Date") = RstStock!V_DATE
                .Fields("V_No") = RstStock!V_tYPE + "-" + STR(RstStock!V_NO)
                .Fields("Part_Name") = mname
                .Fields("Narr") = xNARR
                .Fields("Inv_No") = mInv_No
                .Fields("Inv_Date") = mInv_Date
                .Fields("Part_No") = RstPart!Part_No
                .Fields("Rate") = xRate
                
                .Fields("Is_Tb") = 0
                .Fields("Tb_Val") = 0
                .Fields("Tb_BQty") = 0
                .Fields("Tb_BVal") = 0
                
                .Fields("Is_Tp") = xQty
                .Fields("Tp_Val") = xQty * xRate
                .Fields("Tp_BQty") = mOP_TP_QTY
                .Fields("Tp_BVal") = mOP_TP_VAL
                
                .Update
            End With
        End If
        TRec2.MoveNext
    ElseIf xQty < TRec2!Qty Then
        TRec2.Fields("QTY") = TRec2!Qty - xQty
        TRec2.Update
        
        xRate = TRec2!Rate
        mOP_TP_QTY = mOP_TP_QTY - xQty
        mOP_TP_VAL = mOP_TP_VAL - (xQty * xRate)
        
        If mTrf = False And xQty <> 0 Then
            If mPART_ADD = False Then
                mPART_ADD = True
                With Temp06
                    .AddNew
                    .Fields("Part_Name") = RstPart!Part_Name
                    .Fields("Part_No") = RstPart!Part_No
                    .Fields("Job_Age") = "Y"
                    .Update
                End With
            End If
            With Temp06
                .AddNew
                .Fields("Date") = RstStock!V_DATE
                .Fields("V_No") = RstStock!V_tYPE + "-" + STR(RstStock!V_NO)
                .Fields("Part_Name") = mname
                .Fields("Narr") = xNARR
                .Fields("Inv_No") = mInv_No
                .Fields("Inv_Date") = mInv_Date
                .Fields("Part_No") = RstPart!Part_No
                .Fields("Rate") = xRate
                
                .Fields("Is_Tb") = 0
                .Fields("Tb_Val") = 0
                .Fields("Tb_BQty") = 0
                .Fields("Tb_BVal") = 0
                
                .Fields("Is_Tp") = xQty
                .Fields("Tp_Val") = xQty * xRate
                .Fields("Tp_BQty") = mOP_TP_QTY
                .Fields("Tp_BVal") = mOP_TP_VAL
                .Update
            End With
        End If
    ElseIf xQty > TRec2!Qty Then
        TQty = xQty
        Do While TQty <> 0 And Not TRec2.EOF
            If TRec2!Part_No <> RstPart!Part_No Then
                GoTo MyNextRecord
            End If
            If TRec2!Qty <= TQty Then
                TQty = TQty - TRec2!Qty
                xRate = TRec2!Rate
                mOP_TP_QTY = mOP_TP_QTY - TRec2!Qty
                mOP_TP_VAL = mOP_TP_VAL - (TRec2!Qty * xRate)
                If mTrf = False Then
                    If mPART_ADD = False Then
                        mPART_ADD = True
                        With Temp06
                            .AddNew
                            .Fields("Part_Name") = RstPart!Part_Name
                            .Fields("Part_No") = RstPart!Part_No
                            .Fields("Job_Age") = "Y"
                            .Update
                        End With
                    End If
                    With Temp06
                        .AddNew
                        .Fields("Date") = RstStock!V_DATE
                        .Fields("V_No") = RstStock!V_tYPE + "-" + STR(RstStock!V_NO)
                        .Fields("Part_Name") = mname
                        .Fields("Narr") = xNARR
                        .Fields("Inv_No") = mInv_No
                        .Fields("Inv_Date") = mInv_Date
                        .Fields("Part_No") = RstPart!Part_No
                        .Fields("Rate") = xRate
                        
                        .Fields("Is_Tb") = 0
                        .Fields("Tb_Val") = 0
                        .Fields("Tb_BQty") = 0
                        .Fields("Tb_BVal") = 0
                        
                        .Fields("Is_Tp") = TRec2!Qty
                        .Fields("Tp_Val") = TRec2!Qty * xRate
                        .Fields("Tp_BQty") = mOP_TP_QTY
                        .Fields("Tp_BVal") = mOP_TP_VAL
                        .Update
                    End With
                    TRec2.Fields("QTY") = 0
                    TRec2.Update
                End If
            Else
                TRec2.Fields("QTY") = TRec2!Qty - TQty
                TRec2.Update
                xRate = TRec2!Rate
                mOP_TP_QTY = mOP_TP_QTY - TQty
                mOP_TP_VAL = mOP_TP_VAL - (TQty * xRate)
                If mTrf = False Then
                    If mPART_ADD = False Then
                        mPART_ADD = True
                        With Temp06
                            .AddNew
                            .Fields("Part_Name") = RstPart!Part_Name
                            .Fields("Part_No") = RstPart!Part_No
                            .Fields("Job_Age") = "Y"
                            .Update
                        End With
                    End If
                    With Temp06
                        .AddNew
                        .Fields("Part_No") = RstPart!Part_No
                        .Fields("Rate") = xRate
                        
                        .Fields("Is_Tb") = 0
                        .Fields("Tb_Val") = 0
                        .Fields("Tb_BQty") = 0
                        .Fields("Tb_BVal") = 0
                        
                        .Fields("Is_Tp") = TQty
                        .Fields("Tp_Val") = TQty * xRate
                        .Fields("Tp_BQty") = mOP_TP_QTY
                        .Fields("Tp_BVal") = mOP_TP_VAL
                        .Update
                    End With
                    TQty = 0
                    Exit Do
                End If
            End If
MyNextRecord:
            TRec2.MoveNext
            If TRec2.EOF = True And TQty <> 0 Then
                mOP_TP_QTY = mOP_TP_QTY - TQty
                mOP_TP_VAL = mOP_TP_VAL - (TQty * xRate)
                If mPART_ADD = False Then
                    mPART_ADD = True
                    With Temp06
                        .AddNew
                        .Fields("Part_Name") = RstPart!Part_Name
                        .Fields("Part_No") = RstPart!Part_No
                        .Fields("Job_Age") = "Y"
                        .Update
                    End With
                End If
                With Temp06
                    .AddNew
                    .Fields("Part_No") = RstPart!Part_No
                    .Fields("Rate") = xRate
                    
                    .Fields("Is_Tb") = 0
                    .Fields("Tb_Val") = 0
                    .Fields("Tb_BQty") = 0
                    .Fields("Tb_BVal") = 0
                    
                    .Fields("Is_Tp") = TQty
                    .Fields("Tp_Val") = TQty * xRate
                    .Fields("Tp_BQty") = mOP_TP_QTY
                    .Fields("Tp_BVal") = mOP_TP_VAL
                    .Update
                End With
            End If
        Loop
    End If
End Sub
Private Sub X_VAL11(ByRef TRec1 As ADODB.Recordset, xQty As Double, xRate As Double, Optional xNARR As String)
On Error GoTo Errloop
    If TRec1.RecordCount <= 0 Or TRec1.EOF = True Or TRec1.BOF = True Then
        If mOP_TB_VAL <> 0 And mOP_TB_QTY <> 0 Then
            xRate = Round(mOP_TB_VAL / mOP_TB_QTY, 3)
        Else
            xRate = 0
        End If
            mOP_TB_QTY = mOP_TB_QTY - xQty
            mOP_TB_VAL = mOP_TB_VAL - (xQty * xRate)
            mIss_TB_Qty = mIss_TB_Qty + xQty
            mIss_TB_Val = mIss_TB_Val + (xQty * xRate)
          Exit Sub
    End If
    If xQty = TRec1Qty Then
        TRec1Qty = 0
'        TRec1!Qty = 0
'        TRec1.Update
        xRate = TRec1!Rate
        mOP_TB_QTY = mOP_TB_QTY - xQty
        mOP_TB_VAL = mOP_TB_VAL - (xQty * xRate)
        mIss_TB_Qty = mIss_TB_Qty + xQty
        mIss_TB_Val = mIss_TB_Val + (xQty * xRate)
        TRec1.MoveNext
        If TRec1.EOF = False Then
            TRec1Qty = TRec1!Qty
        End If
'    ElseIf xQty < TRec1!Qty Then
    ElseIf xQty < TRec1Qty Then
        TRec1Qty = TRec1Qty - xQty
'        TRec1!Qty = TRec1!Qty - xQty
'        TRec1.Update
        xRate = TRec1!Rate
        mOP_TB_QTY = mOP_TB_QTY - xQty
        mOP_TB_VAL = mOP_TB_VAL - (xQty * xRate)
        mIss_TB_Qty = mIss_TB_Qty + xQty
        mIss_TB_Val = mIss_TB_Val + (xQty * xRate)
'    ElseIf xQty  > TRec1!Qty Then
    ElseIf xQty > TRec1Qty Then
        TQty = xQty
        Do While TQty <> 0 And Not TRec1.EOF
'            If TRec1!Qty <= TQty Then
            If TRec1Qty <= TQty Then
'                TQty = TQty - TRec1!Qty
                TQty = TQty - TRec1Qty
                xRate = TRec1!Rate
                mOP_TB_QTY = mOP_TB_QTY - TRec1Qty 'TRec1!Qty
                mOP_TB_VAL = mOP_TB_VAL - (TRec1Qty * xRate) '(TRec1!Qty * xRate)
                mIss_TB_Qty = mIss_TB_Qty + (TRec1Qty) '(TRec1!Qty)
                mIss_TB_Val = mIss_TB_Val + (TRec1Qty * xRate) '(TRec1!Qty * xRate)
                TRec1Qty = 0
'                TRec1!Qty = 0
'                TRec1.Update
            Else
                TRec1Qty = TRec1Qty - TQty
'                TRec1!Qty = TRec1!Qty - TQty
'                TRec1.Update
                xRate = TRec1!Rate
                mOP_TB_QTY = mOP_TB_QTY - TQty
                mOP_TB_VAL = mOP_TB_VAL - (TQty * xRate)
                mIss_TB_Qty = mIss_TB_Qty + TQty
                mIss_TB_Val = mIss_TB_Val + (TQty * xRate)
                TQty = 0
                Exit Do
            End If
            TRec1.MoveNext
            If TRec1.EOF = True And TQty <> 0 Then
                mOP_TB_QTY = mOP_TB_QTY - TQty
                mOP_TB_VAL = mOP_TB_VAL - (TQty * xRate)
                mIss_TB_Qty = mIss_TB_Qty + TQty
                mIss_TB_Val = mIss_TB_Val + (TQty * xRate)
            End If
            If TRec1.EOF = False Then
                TRec1Qty = TRec1!Qty
            End If
        Loop
    End If
Errloop:
     If err.NUMBER <> 0 Then CheckError
End Sub

Private Sub X_VAL22(ByRef TRec2 As ADODB.Recordset, xQty As Double, xRate As Double, Optional xNARR As String)
    If TRec2.RecordCount <= 0 Or TRec2.EOF = True Or TRec2.BOF = True Then
        xRate = 0
        
        mOP_TP_QTY = mOP_TP_QTY - xQty
        mOP_TP_VAL = mOP_TP_VAL - (xQty * xRate)
        mIss_TP_Qty = mIss_TP_Qty + xQty
        mIss_TP_Val = mIss_TP_Val + (xQty * xRate)
        Exit Sub
    End If
'    If xQty = TRec2!Qty Then
    If xQty = TRec2Qty Then
        TRec2Qty = 0
'        TRec2!Qty = 0
'        TRec2.Update
        xRate = TRec2!Rate
        mOP_TP_QTY = mOP_TP_QTY - xQty
        mOP_TP_VAL = mOP_TP_VAL - (xQty * xRate)
        mIss_TP_Qty = mIss_TP_Qty + xQty
        mIss_TP_Val = mIss_TP_Val + (xQty * xRate)
        TRec2.MoveNext
        If TRec2.EOF = False Then
            TRec2Qty = TRec2!Qty
        End If
'    ElseIf xQty < TRec2!Qty Then
    ElseIf xQty < TRec2Qty Then
        TRec2Qty = TRec2Qty - xQty
'        TRec2!Qty = TRec2!Qty - xQty
'        TRec2.Update
        xRate = TRec2!Rate
        mOP_TP_QTY = mOP_TP_QTY - xQty
        mOP_TP_VAL = mOP_TP_VAL - (xQty * xRate)
        mIss_TP_Qty = mIss_TP_Qty + xQty
        mIss_TP_Val = mIss_TP_Val + (xQty * xRate)
'    ElseIf xQty  > TRec2!Qty Then
    ElseIf xQty > TRec2Qty Then
        TQty = xQty
        Do While TQty <> 0 And Not TRec2.EOF
'            If TRec2!Qty <= TQty Then
            If TRec2Qty <= TQty Then
                TQty = TQty - TRec2Qty 'TRec2!Qty
                xRate = TRec2!Rate
                mOP_TP_QTY = mOP_TP_QTY - TRec2Qty 'TRec2!Qty
                mOP_TP_VAL = mOP_TP_VAL - (TRec2Qty * xRate)   '(TRec2!Qty * xRate)
                mIss_TP_Qty = mIss_TP_Qty + (TRec2Qty)     '(TRec2!Qty)
                mIss_TP_Val = mIss_TP_Val + (TRec2Qty * xRate) '(TRec2!Qty * xRate)
                TRec2Qty = 0
'                TRec2!Qty = 0
'                TRec2.Update
            Else
                TRec2Qty = TRec2Qty - TQty
'                TRec2!Qty = TRec2!Qty - TQty
'                TRec2.Update
                xRate = TRec2!Rate
                mOP_TP_QTY = mOP_TP_QTY - TQty
                mOP_TP_VAL = mOP_TP_VAL - (TQty * xRate)
                mIss_TP_Qty = mIss_TP_Qty + TQty
                mIss_TP_Val = mIss_TP_Val + (TQty * xRate)
                TQty = 0
                Exit Do
            End If
            TRec2.MoveNext
            If TRec2.EOF = True And TQty <> 0 Then
                mOP_TP_QTY = mOP_TP_QTY - TQty
                mOP_TP_VAL = mOP_TP_VAL - (TQty * xRate)
                mIss_TP_Qty = mIss_TP_Qty + TQty
                mIss_TP_Val = mIss_TP_Val + (TQty * xRate)
            End If
            If TRec2.EOF = False Then
                TRec2Qty = TRec2!Qty
            End If
        Loop
    End If
End Sub
Private Function Update_VRate()
Dim vrate As Double, XNO As Double, xNO1 As Double, xAmt As Double, xRate As Double, xRate1 As Double, xVRate As Double, mDisPer As Double, TempVal As Double, I As Integer, J As Integer, l As Integer, cnt As Integer, Part_No$, RStkPart_No$
Dim StkArr(1000, 1000) As Double
Picture1.Visible = True
Label1.CAPTION = "Updating Reciept Side VRate....."
   'GCn.Execute ("update sp_stock set v_rate=0")
    mQRY = "select Distinct SPStk.Part_No " & _
            "From " & _
            "SP_Stock as SPStk left Join " & FaTable("Voucher_Type") & " as VT on Vt.V_type=SPStk.V_type " & _
            "Where Vt.StkTrn='+' Order By SPStk.Part_No Asc"
    Set RstStock3 = GCn.Execute(mQRY)
    
    mQRY = "select SPStk.DocID,SPStk.V_Type,SPStk.Part_No,SPStk.V_DATE,SPStk.MRP_YN,SPStk.Tax_YN,SPStk.Qty_Rec,(SPStk.Qty_Iss-SPStk.Qty_Ret) as Qty_Iss,SPStk.V_Rate,Vt.StkTrn " & _
            "From " & _
            "SP_Stock as SPStk left Join " & FaTable("Voucher_Type") & " as VT on Vt.V_type=SPStk.V_type " & _
            "Where Vt.StkTrn='+' Order By SPStk.V_Rate,SPStk.Part_No Asc"
    Set RstStock = GCn.Execute(mQRY)
    
    For I = 1 To RstStock3.RecordCount
        Label1.CAPTION = "Updating Reciept Side V_Rate of Part : " & RstStock3!Part_No
        Label1.Refresh
        vrate = 0
        RstStock.Filter = ("Part_NO ='" & RstStock3!Part_No & "'")
          RstStock.Sort = "V_Date Asc"
        RstStock.MoveFirst
        For J = 1 To RstStock.RecordCount
          
           If RstStock!V_Rate = 0 And vrate = 0 Then
                If RstStock!MRP_YN = 1 Then
                   TempVal = GCn.Execute("Select MRP from Part where Part_No='" & RstStock!Part_No & "'").Fields(0).Value
                Else
                   TempVal = GCn.Execute("Select TP_SRate from Part where Part_No='" & RstStock!Part_No & "'").Fields(0).Value
                   mDisPer = IIf(IsNull(GCn.Execute("Select Part.Part_No,DF.PurcDisc_Per from Part Left Join Part_DiscFactor DF on Part.Disc_Factor = DF.DiscFac_Catg where Part.Part_No='" & RstStock!Part_No & "'").Fields(1).Value), 0, GCn.Execute("Select Part.Part_No,DF.PurcDisc_Per from Part Left Join Part_DiscFactor DF on Part.Disc_Factor = DF.DiscFac_Catg where Part.Part_No='" & RstStock!Part_No & "'").Fields(1).Value)
                   If mDisPer > 0 Then
                        TempVal = Round(TempVal - ((TempVal * mDisPer) / 100), 2)
                   End If
                End If
                GCn.Execute ("Update SP_Stock set v_Rate=" & TempVal & " where DocId='" & RstStock!DocID & "' and Part_No='" & RstStock!Part_No & "'")
           Else
                Part_No = RstStock!Part_No
                If Val(RstStock!V_Rate) = 0 Then
                    GCn.Execute ("Update SP_Stock set V_Rate=" & vrate & " where DocId='" & RstStock!DocID & "' and Part_No='" & RstStock!Part_No & "'")
                End If
                vrate = RstStock!V_Rate
                RstStock.MoveNext
           End If
            
           If Part_No <> RstStock3!Part_No Then
                vrate = 0
                Exit For
           End If
        
        Next
    RstStock3.MoveNext
    Next
    
Label1.CAPTION = "Updating Issue Side VRate....."
On Error Resume Next
mQRY = "select SPStk.Part_No,SPStk.V_DATE,(SPStk.Qty_Rec + SPStk.Qty_Ret ) as Qty,SPStk.MRP_YN, " & cIIF("SPStk.V_Rate > 0", "SPStk.V_Rate", "SPStk.Rate") & " as Rate " & _
            "From " & _
            "SP_Stock as SPStk left Join " & FaTable("Voucher_Type") & " as VT on Vt.V_type=SPStk.V_type " & _
            Condstr & CondPartNos
GSQL = mQRY & " where Vt.StkTrn='+' Order By SPStk.Part_No,SPStk.V_Date,SPStk.DocID,SPStk.Srl_No"

Set RstStock = GCn.Execute(GSQL)
    
mQRY = "select DISTINCT  SPStk.DocID,SPStk.Part_No,SPStk.MRP_YN,SPStk.Qty_Rec,(SPStk.Qty_Iss-SPStk.Qty_Ret) as Qty_Iss,SPStk.V_Rate ,Vt.StkTrn " & _
            "From " & _
            "SP_Stock as SPStk left Join " & FaTable("Voucher_Type") & " as VT on Vt.V_type=SPStk.V_type " & _
            "Where Vt.StkTrn <> '+' Order By Part_No Asc"
Set RstStock2 = GCn.Execute(mQRY)

RStkPart_No = ""
RstStock2.MoveFirst
For I = 1 To RstStock2.RecordCount
Label1.CAPTION = "Updating Issue Side VRate of Part : " & RstStock2!Part_No
    'If RstStock2!V_Rate = 0 Then
        l = 1
        Part_No = RstStock2!Part_No
        If Part_No <> RStkPart_No Then
            Erase StkArr
            RstStock.Filter = ("Part_NO ='" & RstStock2!Part_No & "'")
            RstStock.Sort = "V_Date ASC"
            RstStock.MoveFirst
            RStkPart_No = RstStock!Part_No
            For J = 1 To RstStock.RecordCount
                StkArr(J, 0) = RstStock!Qty
                StkArr(J, 1) = RstStock!Rate
                RstStock.MoveNext
            Next
        End If
        
        XNO = 0: xNO1 = 0: xRate = 0: xVRate = 0: xAmt = 0
        XNO = RstStock2!Qty_Iss
       
        If XNO = StkArr(l, 0) Then
             xNO1 = 1
             xRate = (StkArr(l, 1))
             xAmt = xRate
        ElseIf XNO < StkArr(l, 0) Then
             xNO1 = 1
             xRate = (StkArr(l, 1))
             StkArr(l, 0) = (StkArr(l, 0)) - XNO
             xAmt = xRate
        ElseIf XNO > StkArr(l, 0) Then
             l = 1
             xNO1 = XNO
             Do While XNO > 0
             If StkArr(l, 0) > 0 Then
                If XNO >= StkArr(l, 0) Then
                    XNO = XNO - StkArr(l, 0)
                    xAmt = Round(xAmt + (StkArr(l, 0) * StkArr(l, 1)), 2)
                    l = l + 1
                Else
                    xAmt = Round(xAmt + (XNO * StkArr(l, 1)), 2)
                    XNO = XNO - StkArr(l, 0)
                End If
              ElseIf StkArr(l, 0) = 0 And XNO <> 0 Then
                xVRate = xRate1
                Exit Do
              End If
             Loop
        End If
        xVRate = Round(IIf(xAmt <> 0, (xAmt / xNO1), 0), 2)
        xRate1 = xVRate
        If RstStock2!V_Rate = 0 Then
            GCn.Execute ("Update SP_Stock set V_Rate=" & xVRate & " where DocId='" & RstStock2!DocID & "' and Part_No='" & RstStock2!Part_No & "' And V_Rate=0")
        End If
        
    'End If
RstStock2.MoveNext
Next
Picture1.Visible = False

End Function
Private Sub FilmMenu()
'*********  Reason to Design this *******
'it will auto genrate menu item in User_Module Form
'developed to get the menu names
'
'Make HelpContextID =1 for Top Parent Menu and HelpContextID = 2 for Report Menu
'Make Index = 0 for parent menus
'dont put move than two level in menu option
'tochange
Dim objctrl As Control
On Error Resume Next
Dim ErrFound As Boolean
Dim I, J As Integer
Dim mHelpId, mTopMenuName As String
Dim mMainMenuName, mMenuName As String
Dim mMenuGroupID As String
Dim mMenuCaption, mMainMenuCaption As String
Dim mMenuIndex, mTopMenuCaption As String
Dim TempGrs As ADODB.Recordset
G_CompCn.Execute ("Delete from User_Module")
ErrFound = False
I = 1: J = 1

Set TempGrs = G_CompCn.Execute("Select * from User_Module")
For Each objctrl In MDIForm1.Controls
    If TypeOf objctrl Is VB.Menu Then
            mHelpId = 0
            mMenuName = objctrl.Name
            mMenuIndex = objctrl.Index
            mMenuCaption = Replace(objctrl.CAPTION, "&", "")
            
            If mMenuCaption = "Challan Allocation" Then MsgBox "xxxx"
            mHelpId = objctrl.HelpContextID
'            If mMenuCaption = "-" Or objctrl.Visible = False Then mMenuIndex = "": GoTo nxt1
            If objctrl.Visible = False Then mMenuIndex = "": GoTo nxt1
            
            If mMenuIndex = "" Then ErrFound = True: GoTo NXT
            
'''MsgBox mTopMenuName & vbCrLf & mMainMenuName & vbCrLf & mMenuCaption
            G_CompCn.Execute ("insert into User_Module(Module_Name,Form_Code,Name) Values( '','" & mMenuName & "','" & mMenuCaption & "')")
            mMenuIndex = ""
            I = I + 1
NXT:

    If ErrFound = True Then
''''G_CompCn.Execute ("insert into User_Module(Code,Name,SrNo,flag,Module_name,Id,MenuIndex) Values( '" & mMenuName & "','" & mMenuCaption & "'," & I & "," & IIf(mHelpId = 100, True, False) & ",'','','" & mMenuIndex & "')")
        mMainMenuName = mMenuName ' mMenuName
        mMenuGroupID = Replace(Space(3 - Len(STR(J))), " ", "0") & J
        mMainMenuCaption = mMenuCaption
        If mHelpId = 1 Then mTopMenuName = mMenuName: mTopMenuCaption = mMenuCaption
        J = J + 1
    End If
nxt1:
    ErrFound = False
    End If

Next objctrl
MsgBox "Done"
End Sub
Private Sub DeleteSubgroup()
Dim RstParty As ADODB.Recordset
Dim mDelete As Boolean, I As Double
mDelete = True
Picture1.Visible = True
Label1.CAPTION = "Processing ---->  "
Dim Counter As Double
Counter = 0
Set RstParty = G_FaCn.Execute("Select SubCode from Subgroup where nature in ('Customer','Suplier')")
    If RstParty.RecordCount > 0 Then
        RstParty.MoveFirst
        For I = 1 To RstParty.RecordCount
                Counter = Format((I * 100) / RstParty.RecordCount, "0")
                Label1.CAPTION = "Processing ----> " & Counter & "% "
                If I Mod 50 = 0 Then
                    Label1.CAPTION = "Processing ----> " & Counter & "% "
                End If
                Picture1.Refresh
                mDelete = True
               '* For FA Data Delete..
                If G_FaCn.Execute("Select * From Ledger Where SubCode='" & RstParty!SubCode & "'").RecordCount > 0 Then
                    mDelete = False
                End If
                '* For Vehicle Data Delete..
                If GCn.Execute("Select * From Veh_Purch1 Where PartyCode='" & RstParty!SubCode & "'").RecordCount > 0 Then
                    mDelete = False
                End If
                
                If GCn.Execute("Select * From Veh_Order Where PartyCode='" & RstParty!SubCode & "'").RecordCount > 0 Then
                    mDelete = False
                End If
                
                '* For Spare Data Delete..
                If GCn.Execute("Select * From SP_Sale Where Party_Code='" & RstParty!SubCode & "'").RecordCount > 0 Then
                    mDelete = False
                End If
                
                If GCn.Execute("Select * From SP_Purch Where Party_Code='" & RstParty!SubCode & "'").RecordCount > 0 Then
                    mDelete = False
                End If
                
                If GCn.Execute("Select * From SP_Order Where Party_Code='" & RstParty!SubCode & "'").RecordCount > 0 Then
                    mDelete = False
                End If
                
                If GCn.Execute("Select * From RECT Where PartyCode='" & RstParty!SubCode & "'").RecordCount > 0 Then
                    mDelete = False
                End If
                
                If GCn.Execute("Select * From Rect Where AcCode='" & RstParty!SubCode & "'").RecordCount > 0 Then
                    mDelete = False
                End If
                
                If mDelete = True Then
                        GCn.Execute ("Delete From SubGroupAlias Where SubCode='" & RstParty!SubCode & "'")
                        GCn.Execute ("Delete From SubGroup Where SubCode='" & RstParty!SubCode & "'")
            
                        G_FaCn.Execute ("Delete From SubGroupAlias Where SubCode='" & RstParty!SubCode & "'")
                        G_FaCn.Execute ("Delete From SubGroup Where SubCode='" & RstParty!SubCode & "'")
                End If
                RstParty.MoveNext
        Next
    End If
    Picture1.Visible = False
End Sub
Sub SetMaxId_VoucherPrefix()
    SetMax_VoucherPrefix "DocId", "W_JWR", "Job_Card"
    SetMax_VoucherPrefix "DocId", "W_JC", "Job_Card"
    SetMax_VoucherPrefix "DocId", "W_JTR", "Job_Card"
    SetMax_VoucherPrefix "DocId", "W_JWF", "Job_Card"
    SetMax_VoucherPrefix "DocId", "W_JWM", "Job_Card"
    SetMax_VoucherPrefix "DocId_InvLab", "W_LIC", "Job_Card"
    SetMax_VoucherPrefix "DocId_InvLab", "W_LIR", "Job_Card"
    SetMax_VoucherPrefix "DocId", "SYSC", "SP_Sale"
    SetMax_VoucherPrefix "DocId", "W_RG", "SP_Stock"
    SetMax_VoucherPrefix "DocId", "SXAO", "SP_Stock"
    SetMax_VoucherPrefix "DocId", "SXGR", "SP_Stock"
    SetMax_VoucherPrefix "DocId", "SXPIC", "SP_Purch"
    SetMax_VoucherPrefix "DocId", "SXPIR", "SP_Purch"
    SetMax_VoucherPrefix "DocId_InvSpr", "W_SIC", "Job_Card"
    SetMax_VoucherPrefix "DocId_InvSpr", "W_SIR", "Job_Card"
    SetMax_VoucherPrefix "DocId", "SYSIC", "SP_Sale"
    SetMax_VoucherPrefix "DocId", "SYSIR", "SP_Sale"
    SetMax_VoucherPrefix "DocId", "SXSRR", "SP_Sale"
    SetMax_VoucherPrefix "DocId", "SXSRC", "SP_Sale"
    SetMax_VoucherPrefix "DocId", "V_PB", "Veh_Purch1"
    SetMax_VoucherPrefix "DocId", "V_OST", "Veh_Purch1"
    SetMax_VoucherPrefix "DocId", "V_QOT", "Veh_Quot"
    SetMax_VoucherPrefix "OrdDocId", "V_BK", "Veh_Order"
    SetMax_VoucherPrefix "DelCh_DocId", "V_DCL", "Veh_Order"
    MsgBox "Updation Done"
End Sub


